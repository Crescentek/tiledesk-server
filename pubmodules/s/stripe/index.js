var _0x530d=['current_period_start','retrieve','subscription','free','price','Sandbox','params','body','jwt','total_count','client_reference_id','stripe\x20apiKey','***\x20***\x20invoice.payment_succeeded\x20-\x20start:\x20','»»»\x20»»»\x20cancelsubscription\x20projectid','project_id','passport','exports','updateProjectProfile\x20Error\x20','sessions','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20subsptn_payment:\x20','customerid','Error\x20saving\x20object.','--\x20>\x20get\x20customer\x20from\x20db\x20>\x20customer\x20+\x20paymentMethods\x20','subscriptionId','***\x20***\x20»»»\x20»»»\x20customer.subscription.deleted\x20subscriptionPayment\x20','user_id','expiration_date_year','customer.subscription.deleted\x20event\x20','invoice.payment_succeeded','»»»\x20»»»\x20get\x20customer\x20from\x20db\x20-\x20projectid','get\x20PaymentMethods\x20list\x20>\x20paymentMethods\x20>\x20paymentMethods.data\x20','***\x20***\x20checkout.session.completed\x20-\x20getSubscritionById\x20subscr\x20object_type:\x20','»»»\x20»»»\x20\x20paymentMethod\x20attached\x20\x20error\x20','find','mongoose','--\x20>\x20subscription\x20get\x20by\x20id\x20from\x20stripe\x20\x20err\x20','/checkoutSession/:sessionid','stripe\x20seats_num:\x20','json','post','create','typeof\x20','!!!!!!!!\x20HI\x20!!!!!!!!\x20checkout.session.completed','basic','---\x20>\x20ERROR\x20','list','/updatesubscription','format','status','put','/payment_methods/:customerid','detachPaymentFunct\x20>\x20paymentMethodid\x20','»»»\x20»»»\x20get\x20customer\x20from\x20db\x20','env','userid','get\x20PaymentMethods\x20list\x20>\x20paymentMethods\x20>\x20default_payment_method_id\x20','detach','detachPaymentFunc\x20result\x20','»»»»\x20stripe\x20apiKey:\x20','send','--\x20>\x20GET\x20SUBSCRIPTION\x20PAYMENTS\x20ERRORt\x20','webhooks','credit_card_cvc','****\x20Stripe\x20error\x20constructEvent:\x20','»»»\x20»»»\x20\x20paymentMethod\x20create\x20\x20error\x20','/webhook','»»»\x20»»»\x20updatesubscription\x20projectid','split','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20project\x20>\x20profile','unix','update','expiration_date_month','start','***\x20***\x20!!!!!!!!!!!!!!!!!!!!!!\x20checkout.session.completed\x20-\x20subscription\x20ID:\x20','type','subscriptions','lines','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20subsptn_payment\x20typeof\x20subsptn_payment:\x20','subscription_create','customer.subscription.deleted\x20subscriptionPayment\x20project\x20id:\x20','customers','attach','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20project\x20>\x20profile\x20>\x20agents','***\x20***\x20invoice.payment_succeeded\x20-\x20index:\x20','sessionid','get','customer.subscription.deleted','stripe','\x20typeof\x20','saveOnDB\x20seats_num','../../../middleware/valid-token','agents','constructEvent','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20project\x20>\x20profile\x20>\x20agents\x20typeof','»»»\x20»»»\x20cancelsubscription\x20userid','--\x20>\x20updatesubscription\x20\x20project\x20','moment','../../../models/project','stripe\x20apiSecretKey','/cancelsubscription','\x20!!!!!!!!\x20HI\x20!!!!!!!!!!!\x20customer.subscription.deleted','../models/subscription-payment','subscription.deleted','rawBody','***\x20***\x20checkout.session.completed\x20-\x20getSubscritionById\x20***\x20start\x20***\x20:\x20','stripe\x20user_id:','billing_reason','customer','--\x20>\x20updatesubscription\x20Error\x20getting\x20project\x20','headers','--\x20>\x20get\x20customer\x20from\x20db\x20-\x20Error\x20','then','--\x20>\x20get\x20customer\x20from\x20db\x20-\x20subscription\x20>\x20customer\x20id\x20','»»»\x20»»»\x20updatesubscription\x20userid','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20subsptn_payment\x20>\x20project_id:\x20','object','authenticate','checkout.session.completed','checkout','exec','debug','subscriptionid','payment','express','save','stripe\x20client_reference_id','--\x20>\x20cancelsubscription\x20Error\x20getting\x20project\x20','stripe\x20seats_numAsString:\x20','PAYMENT_STRIPE_SECRET','--\x20>\x20cancelsubscription\x20\x20project\x20','***\x20***\x20invoice.payment_succeeded\x20-\x20subscription\x20ID:\x20','»»»»\x20stripe\x20endpointSecret:\x20','findByIdAndUpdate','catch','PAYMENT_STRIPE_APIKEY','stripe\x20sig:\x20','/:subscriptionid','»»»\x20»»»\x20\x20paymentMethod','projectid','credit_card_num','default_payment_method','paymentMethods','--\x20>\x20checkoutSession\x20get\x20by\x20id\x20from\x20stripe\x20','card','profile','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20project\x20','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20project\x20>\x20profile\x20>\x20name','»»»\x20»»»\x20\x20update\x20customer\x20-\x20cc\x20from\x20body\x20','»»»\x20»»»\x20updatesubscription\x20price','savedSubscriptionPayment\x20','--\x20>\x20checkoutSession\x20params.sessionid\x20','customer.subscription.deleted\x20subscriptionPayment\x20user\x20id:\x20','/customers/:customerid','data','findOne','period','stripe\x20endpointSecret','asc','***\x20***\x20customer.subscription.deleted\x20','info','--\x20>\x20subscription\x20get\x20by\x20id\x20freq.params.subscriptionid\x20','/customer/:projectid','YYYY-MM-DDTHH:mm:ss.SSS','stripe\x20checkout.session.completed','stripe-signature','error','--\x20>\x20subscription\x20get\x20by\x20id\x20from\x20stripe\x20','Router'];(function(_0xac3db1,_0x530d9e){var _0x1edec0=function(_0x143162){while(--_0x143162){_0xac3db1['push'](_0xac3db1['shift']());}};_0x1edec0(++_0x530d9e);}(_0x530d,0x91));var _0x1ede=function(_0xac3db1,_0x530d9e){_0xac3db1=_0xac3db1-0x0;var _0x1edec0=_0x530d[_0xac3db1];return _0x1edec0;};var express=require(_0x1ede('0x92'));var router=express[_0x1ede('0x16')]();var winston=require('../../../config/winston');var Project=require(_0x1ede('0x78'));var SubscriptionPayment=require(_0x1ede('0x7c'));var moment=require(_0x1ede('0x77'));var mongoose=require(_0x1ede('0x39'));var passport=require(_0x1ede('0x26'));require('../../../middleware/passport')(passport);var validtoken=require(_0x1ede('0x71'));const apiKey=process[_0x1ede('0x4c')][_0x1ede('0x9d')];winston['debug'](_0x1ede('0x22')+apiKey);const stripe=require(_0x1ede('0x6e'))(apiKey);const endpointSecret=process['env'][_0x1ede('0x97')];winston[_0x1ede('0x8f')](_0x1ede('0xb')+endpointSecret);const apiSecretKey=process['env']['PAYMENT_STRIPE_API_SECRET_KEY'];winston[_0x1ede('0x8f')](_0x1ede('0x79')+apiSecretKey);const bodyParser=require('body-parser');router[_0x1ede('0x3e')](_0x1ede('0x58'),bodyParser['raw']({'type':'application/json'}),function(_0xf7f9f1,_0x7c1d15){winston['debug'](_0x1ede('0x9a')+endpointSecret);winston[_0x1ede('0x8f')](_0x1ede('0x51')+apiKey);winston[_0x1ede('0x8f')](_0x1ede('0x79')+apiSecretKey);const _0x572881=_0xf7f9f1[_0x1ede('0x84')][_0x1ede('0x13')];winston[_0x1ede('0x8f')](_0x1ede('0x9e'),_0x572881);let _0x4a1133;try{_0x4a1133=stripe[_0x1ede('0x54')][_0x1ede('0x73')](_0xf7f9f1[_0x1ede('0x7e')],_0x572881,endpointSecret);}catch(_0x265068){winston[_0x1ede('0x14')](_0x1ede('0x56'),_0x265068['message']);return _0x7c1d15['status'](0x190)[_0x1ede('0x52')]('Webhook\x20Error:\x20'+_0x265068['message']);}if(_0x4a1133['type']===_0x1ede('0x8c')){winston[_0x1ede('0x8f')](_0x1ede('0x41'));const _0x5914b5=_0x4a1133[_0x1ede('0x8')]['object'];winston['info'](_0x1ede('0x12'),_0x5914b5);var _0x595780=_0x5914b5[_0x1ede('0x21')];winston['info'](_0x1ede('0x94'),_0x595780);var _0x51096a=_0x595780[_0x1ede('0x5a')]('_')[0x0];winston[_0x1ede('0xe')](_0x1ede('0x80')+_0x51096a);var _0x3ed3eb=_0x595780[_0x1ede('0x5a')]('_')[0x1];winston[_0x1ede('0xe')]('stripe\x20project_id:\x20'+_0x3ed3eb);var _0x478e7b=_0x595780['split']('_')[0x2];winston[_0x1ede('0xe')]('stripe\x20plan_name:\x20'+_0x478e7b);var _0x2ee988=_0x595780['split']('_')[0x3];winston[_0x1ede('0xe')](_0x1ede('0x3c')+_0x2ee988+_0x1ede('0x40'),typeof _0x2ee988);var _0x2fd47f=Number(_0x2ee988);winston['info'](_0x1ede('0x96')+_0x2fd47f+_0x1ede('0x6f'),typeof _0x2fd47f);var _0x922cdf=_0x4a1133[_0x1ede('0x8')]['object']['subscription'];winston['info'](_0x1ede('0x60'),_0x922cdf);getSubscritionById(_0x922cdf)[_0x1ede('0x86')](function(_0x4e3bb7){var _0x4a0e5c=_0x4e3bb7['object'];winston[_0x1ede('0xe')](_0x1ede('0x36'),_0x4a0e5c);var _0x3e03e4=moment['unix'](_0x4e3bb7[_0x1ede('0x17')])[_0x1ede('0x46')]('YYYY-MM-DDTHH:mm:ss.SSS');winston['info'](_0x1ede('0x7f'),_0x3e03e4);var _0x481c0f=moment[_0x1ede('0x5c')](_0x4e3bb7['current_period_end'])[_0x1ede('0x46')](_0x1ede('0x11'));winston[_0x1ede('0xe')]('***\x20***\x20checkout.session.completed\x20-\x20getSubscription\x20***\x20end\x20***\x20:\x20',_0x481c0f);var _0x117666={'profile':{'name':_0x478e7b,'type':_0x1ede('0x91'),'subscription_creation_date':_0x3e03e4,'subStart':_0x3e03e4,'subEnd':_0x481c0f,'subscriptionId':_0x922cdf,'last_stripe_event':_0x4a1133[_0x1ede('0x61')],'agents':_0x2fd47f}};updateProjectProfile(_0x3ed3eb,_0x117666,_0x1ede('0x8c'));saveOnDB(_0x922cdf,_0x3ed3eb,_0x4e3bb7,_0x51096a,_0x4a1133[_0x1ede('0x61')],_0x478e7b,_0x2fd47f);})[_0x1ede('0x9c')](function(_0x23dfe0){winston[_0x1ede('0x14')]('***\x20***\x20checkout.session.completed\x20-\x20getSubscritionById\x20err\x20',_0x23dfe0);});}if(_0x4a1133[_0x1ede('0x61')]==='invoice.payment_succeeded'){winston[_0x1ede('0xe')]('\x20!!!!!!!!\x20HI\x20!!!!!!!!\x20invoice.payment_succeeded');winston[_0x1ede('0xe')]('***\x20***\x20invoice.payment_succeeded\x20-\x20BILLING\x20REASON\x20',_0x4a1133[_0x1ede('0x8')][_0x1ede('0x8a')][_0x1ede('0x81')]);var _0x2ec129=_0x4a1133[_0x1ede('0x8')][_0x1ede('0x8a')]['lines'][_0x1ede('0x20')];winston['info']('***\x20***\x20invoice.payment_succeeded\x20-\x20linesNum:\x20',_0x2ec129);var _0x1748ac=_0x2ec129-0x1;winston['info'](_0x1ede('0x6a'),_0x1748ac);var _0x2934f2=moment[_0x1ede('0x5c')](_0x4a1133[_0x1ede('0x8')]['object'][_0x1ede('0x63')][_0x1ede('0x8')][_0x1748ac]['period'][_0x1ede('0x5f')])['format'](_0x1ede('0x11'));winston[_0x1ede('0xe')](_0x1ede('0x23'),_0x2934f2);var _0x30c36c=moment['unix'](_0x4a1133[_0x1ede('0x8')]['object'][_0x1ede('0x63')][_0x1ede('0x8')][_0x1748ac][_0x1ede('0xa')]['end'])[_0x1ede('0x46')](_0x1ede('0x11'));winston[_0x1ede('0xe')]('***\x20***\x20invoice.payment_succeeded\x20-\x20end:\x20',_0x30c36c);var _0x922cdf=_0x4a1133[_0x1ede('0x8')][_0x1ede('0x8a')][_0x1ede('0x19')];winston[_0x1ede('0xe')]('***\x20***\x20invoice.payment_succeeded\x20-\x20subscription\x20ID:\x20',_0x922cdf);if(_0x922cdf==null){_0x922cdf=_0x4a1133['data'][_0x1ede('0x8a')][_0x1ede('0x63')][_0x1ede('0x8')][0x0][_0x1ede('0x19')];winston[_0x1ede('0xe')](_0x1ede('0x99'),_0x922cdf);}if(_0x4a1133['data'][_0x1ede('0x8a')][_0x1ede('0x81')]!==_0x1ede('0x65')){getSubByIdAndCheckoutSessionCompletedEvnt(_0x922cdf)[_0x1ede('0x86')](function(_0x5a8f6c){winston[_0x1ede('0xe')](_0x1ede('0x2a'),_0x5a8f6c);winston[_0x1ede('0xe')](_0x1ede('0x64'),typeof _0x5a8f6c);if(_0x5a8f6c){var _0x4f0270=_0x5a8f6c['project_id'];winston[_0x1ede('0xe')](_0x1ede('0x89'),_0x4f0270);Project['findOne']({'_id':_0x4f0270},function(_0x519392,_0x27495b){if(_0x519392){winston[_0x1ede('0xe')]('***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20find\x20Project\x20',_0x519392);return _0x519392;}if(_0x27495b){winston[_0x1ede('0xe')](_0x1ede('0x0'),_0x27495b);winston[_0x1ede('0xe')](_0x1ede('0x5b'),_0x27495b[_0x1ede('0xa7')]);var _0x54ce4c=_0x27495b[_0x1ede('0xa7')][_0x1ede('0x72')];winston[_0x1ede('0xe')](_0x1ede('0x69'),_0x54ce4c);var _0xbfd592=_0x27495b['profile']['name'];winston[_0x1ede('0xe')](_0x1ede('0x74'),typeof _0x54ce4c);var _0x713e0b=_0x5a8f6c[_0x1ede('0x30')];winston['info'](_0x1ede('0x1'),_0xbfd592);var _0x1eb9c2={'profile':{'name':_0xbfd592,'type':'payment','subStart':_0x2934f2,'subEnd':_0x30c36c,'subscriptionId':_0x922cdf,'last_stripe_event':_0x4a1133['type'],'agents':_0x54ce4c}};updateProjectProfile(_0x4f0270,_0x1eb9c2,_0x1ede('0x33'));saveOnDB(_0x922cdf,_0x4f0270,_0x4a1133,_0x713e0b,_0x4a1133[_0x1ede('0x61')],_0xbfd592,_0x54ce4c);}});}})[_0x1ede('0x9c')](function(_0x169219){winston[_0x1ede('0x14')]('***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20-\x20err\x20',_0x169219);});}}if(_0x4a1133[_0x1ede('0x61')]===_0x1ede('0x6d')){winston[_0x1ede('0xe')](_0x1ede('0x7b'));winston[_0x1ede('0xe')](_0x1ede('0x32'),_0x4a1133);var _0x922cdf=_0x4a1133[_0x1ede('0x8')][_0x1ede('0x8a')]['id'];winston[_0x1ede('0xe')]('***\x20***\x20subscription\x20ID\x20',_0x922cdf);getSubByIdAndCheckoutSessionCompletedEvnt(_0x922cdf)[_0x1ede('0x86')](function(_0x2f5a8c){winston['info'](_0x1ede('0x2f'),_0x2f5a8c);if(_0x2f5a8c){var _0x59daf6=_0x2f5a8c[_0x1ede('0x25')];winston[_0x1ede('0xe')](_0x1ede('0x66'),_0x59daf6);var _0x220aba=_0x2f5a8c[_0x1ede('0x30')];winston[_0x1ede('0xe')](_0x1ede('0x6'),_0x220aba);}var _0x22b374={'profile':{'subscriptionId':_0x922cdf,'name':_0x1ede('0x1c'),'type':_0x1ede('0x1a'),'agents':0x1,'last_stripe_event':_0x4a1133[_0x1ede('0x61')]}};updateProjectProfile(_0x59daf6,_0x22b374,_0x1ede('0x7d'));saveOnDB(_0x922cdf,_0x59daf6,_0x4a1133[_0x1ede('0x8')][_0x1ede('0x8a')],_0x220aba,_0x4a1133[_0x1ede('0x61')],_0x478e7b,0x1);})[_0x1ede('0x9c')](function(_0x47abb7){winston[_0x1ede('0x14')](_0x1ede('0xd'),_0x47abb7);});}_0x7c1d15[_0x1ede('0x3d')]({'received':!![]});});function getSubByIdAndCheckoutSessionCompletedEvnt(_0x2bcd42){return new Promise(function(_0x71b022,_0xab67e3){SubscriptionPayment['findOne']({'subscription_id':_0x2bcd42,'stripe_event':_0x1ede('0x8c')},function(_0x21d741,_0xd13c93){if(_0x21d741)_0xab67e3(_0x21d741);var _0x279da8=_0xd13c93;_0x71b022(_0x279da8);});});};function getSubscritionById(_0x4f8c9d){return new Promise(function(_0x55322a,_0x211b3a){const _0x398a65=require(_0x1ede('0x6e'))(apiSecretKey);_0x398a65[_0x1ede('0x62')][_0x1ede('0x18')](_0x4f8c9d,function(_0x36eae1,_0x3e312a){if(_0x36eae1)_0x211b3a(_0x36eae1);var _0x3e312a=_0x3e312a;_0x55322a(_0x3e312a);});});};function updateProjectProfile(_0x4d6037,_0x1de766,_0x17498a){Project[_0x1ede('0x9b')](_0x4d6037,_0x1de766,{'new':!![],'upsert':!![]},function(_0x10b3cd,_0x2f58ed){if(_0x10b3cd){winston['error'](_0x1ede('0x28'),_0x10b3cd);}else{winston[_0x1ede('0x8f')](_0x2f58ed);}});}function saveOnDB(_0x58bb42,_0x30488d,_0x49e946,_0x442185,_0x438509,_0x4af5f9,_0x5da100){winston[_0x1ede('0xe')]('saveOnDB\x20plan_name',_0x4af5f9);winston['info'](_0x1ede('0x70'),_0x5da100);var _0x5e6118=new SubscriptionPayment({'_id':new mongoose['Types']['ObjectId'](),'subscription_id':_0x58bb42,'project_id':_0x30488d,'user_id':_0x442185,'stripe_event':_0x438509,'plan_name':_0x4af5f9,'agents':_0x5da100,'object':_0x49e946});_0x5e6118[_0x1ede('0x93')](function(_0x4fc22b,_0x27dca9){if(_0x4fc22b){winston[_0x1ede('0x14')](_0x1ede('0x43'),_0x4fc22b);return res['status'](0x1f4)[_0x1ede('0x52')]({'success':![],'msg':_0x1ede('0x2c')});}winston[_0x1ede('0xe')](_0x1ede('0x4'),_0x27dca9);});}router[_0x1ede('0x48')](_0x1ede('0x7a'),[passport[_0x1ede('0x8b')]([_0x1ede('0x42'),'jwt'],{'session':![]}),validtoken],function(_0x2a7ef5,_0x56d566){var _0x1d07ef=_0x2a7ef5['body'][_0x1ede('0xa1')];var _0x338e23=_0x2a7ef5[_0x1ede('0x1e')]['userid'];winston[_0x1ede('0xe')](_0x1ede('0x24'),_0x1d07ef);winston['info'](_0x1ede('0x75'),_0x338e23);Project['findOne']({'_id':_0x1d07ef},function(_0x4904d2,_0x5994ce){if(_0x4904d2){winston[_0x1ede('0x14')](_0x1ede('0x95'),_0x4904d2);return _0x4904d2;}if(_0x5994ce){winston[_0x1ede('0xe')](_0x1ede('0x98'),_0x5994ce);var _0x8109ef=_0x5994ce[_0x1ede('0xa7')][_0x1ede('0x2e')];const _0x200e6c=require(_0x1ede('0x6e'))(apiSecretKey);_0x200e6c[_0x1ede('0x62')]['del'](_0x8109ef,function(_0x48ae50,_0x19b429){if(_0x48ae50){winston[_0x1ede('0x14')]('--\x20>\x20cancelsubscription\x20\x20err\x20',_0x48ae50);return _0x56d566[_0x1ede('0x47')](0x1f4)[_0x1ede('0x52')]({'success':![],'msg':_0x48ae50});}winston[_0x1ede('0xe')]('--\x20>\x20cancelsubscription\x20confirmation\x20',_0x19b429);_0x56d566[_0x1ede('0x3d')](_0x19b429);});}});});router['put'](_0x1ede('0x45'),[passport['authenticate']([_0x1ede('0x42'),_0x1ede('0x1f')],{'session':![]}),validtoken],function(_0x44726d,_0x2463a6){var _0x135762=_0x44726d[_0x1ede('0x1e')][_0x1ede('0xa1')];var _0x2fa329=_0x44726d['body'][_0x1ede('0x4d')];var _0x544142=_0x44726d[_0x1ede('0x1e')][_0x1ede('0x1b')];winston[_0x1ede('0xe')](_0x1ede('0x59'),_0x135762);winston[_0x1ede('0xe')](_0x1ede('0x88'),_0x2fa329);winston[_0x1ede('0xe')](_0x1ede('0x3'),_0x544142);const _0x4fbc9e=require(_0x1ede('0x6e'))(apiSecretKey);Project[_0x1ede('0x9')]({'_id':_0x135762},function(_0x1594c1,_0x54a194){if(_0x1594c1){winston[_0x1ede('0x14')](_0x1ede('0x83'),_0x1594c1);return _0x1594c1;}if(_0x54a194){winston[_0x1ede('0xe')](_0x1ede('0x76'),_0x54a194);var _0xf5ae0c=_0x54a194['profile'][_0x1ede('0x2e')];_0x4fbc9e[_0x1ede('0x62')]['update'](_0xf5ae0c);}});});router['get'](_0x1ede('0x9f'),[passport[_0x1ede('0x8b')]([_0x1ede('0x42'),'jwt'],{'session':![]}),validtoken],function(_0x228057,_0x417914){SubscriptionPayment[_0x1ede('0x38')]({'subscription_id':_0x228057[_0x1ede('0x1d')][_0x1ede('0x90')]})['sort']({'object.created':_0x1ede('0xc')})[_0x1ede('0x8e')](function(_0x275266,_0x6acbd6){if(_0x275266){winston[_0x1ede('0x14')](_0x1ede('0x53'),project);return _0x417914[_0x1ede('0x47')](0x1f4)[_0x1ede('0x52')]({'success':![],'msg':_0x275266});}_0x417914[_0x1ede('0x3d')](_0x6acbd6);});});router[_0x1ede('0x6c')]('/stripesubs/:subscriptionid',[passport[_0x1ede('0x8b')]([_0x1ede('0x42'),_0x1ede('0x1f')],{'session':![]}),validtoken],function(_0x3c3248,_0x2ccf4f){winston[_0x1ede('0xe')](_0x1ede('0xf'),_0x3c3248[_0x1ede('0x1d')][_0x1ede('0x90')]);var _0x355361=require(_0x1ede('0x6e'))(apiSecretKey);_0x355361[_0x1ede('0x62')]['retrieve'](_0x3c3248[_0x1ede('0x1d')][_0x1ede('0x90')],function(_0x3a61f5,_0x43e6d6){if(_0x3a61f5){winston['error'](_0x1ede('0x3a'),_0x3a61f5);return _0x2ccf4f[_0x1ede('0x47')](0x1f4)[_0x1ede('0x52')]({'success':![],'msg':_0x3a61f5});}winston[_0x1ede('0xe')](_0x1ede('0x15'),_0x43e6d6);_0x2ccf4f[_0x1ede('0x3d')](_0x43e6d6);});});router[_0x1ede('0x6c')](_0x1ede('0x3b'),[passport[_0x1ede('0x8b')]([_0x1ede('0x42'),_0x1ede('0x1f')],{'session':![]}),validtoken],function(_0x2bc460,_0x28865a){winston[_0x1ede('0xe')](_0x1ede('0x5'),_0x2bc460[_0x1ede('0x1d')]['sessionid']);var _0x588b68=require(_0x1ede('0x6e'))(apiSecretKey);_0x588b68[_0x1ede('0x8d')][_0x1ede('0x29')]['retrieve'](_0x2bc460[_0x1ede('0x1d')][_0x1ede('0x6b')],function(_0x52b936,_0x526062){if(_0x52b936){winston[_0x1ede('0xe')]('--\x20>\x20checkoutSession\x20get\x20by\x20id\x20from\x20stripe\x20\x20err\x20',_0x52b936);return _0x28865a[_0x1ede('0x47')](0x1f4)['send']({'success':![],'msg':_0x52b936});}winston['info'](_0x1ede('0xa5'),_0x526062);_0x28865a[_0x1ede('0x3d')](_0x526062);});});router[_0x1ede('0x6c')](_0x1ede('0x10'),[passport[_0x1ede('0x8b')](['basic',_0x1ede('0x1f')],{'session':![]}),validtoken],function(_0x3519ec,_0x47ef8f){winston[_0x1ede('0x8f')](_0x1ede('0x4b'),_0x3519ec[_0x1ede('0x1d')]);var _0x36a6fa=_0x3519ec[_0x1ede('0x1d')][_0x1ede('0xa1')];winston[_0x1ede('0x8f')](_0x1ede('0x34'),_0x36a6fa);SubscriptionPayment[_0x1ede('0x38')]({'project_id':_0x36a6fa,'stripe_event':_0x1ede('0x8c')},async function(_0x1dc0cb,_0x3903ba){if(_0x1dc0cb){winston[_0x1ede('0x8f')](_0x1ede('0x85'),_0x1dc0cb);return _0x1dc0cb;}if(_0x3903ba){_0x3903ba[0x0]['object'][_0x1ede('0x82')];winston[_0x1ede('0x8f')](_0x1ede('0x87'),_0x3903ba[0x0][_0x1ede('0x8a')][_0x1ede('0x82')]);const _0x59a955=_0x3903ba[0x0]['object'][_0x1ede('0x82')];const _0x5dc2fc=require('stripe')(apiSecretKey);const _0x17a191=await _0x5dc2fc[_0x1ede('0x67')]['retrieve'](_0x59a955);winston[_0x1ede('0x8f')]('--\x20>\x20get\x20customer\x20from\x20db\x20>\x20customer\x20from\x20stripe\x20API\x20',_0x17a191);const _0x59cf7b=await _0x5dc2fc['paymentMethods'][_0x1ede('0x44')]({'customer':_0x59a955,'type':_0x1ede('0xa6')});_0x17a191[_0x1ede('0xa4')]=_0x59cf7b;winston[_0x1ede('0x8f')](_0x1ede('0x2d'),_0x3903ba);_0x47ef8f[_0x1ede('0x3d')](_0x17a191);}});});router[_0x1ede('0x3e')](_0x1ede('0x7'),[passport[_0x1ede('0x8b')](['basic',_0x1ede('0x1f')],{'session':![]}),validtoken],async function(_0x16f30d,_0x575dc6){var _0x1e0716=_0x16f30d[_0x1ede('0x1d')][_0x1ede('0x2b')];winston[_0x1ede('0x8f')]('»»»\x20»»»\x20\x20update\x20customer\x20-\x20customerid\x20from\x20params\x20',_0x1e0716);winston[_0x1ede('0x8f')](_0x1ede('0x2'),_0x16f30d['body']);const _0x167d83=require('stripe')(apiSecretKey);let _0x250b70;try{_0x250b70=await _0x167d83[_0x1ede('0xa4')][_0x1ede('0x3f')]({'type':_0x1ede('0xa6'),'card':{'number':_0x16f30d[_0x1ede('0x1e')][_0x1ede('0xa2')],'exp_month':_0x16f30d[_0x1ede('0x1e')][_0x1ede('0x5e')],'exp_year':_0x16f30d[_0x1ede('0x1e')][_0x1ede('0x31')],'cvc':_0x16f30d[_0x1ede('0x1e')][_0x1ede('0x55')]}});}catch(_0x39d93f){winston[_0x1ede('0x14')](_0x1ede('0x57'),_0x39d93f);return _0x575dc6[_0x1ede('0x47')](0x1f6)[_0x1ede('0x52')]({'success':![],'msg':_0x39d93f});}winston[_0x1ede('0x8f')](_0x1ede('0xa0'),_0x250b70);try{const _0x3ec379=await _0x167d83[_0x1ede('0xa4')][_0x1ede('0x68')](_0x250b70['id'],{'customer':_0x1e0716});winston[_0x1ede('0x8f')]('»»»\x20»»»\x20\x20paymentMethod\x20attached\x20',_0x3ec379);}catch(_0x44ce2f){winston[_0x1ede('0x14')](_0x1ede('0x37'),_0x44ce2f);return _0x575dc6[_0x1ede('0x47')](0x1f5)[_0x1ede('0x52')]({'success':![],'msg':_0x44ce2f});}const _0x4d24a5=await _0x167d83['customers'][_0x1ede('0x5d')](_0x1e0716,{'invoice_settings':{'default_payment_method':_0x250b70['id']}});_0x575dc6[_0x1ede('0x3d')](_0x4d24a5);});router['get'](_0x1ede('0x49'),[passport[_0x1ede('0x8b')]([_0x1ede('0x42'),_0x1ede('0x1f')],{'session':![]}),validtoken],async function(_0x1c9426,_0x59f11b){winston['info']('get\x20PaymentMethods\x20list\x20req.params',_0x1c9426['params']);var _0x6affe4=_0x1c9426[_0x1ede('0x1d')]['customerid'];winston[_0x1ede('0x8f')]('get\x20PaymentMethods\x20list\x20req.params\x20>\x20customer_id\x20',_0x6affe4);const _0x64b170=require('stripe')(apiSecretKey);const _0x2c364a=await _0x64b170[_0x1ede('0x67')][_0x1ede('0x18')](_0x6affe4);const _0x1dfe60=_0x2c364a['invoice_settings'][_0x1ede('0xa3')];let _0x2ab929;try{_0x2ab929=await _0x64b170[_0x1ede('0xa4')][_0x1ede('0x44')]({'customer':_0x6affe4,'type':_0x1ede('0xa6')});winston[_0x1ede('0x8f')]('get\x20PaymentMethods\x20list\x20>\x20paymentMethods\x20',_0x2ab929);}catch(_0x3e4ce5){return _0x59f11b[_0x1ede('0x47')](0x1f5)[_0x1ede('0x52')]({'success':![],'msg':_0x3e4ce5});}winston[_0x1ede('0x8f')](_0x1ede('0x4e'),_0x1dfe60);_0x2ab929['data']['forEach'](_0x4f9310=>{if(_0x4f9310['id']!==_0x1dfe60){winston[_0x1ede('0x8f')](_0x1ede('0x35'),_0x4f9310['id']);detachPaymentFunc(_0x4f9310['id'],function(_0x37bfbd){winston[_0x1ede('0xe')](_0x1ede('0x50'),_0x37bfbd);});}});_0x59f11b[_0x1ede('0x3d')](_0x2ab929);});async function detachPaymentFunc(_0x199911,_0x38e8a4){winston[_0x1ede('0x8f')](_0x1ede('0x4a'),_0x199911);const _0x1f3f5e=require('stripe')(apiSecretKey);let _0x30377a;try{_0x30377a=await _0x1f3f5e[_0x1ede('0xa4')][_0x1ede('0x4f')](_0x199911);_0x38e8a4(_0x30377a);}catch(_0x2d6907){_0x38e8a4(_0x2d6907);}}module[_0x1ede('0x27')]=router;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBheW1lbnRzL3N0cmlwZS9pbmRleC5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIndpbnN0b24iLCJQcm9qZWN0IiwiU3Vic2NyaXB0aW9uUGF5bWVudCIsIm1vbWVudCIsIm1vbmdvb3NlIiwicGFzc3BvcnQiLCJ2YWxpZHRva2VuIiwiYXBpS2V5IiwicHJvY2VzcyIsInN0cmlwZSIsImVuZHBvaW50U2VjcmV0IiwiYXBpU2VjcmV0S2V5IiwiYm9keVBhcnNlciIsIl8weGY3ZjlmMSIsIl8weDdjMWQxNSIsIl8weDU3Mjg4MSIsIl8weDRhMTEzMyIsIl8weDI2NTA2OCIsIl8weDU5MTRiNSIsIl8weDU5NTc4MCIsIl8weDUxMDk2YSIsIl8weDNlZDNlYiIsIl8weDQ3OGU3YiIsIl8weDJlZTk4OCIsIl8weDJmZDQ3ZiIsIk51bWJlciIsIl8weDkyMmNkZiIsImdldFN1YnNjcml0aW9uQnlJZCIsIl8weDRlM2JiNyIsIl8weDRhMGU1YyIsIl8weDNlMDNlNCIsIl8weDQ4MWMwZiIsIl8weDExNzY2NiIsInVwZGF0ZVByb2plY3RQcm9maWxlIiwic2F2ZU9uREIiLCJfMHgyM2RmZTAiLCJfMHgyZWMxMjkiLCJfMHgxNzQ4YWMiLCJfMHgyOTM0ZjIiLCJfMHgzMGMzNmMiLCJnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudCIsIl8weDVhOGY2YyIsIl8weDRmMDI3MCIsIl8weDUxOTM5MiIsIl8weDI3NDk1YiIsIl8weDU0Y2U0YyIsIl8weGJmZDU5MiIsIl8weDcxM2UwYiIsIl8weDFlYjljMiIsIl8weDE2OTIxOSIsIl8weDJmNWE4YyIsIl8weDU5ZGFmNiIsIl8weDIyMGFiYSIsIl8weDIyYjM3NCIsIl8weDQ3YWJiNyIsIl8weDJiY2Q0MiIsIlByb21pc2UiLCJfMHg3MWIwMjIiLCJfMHhhYjY3ZTMiLCJfMHgyMWQ3NDEiLCJfMHhkMTNjOTMiLCJfMHgyNzlkYTgiLCJfMHg0ZjhjOWQiLCJfMHg1NTMyMmEiLCJfMHgyMTFiM2EiLCJfMHgzOThhNjUiLCJfMHgzNmVhZTEiLCJfMHgzZTMxMmEiLCJfMHg0ZDYwMzciLCJfMHgxZGU3NjYiLCJfMHgxNzQ5OGEiLCJfMHgxMGIzY2QiLCJfMHgyZjU4ZWQiLCJfMHg1OGJiNDIiLCJfMHgzMDQ4OGQiLCJfMHg0OWU5NDYiLCJfMHg0NDIxODUiLCJfMHg0Mzg1MDkiLCJfMHg0YWY1ZjkiLCJfMHg1ZGExMDAiLCJfMHg1ZTYxMTgiLCJfMHg0ZmMyMmIiLCJfMHgyN2RjYTkiLCJyZXMiLCJfMHgyYTdlZjUiLCJfMHg1NmQ1NjYiLCJfMHgxZDA3ZWYiLCJfMHgzMzhlMjMiLCJfMHg0OTA0ZDIiLCJfMHg1OTk0Y2UiLCJfMHg4MTA5ZWYiLCJfMHgyMDBlNmMiLCJfMHg0OGFlNTAiLCJfMHgxOWI0MjkiLCJfMHg0NDcyNmQiLCJfMHgyNDYzYTYiLCJfMHgxMzU3NjIiLCJfMHgyZmEzMjkiLCJfMHg1NDQxNDIiLCJfMHg0ZmJjOWUiLCJfMHgxNTk0YzEiLCJfMHg1NGExOTQiLCJfMHhmNWFlMGMiLCJfMHgyMjgwNTciLCJfMHg0MTc5MTQiLCJfMHgyNzUyNjYiLCJfMHg2YWNiZDYiLCJwcm9qZWN0IiwiXzB4M2MzMjQ4IiwiXzB4MmNjZjRmIiwiXzB4MzU1MzYxIiwiXzB4M2E2MWY1IiwiXzB4NDNlNmQ2IiwiXzB4MmJjNDYwIiwiXzB4Mjg4NjVhIiwiXzB4NTg4YjY4IiwiXzB4NTJiOTM2IiwiXzB4NTI2MDYyIiwiXzB4MzUxOWVjIiwiXzB4NDdlZjhmIiwiXzB4MzZhNmZhIiwiXzB4MWRjMGNiIiwiXzB4MzkwM2JhIiwiXzB4NTlhOTU1IiwiXzB4NWRjMmZjIiwiXzB4MTdhMTkxIiwiXzB4NTljZjdiIiwiXzB4MTZmMzBkIiwiXzB4NTc1ZGM2IiwiXzB4MWUwNzE2IiwiXzB4MTY3ZDgzIiwiXzB4MjUwYjcwIiwiXzB4MzlkOTNmIiwiXzB4M2VjMzc5IiwiXzB4NDRjZTJmIiwiXzB4NGQyNGE1IiwiXzB4MWM5NDI2IiwiXzB4NTlmMTFiIiwiXzB4NmFmZmU0IiwiXzB4NjRiMTcwIiwiXzB4MmMzNjRhIiwiXzB4MWRmZTYwIiwiXzB4MmFiOTI5IiwiXzB4M2U0Y2U1IiwiXzB4NGY5MzEwIiwiZGV0YWNoUGF5bWVudEZ1bmMiLCJfMHgzN2JmYmQiLCJfMHgxOTk5MTEiLCJfMHgzOGU4YTQiLCJfMHgxZjNmNWUiLCJfMHgzMDM3N2EiLCJfMHgyZDY5MDciLCJtb2R1bGUiXSwibWFwcGluZ3MiOiJ1aUxBQUEsSUFBSUEsT0FBQSxDQUFVQyxPQUFBLEMsZUFBQSxDQUFkLENBQ0EsSUFBSUMsTUFBQSxDQUFTRixPQUFBLEMsZUFBQSxHQUFiLENBRUEsSUFBSUcsT0FBQSxDQUFVRixPQUFBLEMseUJBQUEsQ0FBZCxDQUVBLElBQUlHLE9BQUEsQ0FBVUgsT0FBQSxDLGVBQUEsQ0FBZCxDQUNBLElBQUlJLG1CQUFBLENBQXNCSixPQUFBLEMsZUFBQSxDQUExQixDQUNBLElBQUlLLE1BQUEsQ0FBU0wsT0FBQSxDLGVBQUEsQ0FBYixDQUNBLElBQUlNLFFBQUEsQ0FBV04sT0FBQSxDLGVBQUEsQ0FBZixDQUNBLElBQUlPLFFBQUEsQ0FBV1AsT0FBQSxDLGVBQUEsQ0FBZixDQUVBQSxPQUFBLEMsOEJBQUEsRUFBd0NPLFFBQXhDLEVBRUEsSUFBSUMsVUFBQSxDQUFhUixPQUFBLEMsZUFBQSxDQUFqQixDQUdBLE1BQU1TLE1BQUEsQ0FBU0MsT0FBQSxDLGVBQUEsRSxlQUFBLENBQWYsQ0FDQVIsT0FBQSxDLE9BQUEsRSxlQUFjLENBQWtCTyxNQUFoQyxFQUVBLE1BQU1FLE1BQUEsQ0FBU1gsT0FBQSxDLGVBQUEsRUFBa0JTLE1BQWxCLENBQWYsQ0FHQSxNQUFNRyxjQUFBLENBQWlCRixPQUFBLEMsS0FBQSxFLGVBQUEsQ0FBdkIsQ0FDQVIsT0FBQSxDLGVBQUEsRSxjQUFjLENBQTBCVSxjQUF4QyxFQUVBLE1BQU1DLFlBQUEsQ0FBZUgsT0FBQSxDLEtBQUEsRSwrQkFBQSxDQUFyQixDQUNBUixPQUFBLEMsZUFBQSxFLGVBQWMsQ0FBd0JXLFlBQXRDLEVBRUEsTUFBTUMsVUFBQSxD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QSxDQUFnQixNQUFNRCxTQUFBLEMsZUFBQSxFLGVBQUEsRUFDcEJGLFNBRG9CLENBQXRCLENBR0FDLFNBQUEsQ0FBU0UsU0FBVCxFQUpFLENBS0YsTUFBT0MsU0FBUCxDQUFVLENBQ1ZILFNBQUEsQ0FBU0csU0FBVCxFQURVLENBVDhDLENBaUQ1REMsTUFBQSxDLGVBQUEsRUFBaUJ6SixNQUFqQiIsInNvdXJjZXNDb250ZW50IjpbInZhciBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xudmFyIHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG4vLyB2YXIgd2luc3RvbiA9IHJlcXVpcmUoJy4uLy4uLy4uLy4uL2NvbmZpZy93aW5zdG9uJyk7XG52YXIgd2luc3RvbiA9IHJlcXVpcmUoJy4uLy4uLy4uL2NvbmZpZy93aW5zdG9uJylcbi8vIHZhciBQcm9qZWN0ID0gcmVxdWlyZShcIi4uLy4uLy4uLy4uL21vZGVscy9wcm9qZWN0XCIpO1xudmFyIFByb2plY3QgPSByZXF1aXJlKFwiLi4vLi4vLi4vbW9kZWxzL3Byb2plY3RcIik7XG52YXIgU3Vic2NyaXB0aW9uUGF5bWVudCA9IHJlcXVpcmUoXCIuLi9tb2RlbHMvc3Vic2NyaXB0aW9uLXBheW1lbnRcIik7XG52YXIgbW9tZW50ID0gcmVxdWlyZSgnbW9tZW50Jyk7XG52YXIgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xudmFyIHBhc3Nwb3J0ID0gcmVxdWlyZSgncGFzc3BvcnQnKTtcbi8vIHJlcXVpcmUoJy4uLy4uLy4uLy4uL21pZGRsZXdhcmUvcGFzc3BvcnQnKShwYXNzcG9ydCk7XG5yZXF1aXJlKFwiLi4vLi4vLi4vbWlkZGxld2FyZS9wYXNzcG9ydFwiKShwYXNzcG9ydCk7XG4vLyB2YXIgdmFsaWR0b2tlbiA9IHJlcXVpcmUoJy4uLy4uLy4uLy4uL21pZGRsZXdhcmUvdmFsaWQtdG9rZW4nKVxudmFyIHZhbGlkdG9rZW4gPSByZXF1aXJlKCcuLi8uLi8uLi9taWRkbGV3YXJlL3ZhbGlkLXRva2VuJylcbi8vIFNldCB5b3VyIHNlY3JldCBrZXk6IHJlbWVtYmVyIHRvIGNoYW5nZSB0aGlzIHRvIHlvdXIgbGl2ZSBzZWNyZXQga2V5IGluIHByb2R1Y3Rpb25cbi8vIFNlZSB5b3VyIGtleXMgaGVyZTogaHR0cHM6Ly9kYXNoYm9hcmQuc3RyaXBlLmNvbS9hY2NvdW50L2FwaWtleXNcbmNvbnN0IGFwaUtleSA9IHByb2Nlc3MuZW52LlBBWU1FTlRfU1RSSVBFX0FQSUtFWTtcbndpbnN0b24uZGVidWcoJ3N0cmlwZSBhcGlLZXknICsgYXBpS2V5KTtcblxuY29uc3Qgc3RyaXBlID0gcmVxdWlyZSgnc3RyaXBlJykoYXBpS2V5KTtcblxuLy8gRmluZCB5b3VyIGVuZHBvaW50J3Mgc2VjcmV0IGluIHlvdXIgRGFzaGJvYXJkJ3Mgd2ViaG9vayBzZXR0aW5nc1xuY29uc3QgZW5kcG9pbnRTZWNyZXQgPSBwcm9jZXNzLmVudi5QQVlNRU5UX1NUUklQRV9TRUNSRVQ7XG53aW5zdG9uLmRlYnVnKCdzdHJpcGUgZW5kcG9pbnRTZWNyZXQnICsgZW5kcG9pbnRTZWNyZXQpO1xuXG5jb25zdCBhcGlTZWNyZXRLZXkgPSBwcm9jZXNzLmVudi5QQVlNRU5UX1NUUklQRV9BUElfU0VDUkVUX0tFWTtcbndpbnN0b24uZGVidWcoJ3N0cmlwZSBhcGlTZWNyZXRLZXknICsgYXBpU2VjcmV0S2V5KTtcblxuY29uc3QgYm9keVBhcnNlciA9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJyk7XG5cbi8vIGh0dHBzOi8vc3RyaXBlLmNvbS9kb2NzL3BheW1lbnRzL2NoZWNrb3V0L2Z1bGZpbGxtZW50I3dlYmhvb2tzXG4vLyBjdXJsIC1YIFBPU1QgLXUgYW5kcmVhLmxlb0BmMjEuaXQ6MTIzNDU2IC1IICdDb250ZW50LVR5cGU6YXBwbGljYXRpb24vanNvbicgLWQgJ3tcInR5cGVcIjpcInBheW1lbnRfaW50ZW50LnN1Y2NlZWRlZFwifScgIGh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9tb2R1bGVzL3BheW1lbnRzL3N0cmlwZS93ZWJob29rXG5yb3V0ZXIucG9zdCgnL3dlYmhvb2snLCBib2R5UGFyc2VyLnJhdyh7IHR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyB9KSwgZnVuY3Rpb24gKHJlcXVlc3QsIHJlc3BvbnNlKSB7XG4gIFxuICB3aW5zdG9uLmRlYnVnKCfCu8K7wrvCuyBzdHJpcGUgZW5kcG9pbnRTZWNyZXQ6ICcgKyBlbmRwb2ludFNlY3JldClcbiAgd2luc3Rvbi5kZWJ1ZygnwrvCu8K7wrsgc3RyaXBlIGFwaUtleTogJyArIGFwaUtleSk7XG4gIHdpbnN0b24uZGVidWcoJ3N0cmlwZSBhcGlTZWNyZXRLZXknICsgYXBpU2VjcmV0S2V5KTtcblxuICBjb25zdCBzaWcgPSByZXF1ZXN0LmhlYWRlcnNbJ3N0cmlwZS1zaWduYXR1cmUnXTtcblxuICB3aW5zdG9uLmRlYnVnKCdzdHJpcGUgc2lnOiAnLCBzaWcpXG5cbiAgbGV0IGV2ZW50O1xuXG4gIHRyeSB7XG4gICAgZXZlbnQgPSBzdHJpcGUud2ViaG9va3MuY29uc3RydWN0RXZlbnQocmVxdWVzdC5yYXdCb2R5LCBzaWcsIGVuZHBvaW50U2VjcmV0KTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgd2luc3Rvbi5lcnJvcignKioqKiBTdHJpcGUgZXJyb3IgY29uc3RydWN0RXZlbnQ6ICcsIGVyci5tZXNzYWdlKVxuICAgIHJldHVybiByZXNwb25zZS5zdGF0dXMoNDAwKS5zZW5kKGBXZWJob29rIEVycm9yOiAke2Vyci5tZXNzYWdlfWApO1xuICB9XG5cbiAgLyoqXG4gICAqKiEgKioqIEhhbmRsZSB0aGUgY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWQgZXZlbnQgKioqXG4gICAqIE5PVEU6IFRISVMgRVZFTlQgT0NDVVIgT05MWSBXSEVOIElTIENSRUFURUQgQSBORVcgU1VCU0NSSVBUSU9OXG4gICAqIDEpIEZST00gVEhFIFBST1BFUlRZIFwiY2xpZW50X3JlZmVyZW5jZV9pZFwiIEFSRSBPQlRBSU5FRCBUSEU6XG4gICAqICAgIEEpIFVTRVIgSURcbiAgICogICAgQikgUFJPSkVDVCBJRCBcbiAgICogMikgV0lUSCBUSEUgc3Vic2NyaXB0aW9uIElEIChOT1RFIGlzIHRoZSBwcm9wZXJ0eSBzdWJzY3JpcHRpb24pIElTIFJVTk5FRCBBIENBTExCQUNLIFRPIFNUUklQRVxuICAgKiAgICBUTyBPQlRBSU4gVEhFIE9CSkVDVCBcIlNVQlNDUklQVElPTlwiIEFORCBUSEVOIEZST00gVEhJUyBBUkUgT0JUQUlORUQgVEhFOlxuICAgKiAgICBBKSBzdWJzY3JpcHRpb25TdGFydERhdGVcbiAgICogICAgQikgc3Vic2NyaXB0aW9uRW5kRGF0ZVxuICAgKiAgICBDKSBxdWFudGl0eSAod2hpY2ggaW4gdGhlIHRpbGVkZXNrIGRhc2hib2FyZCBjb3JyZXNwb25kcyB0byB0aGUgbnVtYmVyIG9mIGFnZW50cyAvIG9wZXJhdG9ycyBzZWF0cylcbiAgICogMykgV0lUSCBUSEUgT0JUQUlORUQgREFUQSBJUyBVUERBVEVEIFRIRSBQUk9KRUNUICdQUk9GSUxFJyAoaXMgYW4gb2JqZWN0IG5lc3RlZCBpbiB0aGUgcHJvamVjdCBvYmplY3QpIFxuICAgKiA0KSBUSEUgT0JUQUlORUQgT0JKRUNUIFwiU1VCU0NSSVBUSU9OXCIgQU5EIHRoZSBcIlNVQlNDUklQVElPTiBJRFwiLCB0aGUgXCJQUk9KRUNUIElEXCIsIHRoZSBcIlVTRVIgSURcIiBBTkQgc3RyaXBlX2V2ZW50OiBcImNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkXCIgQVJFIFNBVkVEIE9OIE9VUiBEQlxuICAgKiAgICBBUyBcIlNVQlNDUklQVElPTi1QQVlNRU5UXCJcbiAgICovXG5cbiAgaWYgKGV2ZW50LnR5cGUgPT09ICdjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZCcpIHtcbiAgICB3aW5zdG9uLmRlYnVnKCchISEhISEhISBISSAhISEhISEhISBjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZCcpO1xuXG4gICAgY29uc3Qgc2Vzc2lvbiA9IGV2ZW50LmRhdGEub2JqZWN0O1xuICAgIHdpbnN0b24uaW5mbygnc3RyaXBlIGNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkJywgc2Vzc2lvbik7XG5cbiAgICB2YXIgY2xpZW50X3JlZmVyZW5jZV9pZCA9IHNlc3Npb24uY2xpZW50X3JlZmVyZW5jZV9pZDtcbiAgICB3aW5zdG9uLmluZm8oJ3N0cmlwZSBjbGllbnRfcmVmZXJlbmNlX2lkJywgY2xpZW50X3JlZmVyZW5jZV9pZCk7XG5cbiAgICAvKiogMUEgKi9cbiAgICB2YXIgdXNlcl9pZCA9IGNsaWVudF9yZWZlcmVuY2VfaWQuc3BsaXQoXCJfXCIpWzBdO1xuICAgIHdpbnN0b24uaW5mbygnc3RyaXBlIHVzZXJfaWQ6JyArIHVzZXJfaWQpO1xuXG4gICAgLyoqIDFCICovXG4gICAgdmFyIHByb2plY3RfaWQgPSBjbGllbnRfcmVmZXJlbmNlX2lkLnNwbGl0KFwiX1wiKVsxXTtcbiAgICB3aW5zdG9uLmluZm8oJ3N0cmlwZSBwcm9qZWN0X2lkOiAnICsgcHJvamVjdF9pZCk7XG5cbiAgICB2YXIgcGxhbl9uYW1lID0gY2xpZW50X3JlZmVyZW5jZV9pZC5zcGxpdChcIl9cIilbMl07XG4gICAgd2luc3Rvbi5pbmZvKCdzdHJpcGUgcGxhbl9uYW1lOiAnICsgcGxhbl9uYW1lKTtcblxuICAgIHZhciBzZWF0c19udW1Bc1N0cmluZyA9IGNsaWVudF9yZWZlcmVuY2VfaWQuc3BsaXQoXCJfXCIpWzNdO1xuICAgIHdpbnN0b24uaW5mbygnc3RyaXBlIHNlYXRzX251bTogJyArIHNlYXRzX251bUFzU3RyaW5nICsgJ3R5cGVvZiAnLCB0eXBlb2Ygc2VhdHNfbnVtQXNTdHJpbmcpO1xuXG4gICAgdmFyIHNlYXRzX251bSA9IE51bWJlcihzZWF0c19udW1Bc1N0cmluZylcbiAgICB3aW5zdG9uLmluZm8oJ3N0cmlwZSBzZWF0c19udW1Bc1N0cmluZzogJyArIHNlYXRzX251bSArICcgdHlwZW9mICcsIHR5cGVvZiBzZWF0c19udW0pO1xuXG4gICAgdmFyIHN1YnNjcmlwdGlvbklkID0gZXZlbnQuZGF0YS5vYmplY3Quc3Vic2NyaXB0aW9uO1xuICAgIHdpbnN0b24uaW5mbygnKioqICoqKiAhISEhISEhISEhISEhISEhISEhISEhIGNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkIC0gc3Vic2NyaXB0aW9uIElEOiAnLCBzdWJzY3JpcHRpb25JZCk7XG5cbiAgICBnZXRTdWJzY3JpdGlvbkJ5SWQoc3Vic2NyaXB0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHN1YnNjcmlwdGlvbl9vYmopIHtcblxuICAgICAgdmFyIG9iamVjdF90eXBlID0gc3Vic2NyaXB0aW9uX29iai5vYmplY3Q7XG4gICAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWQgLSBnZXRTdWJzY3JpdGlvbkJ5SWQgc3Vic2NyIG9iamVjdF90eXBlOiAnLCBvYmplY3RfdHlwZSk7XG5cbiAgICAgIC8qKiAyQSAqL1xuICAgICAgdmFyIHN1YnNjcmlwdGlvblN0YXJ0RGF0ZSA9IG1vbWVudC51bml4KHN1YnNjcmlwdGlvbl9vYmouY3VycmVudF9wZXJpb2Rfc3RhcnQpLmZvcm1hdCgnWVlZWS1NTS1ERFRISDptbTpzcy5TU1MnKVxuICAgICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkIC0gZ2V0U3Vic2NyaXRpb25CeUlkICoqKiBzdGFydCAqKiogOiAnLCBzdWJzY3JpcHRpb25TdGFydERhdGUpO1xuXG4gICAgICAvKiogMkIgKi9cbiAgICAgIHZhciBzdWJzY3JpcHRpb25FbmREYXRlID0gbW9tZW50LnVuaXgoc3Vic2NyaXB0aW9uX29iai5jdXJyZW50X3BlcmlvZF9lbmQpLmZvcm1hdCgnWVlZWS1NTS1ERFRISDptbTpzcy5TU1MnKVxuICAgICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkIC0gZ2V0U3Vic2NyaXB0aW9uICoqKiBlbmQgKioqIDogJywgc3Vic2NyaXB0aW9uRW5kRGF0ZSk7XG5cbiAgICAgIC8qKlxuICAgICAgICohICoqKiBCT0RZICoqKlxuICAgICAgICovXG4gICAgICB2YXIgYm9keSA9IHtcbiAgICAgICAgcHJvZmlsZToge1xuICAgICAgICAgIG5hbWU6IHBsYW5fbmFtZSxcbiAgICAgICAgICB0eXBlOiAncGF5bWVudCcsXG4gICAgICAgICAgc3Vic2NyaXB0aW9uX2NyZWF0aW9uX2RhdGU6IHN1YnNjcmlwdGlvblN0YXJ0RGF0ZSxcbiAgICAgICAgICBzdWJTdGFydDogc3Vic2NyaXB0aW9uU3RhcnREYXRlLFxuICAgICAgICAgIHN1YkVuZDogc3Vic2NyaXB0aW9uRW5kRGF0ZSxcbiAgICAgICAgICBzdWJzY3JpcHRpb25JZDogc3Vic2NyaXB0aW9uSWQsXG4gICAgICAgICAgbGFzdF9zdHJpcGVfZXZlbnQ6IGV2ZW50LnR5cGUsXG4gICAgICAgICAgYWdlbnRzOiBzZWF0c19udW1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvKiogMyAqL1xuICAgICAgdXBkYXRlUHJvamVjdFByb2ZpbGUocHJvamVjdF9pZCwgYm9keSwgJ2NoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkJyk7XG5cbiAgICAgIC8qKiA0ICovXG4gICAgICBzYXZlT25EQihzdWJzY3JpcHRpb25JZCwgcHJvamVjdF9pZCwgc3Vic2NyaXB0aW9uX29iaiwgdXNlcl9pZCwgZXZlbnQudHlwZSwgcGxhbl9uYW1lLCBzZWF0c19udW0pXG5cbiAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICB3aW5zdG9uLmVycm9yKCcqKiogKioqIGNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkIC0gZ2V0U3Vic2NyaXRpb25CeUlkIGVyciAnLCBlcnIpO1xuICAgIH0pO1xuXG4gIH1cbiAgLy8gb2JqZWN0X3R5cGUgPSBzdWJzY3JpcHRpb24uXG4gIC8qKlxuICAgKiohICoqKiBIYW5kbGUgdGhlIGludm9pY2UucGF5bWVudF9zdWNjZWVkZWQgZXZlbnQgKioqXG4gICAqIE5PVEU6IFRISVMgRVZFTlQgT0NDVVIgV0hFTiBJUyBDUkVBVEVEIEEgTkVXIFNVQlNDUklQVElPTiBBTkQgRVZFUlkgVElNRSBUSEUgU0FNRSBJUyBSRU5FV0VEXG4gICAqIDEpIEZST00gVEhFIE9CSkVDVCBPRiBUSEUgRVZFTlQgQVJFIE9CVEFJTkVEIFRIRTpcbiAgICogICAgQSkgc3Vic2NyaXB0aW9uU3RhcnREYXRlXG4gICAqICAgIEIpIHN1YnNjcmlwdGlvbkVuZERhdGVcbiAgICogICAgQykgc3Vic2NyaXRwdGlvbklkICBcbiAgICogMikgd2hlbiByZWZlciB0byBhIFJFTkVXQUwgKCBiaWxsaW5nX3JlYXNvbiA9PT0gc3Vic2NyaXB0aW9uX2N5Y2xlKVxuICAgKiAgICBJRiBUSEUgVkFMVUUgT0YgVEhFIFBST1BFUlRZIFwiYmlsbGluZ19yZWFzb25cIiBJUyBVTkxJS0UgT0YgXCJzdWJzY3JpcHRpb25fY3JlYXRlXCIgKE1FQU5TIFRIQVQgVEhFIEVWRU5UIFJFRkVSIFRPIEEgUkVORVdBTCBcbiAgICogICAgRk9SIFdISUNIIGJpbGxpbmdfcmVhc29uOiBzdWJzY3JpcHRpb25fY3ljbGUgQU5EIE5PVCBUTyBUSEUgRklSU1QgU1VCU0NSSVBUSU9OKSBcbiAgICogICAgQSkgSVMgT0JUQUlORUQgVEhFICdTVUJTQ1JJUFRJT04tUEFZTUVOVCcgKHdpdGggc3RyaXBlX2V2ZW50OiBcImNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkXCIpIFNBVkVEIEFCT1ZFIEFORCBUSEVOIEZST00gVEhJUzpcbiAgICogICAgICAgLSBUSEUgXCJQUk9KRUNUIElEXCIgXG4gICAqICAgICAgIC0gVEhFIFwiVVNFUiBJRFwiXG4gICAqICAgICAgIFRPIE9CVEFJTiBUSEUgJ1NVQlNDUklQVElPTi1QQVlNRU5UJ0lOIE9VUiBEQiBJUyBMT09LRUQgRk9SIFRIRSBcIlNVQlNDUklQSU9OLVBBWU1FTlRcIiBUSEFUIEhBUyBGT1Igc3Vic2NyaXB0aW9uIGlkIFRIRSBWQUxVRSBPRiAxQyBBTkQgc3RyaXBlX2V2ZW50OiBcImNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkXCJcbiAgICogICAgICAgVEhFIENPTkRJVElPTiBzdHJpcGVfZXZlbnQ6IFwiY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWRcIiAoTk8gTU9SRTogb2JqZWN0X3R5cGUgPSBzdWJzY3JpcHRpb24pIElUJ1MgTkVDRVNTQVJZIFRPIEZJTFRFUiBUSEUgXCJTVUJTQ1JJUElPTi1QQVlNRU5UU1wiIFxuICAgKiAgICAgICBUSEFUIENPTlRBSU4gVEhFICBQUk9QRVJUSUVTICBcInByb2plY3RJRFwiIEFORCBcInVzZXJJRFwiXG4gICAqICAgICAgIFRIRSBFWElTVEVOQ0UgT0YgQSBcIlNVQlNDUklQVElPTi1QQVlNRU5UXCIgV0lUSE9VVCBcInByb2plY3RJRFwiIEFORCBcInVzZXJJRFwiIElTIERVRSBUTyBUSEUgRkFDVCBUSEFUIEFUIFRIRSBNT01FTlQgT0YgVEhFIENSRUFUSU9OIE9GIEEgU1VCU0NSSVBUSU9OIFxuICAgKiAgICAgICBJUyBTQVZFRCBJTiBPVVIgREIgQUxTTyBBIFwiU1VCU0NSSVBUSU9OLVBBWU1FTlRcIiBDT1JSRVNQT05ESU5HIFRPIFRIRSBPQkpFQ1QgUkVUVVJORUQgQlkgIFRIRSBFVkVOVCBcImludm9pY2UucGF5bWVudF9zdWNjZWVkZWRcIiBVU0VGVUwgQkVDQVVTRSBcbiAgICogICAgICAgSVQgQ09OVEFJTlMgVEhFIExJTktTIE9GIFRIRSBJTlZPSUNFIE9GIFRIRSBGSVJTVCBTVUJTQ1JJUFRJT04gKHVzZWQgYnkgdGlsZWRlc2sgZGFzaGJvYXJkIGluIHRoZSBjb21wb25lbnRzIHBheW1lbnRzKVxuICAgKiAgICAgICBCVVQgRlJPTSBXSElDSCBJVCBJUyBOT1QgUE9TU0lCTEUgUFVTSCBBTkQgVEhFTiBUTyBUTyBPQlRBSU4gVEhFIFwicHJvamVjdElEXCIgQU5EIFwidXNlcklEXCJcbiAgICogICAgQikgSVMgVVBEQVRFRCBUSEUgUFJPSkVDVCAnUFJPRklMRScgV0lUSDpcbiAgICogICAgICAgLSBEQVRBIE9CVEFJTkVEIEZST00gVEhFIEVWRU5UJ1MgT0JKRUNUOlxuICAgKiAgICAgICAgIC0gc3Vic2NyaXB0aW9uU3RhcnREYXRlXG4gICAqICAgICAgICAgLSBzdWJzY3JpcHRpb25FbmREYXRlXG4gICAqICAgICAgICAgLSBzdWJzY3JpcHRpb25JZCBcbiAgICogICAgICAgICAtIGxhc3Rfc3RyaXBlX2V2ZW50IFxuICAgKiAgICAgICAgIC0gcXVhbnRpdHkgKHdoaWNoIGluIHRoZSBkYXNoYm9hcmQgY29ycmVzcG9uZHMgdG8gdGhlIG51bWJlciBvZiBhZ2VudHMgLyBvcGVyYXRvcnMgc2VhdHMpXG4gICAqICAgICAgIC0gREFUQSBPQlRBSU5FRCBGUk9NIFRIRSAnU1VCU0NSSVBUSU9OLVBBWU1FTlQnIHdpdGggc3RyaXBlX2V2ZW50OiBcImNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkXCJcbiAgICogICAgICAgICAtIFwiUFJPSkVDVCBJRFwiIGFuZCBcIlVTRVIgSURcIlxuICAgKiAgICBDKSBUSEUgT0JKRUNUIE9GIFRIRSBFVkVOVCBpbnZvaWNlLnBheW1lbnRfc3VjY2VlZGVkIEFORCB0aGUgXCJTVUJTQ1JJUFRJT04gSURcIiwgdGhlIFwiUFJPSkVDVCBJRFwiLCB0aGUgXCJVU0VSIElEXCIgQU5EIHRoZSBcIk9CSkVDVF9UWVBFXCIgKGV2ZW50KSBcbiAgICogICAgICAgQVJFIFNBVkVEIEFTIFwiU1VCU0NSSVBUSU9OLVBBWU1FTlRcIiBPTiBPVVIgREJcbiAgICogMykgd2hlbiByZWZlciB0byBhIENSRUFUSU9OIChiaWxsaW5nX3JlYXNvbiA9PT0gc3Vic2NyaXB0aW9uX2NyZWF0ZSlcbiAgICogICAgQSkgVEhFIE9CSkVDVCBPRiBUSEUgRVZFTlQgaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCBBTkQgVEhFIERBVEEgZXZlbnQudHlwZSA9PT0gaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCAgQVJFIFNBVkVEIEFTIFwiU1VCU0NSSVBUSU9OLVBBWU1FTlRcIlxuICAgKiAgICAgICBPTiBPVVIgREIgKE5PVEU6IFwiUFJPSkVDVCBJRFwiIEFORCBcIlVTRVIgSURcIiBBUkUgU0FWRUQgQVMgbnVsbCBTSU5DRSBJUyBOT1QgUE9TU0lCTEUgVE8gUkVUUklFVkUgVEhFIFZBTFVFUykgXG4gICAqIFxuICAgKi9cbiAgaWYgKGV2ZW50LnR5cGUgPT09ICdpbnZvaWNlLnBheW1lbnRfc3VjY2VlZGVkJykge1xuXG4gICAgd2luc3Rvbi5pbmZvKCcgISEhISEhISEgSEkgISEhISEhISEgaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCcpO1xuICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBpbnZvaWNlLnBheW1lbnRfc3VjY2VlZGVkIC0gQklMTElORyBSRUFTT04gJywgZXZlbnQuZGF0YS5vYmplY3QuYmlsbGluZ19yZWFzb24pO1xuXG4gICAgdmFyIGxpbmVzTnVtID0gZXZlbnQuZGF0YS5vYmplY3QubGluZXMudG90YWxfY291bnRcbiAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCAtIGxpbmVzTnVtOiAnLCBsaW5lc051bSk7XG5cbiAgICB2YXIgaW5kZXggPSBsaW5lc051bSAtIDE7XG4gICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGludm9pY2UucGF5bWVudF9zdWNjZWVkZWQgLSBpbmRleDogJywgaW5kZXgpO1xuXG4gICAgLyoqIDFBICovIC8vIFRISVMgV09SS1NcbiAgICB2YXIgc3Vic2NyaXB0aW9uU3RhcnREYXRlID0gbW9tZW50LnVuaXgoZXZlbnQuZGF0YS5vYmplY3QubGluZXMuZGF0YVtpbmRleF0ucGVyaW9kLnN0YXJ0KS5mb3JtYXQoJ1lZWVktTU0tRERUSEg6bW06c3MuU1NTJylcbiAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCAtIHN0YXJ0OiAnLCBzdWJzY3JpcHRpb25TdGFydERhdGUpO1xuXG4gICAgLyoqIDFCICovIC8vIFRISVMgV09SS1NcbiAgICB2YXIgc3Vic2NyaXB0aW9uRW5kRGF0ZSA9IG1vbWVudC51bml4KGV2ZW50LmRhdGEub2JqZWN0LmxpbmVzLmRhdGFbaW5kZXhdLnBlcmlvZC5lbmQpLmZvcm1hdCgnWVlZWS1NTS1ERFRISDptbTpzcy5TU1MnKVxuICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBpbnZvaWNlLnBheW1lbnRfc3VjY2VlZGVkIC0gZW5kOiAnLCBzdWJzY3JpcHRpb25FbmREYXRlKTtcblxuICAgIHZhciBzdWJzY3JpcHRpb25JZCA9IGV2ZW50LmRhdGEub2JqZWN0LnN1YnNjcmlwdGlvbjtcbiAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCAtIHN1YnNjcmlwdGlvbiBJRDogJywgc3Vic2NyaXB0aW9uSWQpO1xuXG4gICAgaWYgKHN1YnNjcmlwdGlvbklkID09IG51bGwpIHtcbiAgICAgIHN1YnNjcmlwdGlvbklkID0gZXZlbnQuZGF0YS5vYmplY3QubGluZXMuZGF0YVswXS5zdWJzY3JpcHRpb247XG4gICAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCAtIHN1YnNjcmlwdGlvbiBJRDogJywgc3Vic2NyaXB0aW9uSWQpO1xuICAgIH1cblxuICAgIGlmIChldmVudC5kYXRhLm9iamVjdC5iaWxsaW5nX3JlYXNvbiAhPT0gJ3N1YnNjcmlwdGlvbl9jcmVhdGUnKSB7XG5cblxuICAgICAgLy8gVE8gVEVTVCBUSEUgUkVORVdBTCBVTkNPTU1FTlQgU0VUIFRJTUVPVVRcbiAgICAgIC8vIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgLyoqIDJBICovXG4gICAgICBnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudChzdWJzY3JpcHRpb25JZCkudGhlbihmdW5jdGlvbiAoc3Vic3B0bl9wYXltZW50KSB7XG4gICAgICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudCBzdWJzcHRuX3BheW1lbnQ6ICcsIHN1YnNwdG5fcGF5bWVudCk7XG4gICAgICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudCBzdWJzcHRuX3BheW1lbnQgdHlwZW9mIHN1YnNwdG5fcGF5bWVudDogJywgdHlwZW9mIHN1YnNwdG5fcGF5bWVudCk7XG4gICAgICAgIGlmIChzdWJzcHRuX3BheW1lbnQpIHtcblxuICAgICAgICAgIHZhciBwcm9qZWN0SWQgPSBzdWJzcHRuX3BheW1lbnQucHJvamVjdF9pZFxuICAgICAgICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudCBzdWJzcHRuX3BheW1lbnQgPiBwcm9qZWN0X2lkOiAnLCBwcm9qZWN0SWQpO1xuXG4gICAgICAgICAgUHJvamVjdC5maW5kT25lKHsgX2lkOiBwcm9qZWN0SWQgfSwgZnVuY3Rpb24gKGVyciwgcHJvamVjdCkge1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQgIGZpbmQgUHJvamVjdCAnLCBlcnIpO1xuICAgICAgICAgICAgICByZXR1cm4gKGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocHJvamVjdCkge1xuICAgICAgICAgICAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQgIHByb2plY3QgJywgcHJvamVjdCk7XG4gICAgICAgICAgICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudCAgcHJvamVjdCA+IHByb2ZpbGUnLCBwcm9qZWN0LnByb2ZpbGUpO1xuXG4gICAgICAgICAgICAgIHZhciBzZWF0c19udW0gPSBwcm9qZWN0LnByb2ZpbGUuYWdlbnRzO1xuICAgICAgICAgICAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQgIHByb2plY3QgPiBwcm9maWxlID4gYWdlbnRzJywgc2VhdHNfbnVtKTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIHZhciBwbGFuX25hbWUgPSBwcm9qZWN0LnByb2ZpbGUubmFtZTtcbiAgICAgICAgICAgICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGdldFN1YkJ5SWRBbmRDaGVja291dFNlc3Npb25Db21wbGV0ZWRFdm50ICBwcm9qZWN0ID4gcHJvZmlsZSA+IGFnZW50cyB0eXBlb2YnLCB0eXBlb2Ygc2VhdHNfbnVtKTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIHZhciB1c2VySWQgPSBzdWJzcHRuX3BheW1lbnQudXNlcl9pZFxuICAgICAgICAgICAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQgIHByb2plY3QgPiBwcm9maWxlID4gbmFtZScsIHBsYW5fbmFtZSk7XG5cbiAgICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgICAgLy8gIEJPRFkgXG4gICAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICAgIHZhciBib2R5ID0ge1xuICAgICAgICAgICAgICAgIHByb2ZpbGU6IHtcbiAgICAgICAgICAgICAgICAgIG5hbWU6IHBsYW5fbmFtZSxcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICdwYXltZW50JyxcbiAgICAgICAgICAgICAgICAgIHN1YlN0YXJ0OiBzdWJzY3JpcHRpb25TdGFydERhdGUsXG4gICAgICAgICAgICAgICAgICBzdWJFbmQ6IHN1YnNjcmlwdGlvbkVuZERhdGUsXG4gICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25JZDogc3Vic2NyaXB0aW9uSWQsXG4gICAgICAgICAgICAgICAgICBsYXN0X3N0cmlwZV9ldmVudDogZXZlbnQudHlwZSxcbiAgICAgICAgICAgICAgICAgIGFnZW50czogc2VhdHNfbnVtXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgLyoqIDJCICovXG4gICAgICAgICAgICAgIHVwZGF0ZVByb2plY3RQcm9maWxlKHByb2plY3RJZCwgYm9keSwgJ2ludm9pY2UucGF5bWVudF9zdWNjZWVkZWQnKTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIC8qKiAyQyAqL1xuICAgICAgICAgICAgICBzYXZlT25EQihzdWJzY3JpcHRpb25JZCwgcHJvamVjdElkLCBldmVudCwgdXNlcklkLCBldmVudC50eXBlLCBwbGFuX25hbWUsIHNlYXRzX251bSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIHdpbnN0b24uZXJyb3IoJyoqKiAqKiogZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQgLSBlcnIgJywgZXJyKTtcbiAgICAgIH0pO1xuICAgICAgLy8gfSwgNTAwMCk7XG4gICAgfVxuXG4gIH1cblxuICAvKipcbiAgICoqISAqKiogSEFORExFIFRIRSBFVkVOVCBjdXN0b21lci5zdWJzY3JpcHRpb24uZGVsZXRlZCAqKipcbiAgICogdGhpcyBldmVudCBvY2N1cnMgd2hlbiBhIHN1YnNjcmlwdGlvbiBpcyBjYW5jZWxsZWRcbiAgICogLSBmcm9tIHRoZSBUSUxFREVTSycgZGFzaGJvYXJkIChieSBjbGlja2luZyBDQU5DRUwgU1VCU0NSSVBUSU9OIHRoYXQgY2FsbCBjYW5jZWxzdWJzY3JpcHRpb24oKSAtIHNlZSBiZWxvdylcbiAgICogLSBmcm9tIHRoZSBTVFJJUEUnIGRhc2hib2FyZFxuICAgKi9cbiAgaWYgKGV2ZW50LnR5cGUgPT09ICdjdXN0b21lci5zdWJzY3JpcHRpb24uZGVsZXRlZCcpIHtcbiAgICB3aW5zdG9uLmluZm8oJyAhISEhISEhISBISSAhISEhISEhISEhISBjdXN0b21lci5zdWJzY3JpcHRpb24uZGVsZXRlZCcpO1xuICAgIHdpbnN0b24uaW5mbygnY3VzdG9tZXIuc3Vic2NyaXB0aW9uLmRlbGV0ZWQgZXZlbnQgJywgZXZlbnQpO1xuICAgIHZhciBzdWJzY3JpcHRpb25JZCA9IGV2ZW50LmRhdGEub2JqZWN0LmlkXG4gICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIHN1YnNjcmlwdGlvbiBJRCAnLCBzdWJzY3JpcHRpb25JZCk7XG5cbiAgICBnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudChzdWJzY3JpcHRpb25JZCkudGhlbihmdW5jdGlvbiAoc3Vic2NyaXB0aW9uUGF5bWVudCkge1xuICAgICAgLy8gU3Vic2NyaXB0aW9uUGF5bWVudC5maW5kKHsgc3Vic2NyaXB0aW9uX2lkOiBzdWJzY3JpcHRpb25JZCwgb2JqZWN0X3R5cGU6IFwic3Vic2NyaXB0aW9uXCIgfSwgZnVuY3Rpb24gKGVyciwgc3Vic2NyaXB0aW9uUGF5bWVudCkge1xuXG4gICAgICAvLyBpZiAoZXJyKSB7XG4gICAgICAvLyAgIHdpbnN0b24uaW5mbygnRXJyb3IgZ2V0dGluZyB0aGUgc3Vic2NyaXB0aW9uUGF5bWVudCAnLCBlcnIpO1xuICAgICAgLy8gICByZXR1cm4gZXJyO1xuICAgICAgLy8gfVxuICAgICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIMK7wrvCuyDCu8K7wrsgY3VzdG9tZXIuc3Vic2NyaXB0aW9uLmRlbGV0ZWQgc3Vic2NyaXB0aW9uUGF5bWVudCAnLCBzdWJzY3JpcHRpb25QYXltZW50KTtcbiAgICAgIGlmIChzdWJzY3JpcHRpb25QYXltZW50KSB7IFxuICAgICAgICB2YXIgcHJvamVjdElkID0gc3Vic2NyaXB0aW9uUGF5bWVudC5wcm9qZWN0X2lkOyBcbiAgICAgICAgd2luc3Rvbi5pbmZvKCdjdXN0b21lci5zdWJzY3JpcHRpb24uZGVsZXRlZCBzdWJzY3JpcHRpb25QYXltZW50IHByb2plY3QgaWQ6ICcsIHByb2plY3RJZClcbiAgICAgICAgXG4gICAgICAgIHZhciB1c2VySWQgPSBzdWJzY3JpcHRpb25QYXltZW50LnVzZXJfaWQ7XG4gICAgICAgIHdpbnN0b24uaW5mbygnY3VzdG9tZXIuc3Vic2NyaXB0aW9uLmRlbGV0ZWQgc3Vic2NyaXB0aW9uUGF5bWVudCB1c2VyIGlkOiAnLCB1c2VySWQpXG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICohICoqKiBCT0RZICoqKlxuICAgICAgICovXG4gICAgICB2YXIgYm9keSA9IHtcbiAgICAgICAgcHJvZmlsZToge1xuICAgICAgICAgIHN1YnNjcmlwdGlvbklkOiBzdWJzY3JpcHRpb25JZCxcbiAgICAgICAgICBuYW1lOiAnU2FuZGJveCcsXG4gICAgICAgICAgdHlwZTogJ2ZyZWUnLFxuICAgICAgICAgIGFnZW50czogMSxcbiAgICAgICAgICBsYXN0X3N0cmlwZV9ldmVudDogZXZlbnQudHlwZVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIHVwZGF0ZVByb2plY3RQcm9maWxlKHByb2plY3RJZCwgYm9keSwgJ3N1YnNjcmlwdGlvbi5kZWxldGVkJyk7XG4gICAgICBzYXZlT25EQihzdWJzY3JpcHRpb25JZCwgcHJvamVjdElkLCBldmVudC5kYXRhLm9iamVjdCwgdXNlcklkLCBldmVudC50eXBlLCBwbGFuX25hbWUsIDEpO1xuXG4gICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgd2luc3Rvbi5lcnJvcignKioqICoqKiBjdXN0b21lci5zdWJzY3JpcHRpb24uZGVsZXRlZCAnLCBlcnIpO1xuICAgIH0pO1xuXG4gIH1cbiAgLy8gUmV0dXJuIGEgcmVzcG9uc2UgdG8gYWNrbm93bGVkZ2UgcmVjZWlwdCBvZiB0aGUgZXZlbnRcbiAgcmVzcG9uc2UuanNvbih7IHJlY2VpdmVkOiB0cnVlIH0pO1xufSk7XG5cblxuZnVuY3Rpb24gZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQoc3Vic2NyaXB0aW9uaWQpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICBTdWJzY3JpcHRpb25QYXltZW50LmZpbmRPbmUoeyBzdWJzY3JpcHRpb25faWQ6IHN1YnNjcmlwdGlvbmlkLCBzdHJpcGVfZXZlbnQ6IFwiY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWRcIiB9LCBmdW5jdGlvbiAoZXJyLCBzdWJzY3JpcHRpb25QYXltZW50KSB7XG4gICAgICBpZiAoZXJyKSByZWplY3QoZXJyKTtcblxuICAgICAgdmFyIHN1YnNjcmlwdGlvbl9wYXltZW50ID0gc3Vic2NyaXB0aW9uUGF5bWVudDtcbiAgICAgIHJlc29sdmUoc3Vic2NyaXB0aW9uX3BheW1lbnQpO1xuICAgIH0pO1xuICB9KVxufTtcblxuZnVuY3Rpb24gZ2V0U3Vic2NyaXRpb25CeUlkKHN1YnNjcmlwdGlvbmlkKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgY29uc3QgX3N0cmlwZSA9IHJlcXVpcmUoXCJzdHJpcGVcIikoYXBpU2VjcmV0S2V5KTtcbiAgICBfc3RyaXBlLnN1YnNjcmlwdGlvbnMucmV0cmlldmUoc3Vic2NyaXB0aW9uaWQsIGZ1bmN0aW9uIChlcnIsIHN1YnNjcmlwdGlvbikge1xuICAgICAgaWYgKGVycikgcmVqZWN0KGVycik7XG5cbiAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBzdWJzY3JpcHRpb247XG4gICAgICByZXNvbHZlKHN1YnNjcmlwdGlvbik7XG4gICAgfSk7XG4gIH0pXG59O1xuXG4vLyBTRUUgVXBkYXRpbmcgbmVzdGVkIG9iamVjdCBpbiBtb25nb29zZSBcbi8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzIzODMyOTIxL3VwZGF0aW5nLW5lc3RlZC1vYmplY3QtaW4tbW9uZ29vc2VcbmZ1bmN0aW9uIHVwZGF0ZVByb2plY3RQcm9maWxlKHByb2plY3RfaWQsIGJvZHksIGNhbGxlZEJ5KSB7XG4gIFByb2plY3QuZmluZEJ5SWRBbmRVcGRhdGUocHJvamVjdF9pZCwgYm9keSwgeyBuZXc6IHRydWUsIHVwc2VydDogdHJ1ZSB9LCBmdW5jdGlvbiAoZXJyLCB1cGRhdGVkUHJvamVjdCkge1xuICAgIGlmIChlcnIpIHtcbiAgICAgIHdpbnN0b24uZXJyb3IoJ3VwZGF0ZVByb2plY3RQcm9maWxlIEVycm9yICcsIGVycik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdpbnN0b24uZGVidWcodXBkYXRlZFByb2plY3QpXG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gc2F2ZU9uREIoc3Vic2NyaXB0aW9uaWQsIHByb2plY3RpZCwgb2JqLCB1c2VyaWQsIHN0cmlwZV9ldmVudCwgcGxhbl9uYW1lLCBzZWF0c19udW0pIHtcbiAgd2luc3Rvbi5pbmZvKCdzYXZlT25EQiBwbGFuX25hbWUnLCBwbGFuX25hbWUpXG4gIHdpbnN0b24uaW5mbygnc2F2ZU9uREIgc2VhdHNfbnVtJywgc2VhdHNfbnVtKVxuXG4gIHZhciBuZXdQYXltZW50U3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvblBheW1lbnQoe1xuICAgIF9pZDogbmV3IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKCksXG4gICAgc3Vic2NyaXB0aW9uX2lkOiBzdWJzY3JpcHRpb25pZCxcbiAgICBwcm9qZWN0X2lkOiBwcm9qZWN0aWQsXG4gICAgdXNlcl9pZDogdXNlcmlkLFxuICAgIHN0cmlwZV9ldmVudDogc3RyaXBlX2V2ZW50LFxuICAgIHBsYW5fbmFtZTogcGxhbl9uYW1lLFxuICAgIGFnZW50czogc2VhdHNfbnVtLFxuICAgIG9iamVjdDogb2JqXG4gIH0pO1xuXG4gIG5ld1BheW1lbnRTdWJzY3JpcHRpb24uc2F2ZShmdW5jdGlvbiAoZXJyLCBzYXZlZFN1YnNjcmlwdGlvblBheW1lbnQpIHtcbiAgICBpZiAoZXJyKSB7XG4gICAgICB3aW5zdG9uLmVycm9yKCctLS0gPiBFUlJPUiAnLCBlcnIpXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoeyBzdWNjZXNzOiBmYWxzZSwgbXNnOiAnRXJyb3Igc2F2aW5nIG9iamVjdC4nIH0pO1xuICAgIH1cbiAgICB3aW5zdG9uLmluZm8oJ3NhdmVkU3Vic2NyaXB0aW9uUGF5bWVudCAnLCBzYXZlZFN1YnNjcmlwdGlvblBheW1lbnQpO1xuICB9KTtcbn1cblxucm91dGVyLnB1dCgnL2NhbmNlbHN1YnNjcmlwdGlvbicsIFtwYXNzcG9ydC5hdXRoZW50aWNhdGUoWydiYXNpYycsICdqd3QnXSwgeyBzZXNzaW9uOiBmYWxzZSB9KSwgdmFsaWR0b2tlbl0sIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuICB2YXIgcHJvamVjdGlkID0gcmVxLmJvZHkucHJvamVjdGlkXG4gIHZhciB1c2VyaWQgPSByZXEuYm9keS51c2VyaWRcbiAgd2luc3Rvbi5pbmZvKCfCu8K7wrsgwrvCu8K7IGNhbmNlbHN1YnNjcmlwdGlvbiBwcm9qZWN0aWQnLCBwcm9qZWN0aWQpO1xuICB3aW5zdG9uLmluZm8oJ8K7wrvCuyDCu8K7wrsgY2FuY2Vsc3Vic2NyaXB0aW9uIHVzZXJpZCcsIHVzZXJpZCk7XG5cbiAgUHJvamVjdC5maW5kT25lKHsgX2lkOiBwcm9qZWN0aWQgfSwgZnVuY3Rpb24gKGVyciwgcHJvamVjdCkge1xuICAgIGlmIChlcnIpIHtcbiAgICAgIHdpbnN0b24uZXJyb3IoJy0tID4gY2FuY2Vsc3Vic2NyaXB0aW9uIEVycm9yIGdldHRpbmcgcHJvamVjdCAnLCBlcnIpXG4gICAgICByZXR1cm4gKGVycik7XG4gICAgfVxuICAgIGlmIChwcm9qZWN0KSB7XG4gICAgICB3aW5zdG9uLmluZm8oJy0tID4gY2FuY2Vsc3Vic2NyaXB0aW9uICBwcm9qZWN0ICcsIHByb2plY3QpO1xuXG4gICAgICB2YXIgc3Vic2NyaXB0aW9uaWQgPSBwcm9qZWN0LnByb2ZpbGUuc3Vic2NyaXB0aW9uSWQ7XG5cbiAgICAgIGNvbnN0IHN0cmlwZSA9IHJlcXVpcmUoXCJzdHJpcGVcIikoYXBpU2VjcmV0S2V5KTtcblxuICAgICAgc3RyaXBlLnN1YnNjcmlwdGlvbnMuZGVsKHN1YnNjcmlwdGlvbmlkLCBmdW5jdGlvbiAoZXJyLCBjb25maXJtYXRpb24pIHtcbiAgICAgICAgLy8gYXN5bmNocm9ub3VzbHkgY2FsbGVkXG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICB3aW5zdG9uLmVycm9yKCctLSA+IGNhbmNlbHN1YnNjcmlwdGlvbiAgZXJyICcsIGVycik7XG4gICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgc3VjY2VzczogZmFsc2UsIG1zZzogZXJyIH0pXG4gICAgICAgIH1cbiAgICAgICAgd2luc3Rvbi5pbmZvKCctLSA+IGNhbmNlbHN1YnNjcmlwdGlvbiBjb25maXJtYXRpb24gJywgY29uZmlybWF0aW9uKVxuICAgICAgICByZXMuanNvbihjb25maXJtYXRpb24pO1xuICAgICAgfSk7XG4gICAgfVxuICB9KVxufSk7XG5cbnJvdXRlci5wdXQoJy91cGRhdGVzdWJzY3JpcHRpb24nLCBbcGFzc3BvcnQuYXV0aGVudGljYXRlKFsnYmFzaWMnLCAnand0J10sIHsgc2Vzc2lvbjogZmFsc2UgfSksIHZhbGlkdG9rZW5dLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcblxuICB2YXIgcHJvamVjdGlkID0gcmVxLmJvZHkucHJvamVjdGlkXG4gIHZhciB1c2VyaWQgPSByZXEuYm9keS51c2VyaWRcbiAgdmFyIHByaWNlID0gcmVxLmJvZHkucHJpY2VcbiAgd2luc3Rvbi5pbmZvKCfCu8K7wrsgwrvCu8K7IHVwZGF0ZXN1YnNjcmlwdGlvbiBwcm9qZWN0aWQnLCBwcm9qZWN0aWQpO1xuICB3aW5zdG9uLmluZm8oJ8K7wrvCuyDCu8K7wrsgdXBkYXRlc3Vic2NyaXB0aW9uIHVzZXJpZCcsIHVzZXJpZCk7XG4gIHdpbnN0b24uaW5mbygnwrvCu8K7IMK7wrvCuyB1cGRhdGVzdWJzY3JpcHRpb24gcHJpY2UnLCBwcmljZSk7XG4gIGNvbnN0IHN0cmlwZSA9IHJlcXVpcmUoXCJzdHJpcGVcIikoYXBpU2VjcmV0S2V5KTtcblxuICBQcm9qZWN0LmZpbmRPbmUoeyBfaWQ6IHByb2plY3RpZCB9LCBmdW5jdGlvbiAoZXJyLCBwcm9qZWN0KSB7XG4gICAgaWYgKGVycikge1xuICAgICAgd2luc3Rvbi5lcnJvcignLS0gPiB1cGRhdGVzdWJzY3JpcHRpb24gRXJyb3IgZ2V0dGluZyBwcm9qZWN0ICcsIGVycilcbiAgICAgIHJldHVybiAoZXJyKTtcbiAgICB9XG4gICAgaWYgKHByb2plY3QpIHtcbiAgICAgIHdpbnN0b24uaW5mbygnLS0gPiB1cGRhdGVzdWJzY3JpcHRpb24gIHByb2plY3QgJywgcHJvamVjdCk7XG5cbiAgICAgIHZhciBzdWJzY3JpcHRpb25pZCA9IHByb2plY3QucHJvZmlsZS5zdWJzY3JpcHRpb25JZDtcblxuICAgICAgLy8gc3Vic2NyaXB0aW9uaWRcbiAgICAgIHN0cmlwZS5zdWJzY3JpcHRpb25zLnVwZGF0ZShcbiAgICAgICAgc3Vic2NyaXB0aW9uaWQsXG4gICAgICAgIC8vIHsgdHJpYWxfZW5kOiAxNTY4MjEwNjU1IH0sXG4gICAgICAgIC8vIGZ1bmN0aW9uIChlcnIsIHN1YnNjcmlwdGlvbikge1xuICAgICAgICAvLyAgIC8vIGFzeW5jaHJvbm91c2x5IGNhbGxlZFxuICAgICAgICAvLyAgIGlmIChlcnIpIHtcbiAgICAgICAgLy8gICAgIHdpbnN0b24uZXJyb3IoJ3VwZGF0ZXN1YnNjcmlwdGlvbiBzdWJzY3JpcHRpb24gZXJyICcsIGVycilcbiAgICAgICAgLy8gICAgIHJldHVyblxuICAgICAgICAvLyAgIH1cbiAgICAgICAgLy8gICB3aW5zdG9uLmluZm8oJ3VwZGF0ZXN1YnNjcmlwdGlvbiBzdWJzY3JpcHRpb24gJywgc3Vic2NyaXB0aW9uKVxuICAgICAgICAvLyB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIHN0cmlwZS5zdWJzY3JpcHRpb25zLnJldHJpZXZlKHN1YnNjcmlwdGlvbmlkLCBmdW5jdGlvbiAoZXJyLCBzdWJzY3JpcHRpb24pIHtcbiAgICAvLyAgIC8vIGFzeW5jaHJvbm91c2x5IGNhbGxlZFxuICAgIC8vICAgaWYgKGVycikge1xuICAgIC8vICAgICB3aW5zdG9uLmluZm8oJ3JldHJpZXZlIHVwZGF0ZWQgc3Vic2NyaXB0aW9uIGVyciAnLCBlcnIpXG4gICAgLy8gICB9IGVsc2Uge1xuICAgIC8vICAgICB3aW5zdG9uLmluZm8oJ8K7wrvCu8K7wrvCu8K7wrvCuyBncmV0cmlldmUgdXBkYXRlZCBzdWJzY3JpcHRpb246ICcsIHN1YnNjcmlwdGlvbik7XG5cbiAgICAvLyAgIH1cbiAgICAvLyB9KVxuICB9KVxuXG59KVxuXG5yb3V0ZXIuZ2V0KCcvOnN1YnNjcmlwdGlvbmlkJywgW3Bhc3Nwb3J0LmF1dGhlbnRpY2F0ZShbJ2Jhc2ljJywgJ2p3dCddLCB7IHNlc3Npb246IGZhbHNlIH0pLCB2YWxpZHRva2VuXSwgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG5cbiAgU3Vic2NyaXB0aW9uUGF5bWVudC5maW5kKHsgc3Vic2NyaXB0aW9uX2lkOiByZXEucGFyYW1zLnN1YnNjcmlwdGlvbmlkIH0pLnNvcnQoeyAnb2JqZWN0LmNyZWF0ZWQnOiBcImFzY1wiIH0pLmV4ZWMoZnVuY3Rpb24gKGVyciwgc3Vic2NyaXB0aW9uUGF5bWVudHMpIHtcbiAgICBpZiAoZXJyKSB7XG4gICAgICB3aW5zdG9uLmVycm9yKCctLSA+IEdFVCBTVUJTQ1JJUFRJT04gUEFZTUVOVFMgRVJST1J0ICcsIHByb2plY3QpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgc3VjY2VzczogZmFsc2UsIG1zZzogZXJyIH0pXG4gICAgfVxuICAgIHJlcy5qc29uKHN1YnNjcmlwdGlvblBheW1lbnRzKTtcbiAgfSk7XG5cbn0pO1xuXG4vLyAgUkVUUklFVkUgVEhFIENVUlJFTlQgU1VCU0NSSVBUSU9OIEZST00gU1RSSVBFXG5yb3V0ZXIuZ2V0KCcvc3RyaXBlc3Vicy86c3Vic2NyaXB0aW9uaWQnLCBbcGFzc3BvcnQuYXV0aGVudGljYXRlKFsnYmFzaWMnLCAnand0J10sIHsgc2Vzc2lvbjogZmFsc2UgfSksIHZhbGlkdG9rZW5dLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcblxuICB3aW5zdG9uLmluZm8oJy0tID4gc3Vic2NyaXB0aW9uIGdldCBieSBpZCBmcmVxLnBhcmFtcy5zdWJzY3JpcHRpb25pZCAnLCByZXEucGFyYW1zLnN1YnNjcmlwdGlvbmlkKTtcbiAgdmFyIHN0cmlwZSA9IHJlcXVpcmUoJ3N0cmlwZScpKGFwaVNlY3JldEtleSk7XG5cbiAgc3RyaXBlLnN1YnNjcmlwdGlvbnMucmV0cmlldmUoXG4gICAgcmVxLnBhcmFtcy5zdWJzY3JpcHRpb25pZCxcbiAgICBmdW5jdGlvbiAoZXJyLCBzdWJzY3JpcHRpb24pIHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgd2luc3Rvbi5lcnJvcignLS0gPiBzdWJzY3JpcHRpb24gZ2V0IGJ5IGlkIGZyb20gc3RyaXBlICBlcnIgJywgZXJyKTtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgc3VjY2VzczogZmFsc2UsIG1zZzogZXJyIH0pXG4gICAgICB9XG4gICAgICB3aW5zdG9uLmluZm8oJy0tID4gc3Vic2NyaXB0aW9uIGdldCBieSBpZCBmcm9tIHN0cmlwZSAnLCBzdWJzY3JpcHRpb24pXG4gICAgICByZXMuanNvbihzdWJzY3JpcHRpb24pO1xuICAgIH1cbiAgKTtcbn0pO1xuXG4vLyAgUkVUUklFVkUgVEhFIENIRUNLT1VUIFNFU1NJT05cbnJvdXRlci5nZXQoJy9jaGVja291dFNlc3Npb24vOnNlc3Npb25pZCcsIFtwYXNzcG9ydC5hdXRoZW50aWNhdGUoWydiYXNpYycsICdqd3QnXSwgeyBzZXNzaW9uOiBmYWxzZSB9KSwgdmFsaWR0b2tlbl0sIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuXG4gIHdpbnN0b24uaW5mbygnLS0gPiBjaGVja291dFNlc3Npb24gcGFyYW1zLnNlc3Npb25pZCAnLCByZXEucGFyYW1zLnNlc3Npb25pZCk7XG4gIHZhciBzdHJpcGUgPSByZXF1aXJlKCdzdHJpcGUnKShhcGlTZWNyZXRLZXkpO1xuXG4gIHN0cmlwZS5jaGVja291dC5zZXNzaW9ucy5yZXRyaWV2ZShcbiAgICByZXEucGFyYW1zLnNlc3Npb25pZCxcbiAgICBmdW5jdGlvbiAoZXJyLCBzZXNzaW9uKSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHdpbnN0b24uaW5mbygnLS0gPiBjaGVja291dFNlc3Npb24gZ2V0IGJ5IGlkIGZyb20gc3RyaXBlICBlcnIgJywgZXJyKTtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgc3VjY2VzczogZmFsc2UsIG1zZzogZXJyIH0pXG4gICAgICB9XG4gICAgICB3aW5zdG9uLmluZm8oJy0tID4gY2hlY2tvdXRTZXNzaW9uIGdldCBieSBpZCBmcm9tIHN0cmlwZSAnLCBzZXNzaW9uKVxuICAgICAgcmVzLmpzb24oc2Vzc2lvbik7XG4gICAgfVxuICApO1xufSk7XG5cbi8vbmV3IGNvZGVcbnJvdXRlci5nZXQoJy9jdXN0b21lci86cHJvamVjdGlkJywgW3Bhc3Nwb3J0LmF1dGhlbnRpY2F0ZShbJ2Jhc2ljJywgJ2p3dCddLCB7IHNlc3Npb246IGZhbHNlIH0pLCB2YWxpZHRva2VuXSwgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG4gIHdpbnN0b24uZGVidWcoJ8K7wrvCuyDCu8K7wrsgZ2V0IGN1c3RvbWVyIGZyb20gZGIgJywgcmVxLnBhcmFtcylcbiAgdmFyIHByb2plY3RpZCA9IHJlcS5wYXJhbXMucHJvamVjdGlkXG5cbiAgd2luc3Rvbi5kZWJ1ZygnwrvCu8K7IMK7wrvCuyBnZXQgY3VzdG9tZXIgZnJvbSBkYiAtIHByb2plY3RpZCcsIHByb2plY3RpZCk7XG5cbiAgU3Vic2NyaXB0aW9uUGF5bWVudC5maW5kKHsgcHJvamVjdF9pZDogcHJvamVjdGlkLCBzdHJpcGVfZXZlbnQ6IFwiY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWRcIiB9LCBhc3luYyBmdW5jdGlvbiAoZXJyLCBzdWJzY3JpcHRpb24pIHtcbiAgICBpZiAoZXJyKSB7XG4gICAgICB3aW5zdG9uLmRlYnVnKCctLSA+IGdldCBjdXN0b21lciBmcm9tIGRiIC0gRXJyb3IgJywgZXJyKVxuICAgICAgcmV0dXJuIChlcnIpO1xuICAgIH1cbiAgICBpZiAoc3Vic2NyaXB0aW9uKSB7XG5cbiAgICAgIHN1YnNjcmlwdGlvblswXS5vYmplY3QuY3VzdG9tZXJcbiAgICAgIHdpbnN0b24uZGVidWcoJy0tID4gZ2V0IGN1c3RvbWVyIGZyb20gZGIgLSBzdWJzY3JpcHRpb24gPiBjdXN0b21lciBpZCAnLCBzdWJzY3JpcHRpb25bMF0ub2JqZWN0LmN1c3RvbWVyKTtcbiAgICAgIGNvbnN0IGN1c3RvbWVyaWQgPSBzdWJzY3JpcHRpb25bMF0ub2JqZWN0LmN1c3RvbWVyXG4gICAgICBjb25zdCBzdHJpcGUgPSByZXF1aXJlKFwic3RyaXBlXCIpKGFwaVNlY3JldEtleSk7XG5cbiAgICAgIGNvbnN0IGN1c3RvbWVyID0gYXdhaXQgc3RyaXBlLmN1c3RvbWVycy5yZXRyaWV2ZShcbiAgICAgICAgY3VzdG9tZXJpZFxuICAgICAgKTtcbiAgICAgIHdpbnN0b24uZGVidWcoJy0tID4gZ2V0IGN1c3RvbWVyIGZyb20gZGIgPiBjdXN0b21lciBmcm9tIHN0cmlwZSBBUEkgJywgY3VzdG9tZXIpXG5cbiAgICAgIGNvbnN0IHBheW1lbnRNZXRob2RzID0gYXdhaXQgc3RyaXBlLnBheW1lbnRNZXRob2RzLmxpc3Qoe1xuICAgICAgICBjdXN0b21lcjogY3VzdG9tZXJpZCxcbiAgICAgICAgdHlwZTogJ2NhcmQnLFxuICAgICAgfSk7XG4gICAgICBjdXN0b21lclsncGF5bWVudE1ldGhvZHMnXSA9IHBheW1lbnRNZXRob2RzO1xuICAgICAgd2luc3Rvbi5kZWJ1ZygnLS0gPiBnZXQgY3VzdG9tZXIgZnJvbSBkYiA+IGN1c3RvbWVyICsgcGF5bWVudE1ldGhvZHMgJywgc3Vic2NyaXB0aW9uKVxuICAgICAgcmVzLmpzb24oY3VzdG9tZXIpXG4gICAgfVxuICB9KVxufSk7XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIFVwZGF0ZWQgY3VzdG9tZXJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbnJvdXRlci5wb3N0KCcvY3VzdG9tZXJzLzpjdXN0b21lcmlkJywgW3Bhc3Nwb3J0LmF1dGhlbnRpY2F0ZShbJ2Jhc2ljJywgJ2p3dCddLCB7IHNlc3Npb246IGZhbHNlIH0pLCB2YWxpZHRva2VuXSwgYXN5bmMgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG4gIHZhciBjdXN0b21lcmlkID0gcmVxLnBhcmFtcy5jdXN0b21lcmlkO1xuICB3aW5zdG9uLmRlYnVnKCfCu8K7wrsgwrvCu8K7ICB1cGRhdGUgY3VzdG9tZXIgLSBjdXN0b21lcmlkIGZyb20gcGFyYW1zICcsIGN1c3RvbWVyaWQpO1xuICB3aW5zdG9uLmRlYnVnKCfCu8K7wrsgwrvCu8K7ICB1cGRhdGUgY3VzdG9tZXIgLSBjYyBmcm9tIGJvZHkgJywgcmVxLmJvZHkpO1xuXG4gIGNvbnN0IHN0cmlwZSA9IHJlcXVpcmUoXCJzdHJpcGVcIikoYXBpU2VjcmV0S2V5KTtcblxuICBsZXQgcGF5bWVudE1ldGhvZDtcbiAgdHJ5IHtcbiAgICBwYXltZW50TWV0aG9kID0gYXdhaXQgc3RyaXBlLnBheW1lbnRNZXRob2RzLmNyZWF0ZSh7XG4gICAgICB0eXBlOiAnY2FyZCcsXG4gICAgICBjYXJkOiB7XG4gICAgICAgIG51bWJlcjogcmVxLmJvZHkuY3JlZGl0X2NhcmRfbnVtLFxuICAgICAgICBleHBfbW9udGg6IHJlcS5ib2R5LmV4cGlyYXRpb25fZGF0ZV9tb250aCxcbiAgICAgICAgZXhwX3llYXI6IHJlcS5ib2R5LmV4cGlyYXRpb25fZGF0ZV95ZWFyLFxuICAgICAgICBjdmM6IHJlcS5ib2R5LmNyZWRpdF9jYXJkX2N2YyxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB3aW5zdG9uLmVycm9yKCfCu8K7wrsgwrvCu8K7ICBwYXltZW50TWV0aG9kIGNyZWF0ZSAgZXJyb3IgJywgZSlcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDIpLnNlbmQoeyBzdWNjZXNzOiBmYWxzZSwgbXNnOiBlIH0pXG5cbiAgfVxuICB3aW5zdG9uLmRlYnVnKCfCu8K7wrsgwrvCu8K7ICBwYXltZW50TWV0aG9kJywgcGF5bWVudE1ldGhvZClcblxuICB0cnkge1xuICAgIGNvbnN0IF9wYXltZW50TWV0aG9kID0gYXdhaXQgc3RyaXBlLnBheW1lbnRNZXRob2RzLmF0dGFjaChcbiAgICAgIHBheW1lbnRNZXRob2QuaWQsXG4gICAgICB7IGN1c3RvbWVyOiBjdXN0b21lcmlkIH1cbiAgICApO1xuXG4gICAgd2luc3Rvbi5kZWJ1ZygnwrvCu8K7IMK7wrvCuyAgcGF5bWVudE1ldGhvZCBhdHRhY2hlZCAnLCBfcGF5bWVudE1ldGhvZClcbiAgfSBjYXRjaCAoZSkge1xuICAgIHdpbnN0b24uZXJyb3IoJ8K7wrvCuyDCu8K7wrsgIHBheW1lbnRNZXRob2QgYXR0YWNoZWQgIGVycm9yICcsIGUpXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAxKS5zZW5kKHsgc3VjY2VzczogZmFsc2UsIG1zZzogZSB9KVxuICB9XG5cbiAgY29uc3QgX2N1c3RvbWVyID0gYXdhaXQgc3RyaXBlLmN1c3RvbWVycy51cGRhdGUoXG4gICAgY3VzdG9tZXJpZCxcbiAgICB7XG4gICAgICBpbnZvaWNlX3NldHRpbmdzOiB7IGRlZmF1bHRfcGF5bWVudF9tZXRob2Q6IHBheW1lbnRNZXRob2QuaWQgfVxuICAgIH0pO1xuICByZXMuanNvbihfY3VzdG9tZXIpO1xufSk7XG5cblxucm91dGVyLmdldCgnL3BheW1lbnRfbWV0aG9kcy86Y3VzdG9tZXJpZCcsIFtwYXNzcG9ydC5hdXRoZW50aWNhdGUoWydiYXNpYycsICdqd3QnXSwgeyBzZXNzaW9uOiBmYWxzZSB9KSwgdmFsaWR0b2tlbl0sIGFzeW5jIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuICB3aW5zdG9uLmluZm8oJ2dldCBQYXltZW50TWV0aG9kcyBsaXN0IHJlcS5wYXJhbXMnLCByZXEucGFyYW1zKVxuICB2YXIgY3VzdG9tZXJfaWQgPSByZXEucGFyYW1zLmN1c3RvbWVyaWQ7XG4gIHdpbnN0b24uZGVidWcoJ2dldCBQYXltZW50TWV0aG9kcyBsaXN0IHJlcS5wYXJhbXMgPiBjdXN0b21lcl9pZCAnLCBjdXN0b21lcl9pZClcbiAgY29uc3Qgc3RyaXBlID0gcmVxdWlyZShcInN0cmlwZVwiKShhcGlTZWNyZXRLZXkpO1xuXG4gIGNvbnN0IGN1c3RvbWVyID0gYXdhaXQgc3RyaXBlLmN1c3RvbWVycy5yZXRyaWV2ZShcbiAgICBjdXN0b21lcl9pZFxuICApO1xuXG4gIGNvbnN0IGRlZmF1bHRfcGF5bWVudF9tZXRob2RfaWQgPSBjdXN0b21lci5pbnZvaWNlX3NldHRpbmdzLmRlZmF1bHRfcGF5bWVudF9tZXRob2RcbiAgbGV0IHBheW1lbnRNZXRob2RzO1xuICB0cnkge1xuICAgIHBheW1lbnRNZXRob2RzID0gYXdhaXQgc3RyaXBlLnBheW1lbnRNZXRob2RzLmxpc3Qoe1xuICAgICAgY3VzdG9tZXI6IGN1c3RvbWVyX2lkLFxuICAgICAgdHlwZTogJ2NhcmQnLFxuICAgIH0pO1xuICAgIHdpbnN0b24uZGVidWcoJ2dldCBQYXltZW50TWV0aG9kcyBsaXN0ID4gcGF5bWVudE1ldGhvZHMgJywgcGF5bWVudE1ldGhvZHMpXG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDEpLnNlbmQoeyBzdWNjZXNzOiBmYWxzZSwgbXNnOiBlIH0pXG4gIH1cblxuICB3aW5zdG9uLmRlYnVnKCdnZXQgUGF5bWVudE1ldGhvZHMgbGlzdCA+IHBheW1lbnRNZXRob2RzID4gZGVmYXVsdF9wYXltZW50X21ldGhvZF9pZCAnLCBkZWZhdWx0X3BheW1lbnRfbWV0aG9kX2lkKVxuICBwYXltZW50TWV0aG9kcy5kYXRhLmZvckVhY2gocGF5bWVudE1ldGhvZCA9PiB7XG4gICAgaWYgKHBheW1lbnRNZXRob2QuaWQgIT09IGRlZmF1bHRfcGF5bWVudF9tZXRob2RfaWQpIHtcbiAgICAgIHdpbnN0b24uZGVidWcoJ2dldCBQYXltZW50TWV0aG9kcyBsaXN0ID4gcGF5bWVudE1ldGhvZHMgPiBwYXltZW50TWV0aG9kcy5kYXRhICcsIHBheW1lbnRNZXRob2QuaWQpXG4gICAgICBkZXRhY2hQYXltZW50RnVuYyhwYXltZW50TWV0aG9kLmlkLCBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgIHdpbnN0b24uaW5mbygnZGV0YWNoUGF5bWVudEZ1bmMgcmVzdWx0ICcsIHJlc3VsdClcbiAgICAgIH0pXG4gICAgfVxuICB9KTtcbiAgcmVzLmpzb24ocGF5bWVudE1ldGhvZHMpXG59KVxuXG5hc3luYyBmdW5jdGlvbiBkZXRhY2hQYXltZW50RnVuYyhwYXltZW50TWV0aG9kaWQsIGNhbGxiYWNrKSB7XG4gIHdpbnN0b24uZGVidWcoJ2RldGFjaFBheW1lbnRGdW5jdCA+IHBheW1lbnRNZXRob2RpZCAnLCBwYXltZW50TWV0aG9kaWQpXG4gIGNvbnN0IHN0cmlwZSA9IHJlcXVpcmUoXCJzdHJpcGVcIikoYXBpU2VjcmV0S2V5KTtcbiAgbGV0IHBheW1lbnRNZXRob2Q7XG4gIHRyeSB7XG4gICAgcGF5bWVudE1ldGhvZCA9IGF3YWl0IHN0cmlwZS5wYXltZW50TWV0aG9kcy5kZXRhY2goXG4gICAgICBwYXltZW50TWV0aG9kaWRcbiAgICApO1xuICAgIGNhbGxiYWNrKHBheW1lbnRNZXRob2QpXG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjYWxsYmFjayhlKVxuICB9XG59XG5cblxuXG4vLyBjdXJsIC1YIFBPU1QgLXUgYW5kcmVhLmxlb0BmMjEuaXQ6MTIzNDU2IC1IICdDb250ZW50LVR5cGU6YXBwbGljYXRpb24vanNvbicgLWQgJ3tcInR5cGVcIjpcInBheW1lbnRfaW50ZW50LnN1Y2NlZWRlZFwifScgIGh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9tb2R1bGVzL3BheW1lbnRzL3N0cmlwZS93ZWJob29rXG5cbi8vIHJvdXRlci5wb3N0KCcvd2ViaG9vaycsIGZ1bmN0aW9uKHJlcXVlc3QsIHJlc3BvbnNlKSB7XG4vLyAgIHdpbnN0b24uaW5mbygnc3RyaXBlIHdlYmhvb2snKTtcblxuLy8gLy8gTWF0Y2ggdGhlIHJhdyBib2R5IHRvIGNvbnRlbnQgdHlwZSBhcHBsaWNhdGlvbi9qc29uXG4vLyAvLyBhcHAucG9zdCgnJywgYm9keVBhcnNlci5yYXcoe3R5cGU6ICdhcHBsaWNhdGlvbi9qc29uJ30pLCAocmVxdWVzdCwgcmVzcG9uc2UpID0+IHtcbi8vICAgICBsZXQgZXZlbnQgPSByZXF1ZXN0LmJvZHk7XG4vLyAgICAgd2luc3Rvbi5pbmZvKCdldmVudCcsZXZlbnQpOyAgXG5cbi8vICAgICAvLyBIYW5kbGUgdGhlIGV2ZW50XG4vLyAgICAgc3dpdGNoIChldmVudC50eXBlKSB7XG4vLyAgICAgICBjYXNlICdwYXltZW50X2ludGVudC5zdWNjZWVkZWQnOlxuLy8gICAgICAgICBjb25zdCBwYXltZW50SW50ZW50ID0gZXZlbnQuZGF0YS5vYmplY3Q7XG4vLyAgICAgICAgIGhhbmRsZVBheW1lbnRJbnRlbnRTdWNjZWVkZWQocGF5bWVudEludGVudCk7XG4vLyAgICAgICAgIGJyZWFrO1xuLy8gICAgICAgY2FzZSAncGF5bWVudF9tZXRob2QuYXR0YWNoZWQnOlxuLy8gICAgICAgICBjb25zdCBwYXltZW50TWV0aG9kID0gZXZlbnQuZGF0YS5vYmplY3Q7XG4vLyAgICAgICAgIGhhbmRsZVBheW1lbnRNZXRob2RBdHRhY2hlZChwYXltZW50TWV0aG9kKTtcbi8vICAgICAgICAgYnJlYWs7XG4vLyAgICAgICAvLyAuLi4gaGFuZGxlIG90aGVyIGV2ZW50IHR5cGVzXG4vLyAgICAgICBkZWZhdWx0OlxuLy8gICAgICAgICAvLyBVbmV4cGVjdGVkIGV2ZW50IHR5cGVcbi8vICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1cyg0MDApLmVuZCgpO1xuLy8gICAgIH1cblxuLy8gICAgIC8vIFJldHVybiBhIHJlc3BvbnNlIHRvIGFja25vd2xlZGdlIHJlY2VpcHQgb2YgdGhlIGV2ZW50XG4vLyAgICAgcmVzcG9uc2UuanNvbih7cmVjZWl2ZWQ6IHRydWV9KTtcbi8vIH0pO1xuXG5cblxuXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjsiXSwiZmlsZSI6InBheW1lbnRzL3N0cmlwZS9pbmRleC5qcyJ9
