var _0x2737=['stripe','send','PAYMENT_STRIPE_API_SECRET_KEY','--\x20>\x20subscription\x20get\x20by\x20id\x20from\x20stripe\x20\x20err\x20','****\x20Stripe\x20error\x20constructEvent:\x20','»»»\x20»»»\x20updatesubscription\x20userid','subscription','--\x20>\x20cancelsubscription\x20confirmation\x20','--\x20>\x20subscription\x20get\x20by\x20id\x20freq.params.subscriptionid\x20','total_count','customer.subscription.deleted\x20subscriptionPayment\x20project\x20id:\x20','***\x20***\x20checkout.session.completed\x20-\x20getSubscritionById\x20err\x20','free','list','checkout.session.completed','»»»\x20»»»\x20cancelsubscription\x20projectid','stripe\x20apiSecretKey','checkout','subscriptionId','expiration_date_year','subscriptionid','»»»\x20»»»\x20\x20paymentMethod','--\x20>\x20checkoutSession\x20get\x20by\x20id\x20from\x20stripe\x20\x20err\x20','stripe\x20user_id:','/webhook','authenticate','PAYMENT_STRIPE_SECRET','***\x20***\x20invoice.payment_succeeded\x20-\x20subscription\x20ID:\x20','userid','status','/:subscriptionid','../models/subscription-payment','PAYMENT_STRIPE_APIKEY','customers','\x20!!!!!!!!\x20HI\x20!!!!!!!!\x20invoice.payment_succeeded','then','unix','--\x20>\x20updatesubscription\x20Error\x20getting\x20project\x20','customer.subscription.deleted\x20subscriptionPayment\x20user\x20id:\x20','»»»\x20»»»\x20updatesubscription\x20price','---\x20>\x20ERROR\x20','Router','/checkoutSession/:sessionid','message','YYYY-MM-DDTHH:mm:ss.SSS','stripe\x20seats_num:\x20','get\x20PaymentMethods\x20list\x20>\x20paymentMethods\x20>\x20paymentMethods.data\x20','detach','/stripesubs/:subscriptionid','update','stripe\x20seats_numAsString:\x20','env','period','subscriptions','stripe\x20sig:\x20','application/json','body-parser','default_payment_method','***\x20***\x20subscription\x20ID\x20','jwt','forEach','params','--\x20>\x20get\x20customer\x20from\x20db\x20>\x20customer\x20+\x20paymentMethods\x20','»»»»\x20stripe\x20apiKey:\x20','!!!!!!!!\x20HI\x20!!!!!!!!\x20checkout.session.completed','--\x20>\x20get\x20customer\x20from\x20db\x20>\x20customer\x20from\x20stripe\x20API\x20','stripe\x20endpointSecret','--\x20>\x20cancelsubscription\x20Error\x20getting\x20project\x20','agents','stripe\x20project_id:\x20','type','stripe\x20client_reference_id','***\x20***\x20checkout.session.completed\x20-\x20getSubscritionById\x20***\x20start\x20***\x20:\x20','***\x20***\x20invoice.payment_succeeded\x20-\x20linesNum:\x20','get','customer.subscription.deleted\x20event\x20','post','current_period_start','get\x20PaymentMethods\x20list\x20>\x20paymentMethods\x20>\x20default_payment_method_id\x20','exec','profile','/updatesubscription','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20subsptn_payment\x20typeof\x20subsptn_payment:\x20','savedSubscriptionPayment\x20','»»»\x20»»»\x20\x20paymentMethod\x20create\x20\x20error\x20','catch','start','card','***\x20***\x20»»»\x20»»»\x20customer.subscription.deleted\x20subscriptionPayment\x20','invoice.payment_succeeded','format','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20project\x20>\x20profile','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20find\x20Project\x20','client_reference_id','../../../../models/project','object','***\x20***\x20invoice.payment_succeeded\x20-\x20index:\x20','moment','basic','saveOnDB\x20seats_num','../../../../middleware/valid-token','user_id','body','express','info','customer','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20subsptn_payment:\x20','split','invoice_settings','project_id','../../../../config/winston','name','stripe\x20checkout.session.completed','typeof\x20','sessionid','billing_reason','--\x20>\x20updatesubscription\x20\x20project\x20','--\x20>\x20checkoutSession\x20get\x20by\x20id\x20from\x20stripe\x20','paymentMethods','»»»\x20»»»\x20cancelsubscription\x20userid','passport','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20project\x20','findOne','current_period_end','sessions','lines','price','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20project\x20>\x20profile\x20>\x20agents\x20typeof','customerid','--\x20>\x20get\x20customer\x20from\x20db\x20-\x20Error\x20','data','saveOnDB\x20plan_name','del','constructEvent','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20-\x20err\x20','»»»\x20»»»\x20get\x20customer\x20from\x20db\x20-\x20projectid','»»»\x20»»»\x20updatesubscription\x20projectid','retrieve','exports','stripe\x20apiKey','json','credit_card_cvc','asc','error','rawBody','subscription_create','***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20project\x20>\x20profile\x20>\x20agents','mongoose','ObjectId','Error\x20saving\x20object.','detachPaymentFunct\x20>\x20paymentMethodid\x20','webhooks','projectid','get\x20PaymentMethods\x20list\x20>\x20paymentMethods\x20','payment','Types','***\x20***\x20checkout.session.completed\x20-\x20getSubscription\x20***\x20end\x20***\x20:\x20','sort','get\x20PaymentMethods\x20list\x20req.params\x20>\x20customer_id\x20','»»»\x20»»»\x20get\x20customer\x20from\x20db\x20','debug','save','/customers/:customerid','detachPaymentFunc\x20result\x20','put','raw','»»»»\x20stripe\x20endpointSecret:\x20','Webhook\x20Error:\x20'];(function(_0x3a49b3,_0x27375c){var _0x20eaf7=function(_0x2af04d){while(--_0x2af04d){_0x3a49b3['push'](_0x3a49b3['shift']());}};_0x20eaf7(++_0x27375c);}(_0x2737,0x159));var _0x20ea=function(_0x3a49b3,_0x27375c){_0x3a49b3=_0x3a49b3-0x0;var _0x20eaf7=_0x2737[_0x3a49b3];return _0x20eaf7;};var express=require(_0x20ea('0x5e'));var router=express[_0x20ea('0x20')]();var winston=require(_0x20ea('0x65'));var Project=require(_0x20ea('0x55'));var SubscriptionPayment=require(_0x20ea('0x16'));var moment=require(_0x20ea('0x58'));var mongoose=require(_0x20ea('0x8a'));var passport=require(_0x20ea('0x6f'));require('../../../../middleware/passport')(passport);var validtoken=require(_0x20ea('0x5b'));const apiKey=process[_0x20ea('0x2a')][_0x20ea('0x17')];winston[_0x20ea('0x97')](_0x20ea('0x82')+apiKey);const stripe=require(_0x20ea('0x9f'))(apiKey);const endpointSecret=process[_0x20ea('0x2a')][_0x20ea('0x11')];winston['debug'](_0x20ea('0x39')+endpointSecret);const apiSecretKey=process['env'][_0x20ea('0xa1')];winston['debug'](_0x20ea('0x7')+apiSecretKey);const bodyParser=require(_0x20ea('0x2f'));router[_0x20ea('0x43')](_0x20ea('0xf'),bodyParser[_0x20ea('0x9c')]({'type':_0x20ea('0x2e')}),function(_0x46e3e6,_0x1e4c5e){winston[_0x20ea('0x97')](_0x20ea('0x9d')+endpointSecret);winston[_0x20ea('0x97')](_0x20ea('0x36')+apiKey);winston[_0x20ea('0x97')](_0x20ea('0x7')+apiSecretKey);const _0x1dc549=_0x46e3e6['headers']['stripe-signature'];winston['debug'](_0x20ea('0x2d'),_0x1dc549);let _0x4f986a;try{_0x4f986a=stripe[_0x20ea('0x8e')][_0x20ea('0x7c')](_0x46e3e6[_0x20ea('0x87')],_0x1dc549,endpointSecret);}catch(_0x49aab2){winston[_0x20ea('0x86')](_0x20ea('0xa3'),_0x49aab2['message']);return _0x1e4c5e[_0x20ea('0x14')](0x190)['send'](_0x20ea('0x9e')+_0x49aab2[_0x20ea('0x22')]);}if(_0x4f986a[_0x20ea('0x3d')]==='checkout.session.completed'){winston[_0x20ea('0x97')](_0x20ea('0x37'));const _0x17100f=_0x4f986a[_0x20ea('0x79')][_0x20ea('0x56')];winston[_0x20ea('0x5f')](_0x20ea('0x67'),_0x17100f);var _0x5408c4=_0x17100f[_0x20ea('0x54')];winston[_0x20ea('0x5f')](_0x20ea('0x3e'),_0x5408c4);var _0x42466e=_0x5408c4['split']('_')[0x0];winston['info'](_0x20ea('0xe')+_0x42466e);var _0x27cbac=_0x5408c4[_0x20ea('0x62')]('_')[0x1];winston[_0x20ea('0x5f')](_0x20ea('0x3c')+_0x27cbac);var _0x4767ad=_0x5408c4['split']('_')[0x2];winston[_0x20ea('0x5f')]('stripe\x20plan_name:\x20'+_0x4767ad);var _0x30761f=_0x5408c4[_0x20ea('0x62')]('_')[0x3];winston[_0x20ea('0x5f')](_0x20ea('0x24')+_0x30761f+_0x20ea('0x68'),typeof _0x30761f);var _0x547fe4=Number(_0x30761f);winston[_0x20ea('0x5f')](_0x20ea('0x29')+_0x547fe4+'\x20typeof\x20',typeof _0x547fe4);var _0x3304c3=_0x4f986a[_0x20ea('0x79')][_0x20ea('0x56')][_0x20ea('0xa5')];winston[_0x20ea('0x5f')]('***\x20***\x20!!!!!!!!!!!!!!!!!!!!!!\x20checkout.session.completed\x20-\x20subscription\x20ID:\x20',_0x3304c3);getSubscritionById(_0x3304c3)[_0x20ea('0x1a')](function(_0x44ad99){var _0x3acad6=_0x44ad99[_0x20ea('0x56')];winston[_0x20ea('0x5f')]('***\x20***\x20checkout.session.completed\x20-\x20getSubscritionById\x20subscr\x20object_type:\x20',_0x3acad6);var _0x4b3865=moment['unix'](_0x44ad99[_0x20ea('0x44')])['format'](_0x20ea('0x23'));winston['info'](_0x20ea('0x3f'),_0x4b3865);var _0x5ed13b=moment[_0x20ea('0x1b')](_0x44ad99[_0x20ea('0x72')])[_0x20ea('0x51')](_0x20ea('0x23'));winston[_0x20ea('0x5f')](_0x20ea('0x93'),_0x5ed13b);var _0x461b08={'profile':{'name':_0x4767ad,'type':_0x20ea('0x91'),'subscription_creation_date':_0x4b3865,'subStart':_0x4b3865,'subEnd':_0x5ed13b,'subscriptionId':_0x3304c3,'last_stripe_event':_0x4f986a[_0x20ea('0x3d')],'agents':_0x547fe4}};updateProjectProfile(_0x27cbac,_0x461b08,'checkout.session.completed');saveOnDB(_0x3304c3,_0x27cbac,_0x44ad99,_0x42466e,_0x4f986a[_0x20ea('0x3d')],_0x4767ad,_0x547fe4);})[_0x20ea('0x4c')](function(_0x47eed5){winston[_0x20ea('0x86')](_0x20ea('0x2'),_0x47eed5);});}if(_0x4f986a['type']===_0x20ea('0x50')){winston[_0x20ea('0x5f')](_0x20ea('0x19'));winston['info']('***\x20***\x20invoice.payment_succeeded\x20-\x20BILLING\x20REASON\x20',_0x4f986a[_0x20ea('0x79')][_0x20ea('0x56')][_0x20ea('0x6a')]);var _0x273ed1=_0x4f986a['data']['object'][_0x20ea('0x74')][_0x20ea('0x0')];winston[_0x20ea('0x5f')](_0x20ea('0x40'),_0x273ed1);var _0x4c60c0=_0x273ed1-0x1;winston['info'](_0x20ea('0x57'),_0x4c60c0);var _0x346721=moment['unix'](_0x4f986a[_0x20ea('0x79')][_0x20ea('0x56')]['lines'][_0x20ea('0x79')][_0x4c60c0][_0x20ea('0x2b')][_0x20ea('0x4d')])[_0x20ea('0x51')](_0x20ea('0x23'));winston[_0x20ea('0x5f')]('***\x20***\x20invoice.payment_succeeded\x20-\x20start:\x20',_0x346721);var _0x2f1858=moment['unix'](_0x4f986a[_0x20ea('0x79')][_0x20ea('0x56')][_0x20ea('0x74')]['data'][_0x4c60c0][_0x20ea('0x2b')]['end'])[_0x20ea('0x51')]('YYYY-MM-DDTHH:mm:ss.SSS');winston[_0x20ea('0x5f')]('***\x20***\x20invoice.payment_succeeded\x20-\x20end:\x20',_0x2f1858);var _0x3304c3=_0x4f986a[_0x20ea('0x79')]['object']['subscription'];winston[_0x20ea('0x5f')](_0x20ea('0x12'),_0x3304c3);if(_0x3304c3==null){_0x3304c3=_0x4f986a[_0x20ea('0x79')][_0x20ea('0x56')][_0x20ea('0x74')]['data'][0x0][_0x20ea('0xa5')];winston[_0x20ea('0x5f')](_0x20ea('0x12'),_0x3304c3);}if(_0x4f986a['data'][_0x20ea('0x56')][_0x20ea('0x6a')]!==_0x20ea('0x88')){getSubByIdAndCheckoutSessionCompletedEvnt(_0x3304c3)[_0x20ea('0x1a')](function(_0x4a41a7){winston[_0x20ea('0x5f')](_0x20ea('0x61'),_0x4a41a7);winston['info'](_0x20ea('0x49'),typeof _0x4a41a7);if(_0x4a41a7){var _0x2d7d32=_0x4a41a7[_0x20ea('0x64')];winston[_0x20ea('0x5f')]('***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20subsptn_payment\x20>\x20project_id:\x20',_0x2d7d32);Project[_0x20ea('0x71')]({'_id':_0x2d7d32},function(_0x28b857,_0x1071b7){if(_0x28b857){winston['info'](_0x20ea('0x53'),_0x28b857);return _0x28b857;}if(_0x1071b7){winston[_0x20ea('0x5f')](_0x20ea('0x70'),_0x1071b7);winston[_0x20ea('0x5f')](_0x20ea('0x52'),_0x1071b7[_0x20ea('0x47')]);var _0x26a55e=_0x1071b7[_0x20ea('0x47')][_0x20ea('0x3b')];winston['info'](_0x20ea('0x89'),_0x26a55e);var _0x8d15a6=_0x1071b7[_0x20ea('0x47')][_0x20ea('0x66')];winston[_0x20ea('0x5f')](_0x20ea('0x76'),typeof _0x26a55e);var _0x3f3cef=_0x4a41a7[_0x20ea('0x5c')];winston[_0x20ea('0x5f')]('***\x20***\x20getSubByIdAndCheckoutSessionCompletedEvnt\x20\x20project\x20>\x20profile\x20>\x20name',_0x8d15a6);var _0xce3238={'profile':{'name':_0x8d15a6,'type':_0x20ea('0x91'),'subStart':_0x346721,'subEnd':_0x2f1858,'subscriptionId':_0x3304c3,'last_stripe_event':_0x4f986a['type'],'agents':_0x26a55e}};updateProjectProfile(_0x2d7d32,_0xce3238,'invoice.payment_succeeded');saveOnDB(_0x3304c3,_0x2d7d32,_0x4f986a,_0x3f3cef,_0x4f986a[_0x20ea('0x3d')],_0x8d15a6,_0x26a55e);}});}})[_0x20ea('0x4c')](function(_0x11d18d){winston[_0x20ea('0x86')](_0x20ea('0x7d'),_0x11d18d);});}}if(_0x4f986a['type']==='customer.subscription.deleted'){winston[_0x20ea('0x5f')]('\x20!!!!!!!!\x20HI\x20!!!!!!!!!!!\x20customer.subscription.deleted');winston[_0x20ea('0x5f')](_0x20ea('0x42'),_0x4f986a);var _0x3304c3=_0x4f986a['data'][_0x20ea('0x56')]['id'];winston[_0x20ea('0x5f')](_0x20ea('0x31'),_0x3304c3);getSubByIdAndCheckoutSessionCompletedEvnt(_0x3304c3)[_0x20ea('0x1a')](function(_0x4c7f76){winston[_0x20ea('0x5f')](_0x20ea('0x4f'),_0x4c7f76);if(_0x4c7f76){var _0x19a13a=_0x4c7f76[_0x20ea('0x64')];winston['info'](_0x20ea('0x1'),_0x19a13a);var _0x36e2f5=_0x4c7f76[_0x20ea('0x5c')];winston[_0x20ea('0x5f')](_0x20ea('0x1d'),_0x36e2f5);}var _0x1635a6={'profile':{'subscriptionId':_0x3304c3,'name':'Sandbox','type':_0x20ea('0x3'),'agents':0x1,'last_stripe_event':_0x4f986a[_0x20ea('0x3d')]}};updateProjectProfile(_0x19a13a,_0x1635a6,'subscription.deleted');saveOnDB(_0x3304c3,_0x19a13a,_0x4f986a[_0x20ea('0x79')][_0x20ea('0x56')],_0x36e2f5,_0x4f986a[_0x20ea('0x3d')],_0x4767ad,0x1);})[_0x20ea('0x4c')](function(_0x561469){winston[_0x20ea('0x86')]('***\x20***\x20customer.subscription.deleted\x20',_0x561469);});}_0x1e4c5e[_0x20ea('0x83')]({'received':!![]});});function getSubByIdAndCheckoutSessionCompletedEvnt(_0x5343f7){return new Promise(function(_0x59bcbe,_0x470ad1){SubscriptionPayment[_0x20ea('0x71')]({'subscription_id':_0x5343f7,'stripe_event':_0x20ea('0x5')},function(_0x15d451,_0x3cefaa){if(_0x15d451)_0x470ad1(_0x15d451);var _0x3066ad=_0x3cefaa;_0x59bcbe(_0x3066ad);});});};function getSubscritionById(_0x402d56){return new Promise(function(_0x5331f2,_0x57320f){const _0x460df8=require(_0x20ea('0x9f'))(apiSecretKey);_0x460df8['subscriptions'][_0x20ea('0x80')](_0x402d56,function(_0x45df9a,_0x4cae71){if(_0x45df9a)_0x57320f(_0x45df9a);var _0x4cae71=_0x4cae71;_0x5331f2(_0x4cae71);});});};function updateProjectProfile(_0x4c48b0,_0x53d113,_0x21f418){Project['findByIdAndUpdate'](_0x4c48b0,_0x53d113,{'new':!![],'upsert':!![]},function(_0x394660,_0x528c4b){if(_0x394660){winston[_0x20ea('0x86')]('updateProjectProfile\x20Error\x20',_0x394660);}else{winston[_0x20ea('0x97')](_0x528c4b);}});}function saveOnDB(_0xbe4169,_0x51a395,_0x2cc6f2,_0x423b05,_0x149960,_0x59569e,_0x5172b8){winston[_0x20ea('0x5f')](_0x20ea('0x7a'),_0x59569e);winston[_0x20ea('0x5f')](_0x20ea('0x5a'),_0x5172b8);var _0x95c734=new SubscriptionPayment({'_id':new mongoose[(_0x20ea('0x92'))][(_0x20ea('0x8b'))](),'subscription_id':_0xbe4169,'project_id':_0x51a395,'user_id':_0x423b05,'stripe_event':_0x149960,'plan_name':_0x59569e,'agents':_0x5172b8,'object':_0x2cc6f2});_0x95c734[_0x20ea('0x98')](function(_0x59d773,_0x45c664){if(_0x59d773){winston['error'](_0x20ea('0x1f'),_0x59d773);return res[_0x20ea('0x14')](0x1f4)[_0x20ea('0xa0')]({'success':![],'msg':_0x20ea('0x8c')});}winston['info'](_0x20ea('0x4a'),_0x45c664);});}router[_0x20ea('0x9b')]('/cancelsubscription',[passport[_0x20ea('0x10')]([_0x20ea('0x59'),_0x20ea('0x32')],{'session':![]}),validtoken],function(_0x514510,_0x1495ca){var _0x3001e6=_0x514510[_0x20ea('0x5d')]['projectid'];var _0x1c2944=_0x514510[_0x20ea('0x5d')]['userid'];winston['info'](_0x20ea('0x6'),_0x3001e6);winston[_0x20ea('0x5f')](_0x20ea('0x6e'),_0x1c2944);Project['findOne']({'_id':_0x3001e6},function(_0x2fb4ba,_0x27f229){if(_0x2fb4ba){winston['error'](_0x20ea('0x3a'),_0x2fb4ba);return _0x2fb4ba;}if(_0x27f229){winston[_0x20ea('0x5f')]('--\x20>\x20cancelsubscription\x20\x20project\x20',_0x27f229);var _0x213c17=_0x27f229[_0x20ea('0x47')][_0x20ea('0x9')];const _0x92cd75=require('stripe')(apiSecretKey);_0x92cd75[_0x20ea('0x2c')][_0x20ea('0x7b')](_0x213c17,function(_0x37719d,_0x289d53){if(_0x37719d){winston['error']('--\x20>\x20cancelsubscription\x20\x20err\x20',_0x37719d);return _0x1495ca['status'](0x1f4)[_0x20ea('0xa0')]({'success':![],'msg':_0x37719d});}winston['info'](_0x20ea('0xa6'),_0x289d53);_0x1495ca[_0x20ea('0x83')](_0x289d53);});}});});router['put'](_0x20ea('0x48'),[passport[_0x20ea('0x10')]([_0x20ea('0x59'),_0x20ea('0x32')],{'session':![]}),validtoken],function(_0x5bcdd1,_0xfe5ec6){var _0x3c29ca=_0x5bcdd1['body'][_0x20ea('0x8f')];var _0x1c51d0=_0x5bcdd1[_0x20ea('0x5d')][_0x20ea('0x13')];var _0x2a4e91=_0x5bcdd1[_0x20ea('0x5d')][_0x20ea('0x75')];winston['info'](_0x20ea('0x7f'),_0x3c29ca);winston[_0x20ea('0x5f')](_0x20ea('0xa4'),_0x1c51d0);winston[_0x20ea('0x5f')](_0x20ea('0x1e'),_0x2a4e91);const _0x4f2e1d=require('stripe')(apiSecretKey);Project[_0x20ea('0x71')]({'_id':_0x3c29ca},function(_0x30617a,_0x2dcf81){if(_0x30617a){winston[_0x20ea('0x86')](_0x20ea('0x1c'),_0x30617a);return _0x30617a;}if(_0x2dcf81){winston[_0x20ea('0x5f')](_0x20ea('0x6b'),_0x2dcf81);var _0xcb8611=_0x2dcf81[_0x20ea('0x47')][_0x20ea('0x9')];_0x4f2e1d[_0x20ea('0x2c')][_0x20ea('0x28')](_0xcb8611);}});});router[_0x20ea('0x41')](_0x20ea('0x15'),[passport['authenticate']([_0x20ea('0x59'),'jwt'],{'session':![]}),validtoken],function(_0x5cceaa,_0x434719){SubscriptionPayment['find']({'subscription_id':_0x5cceaa[_0x20ea('0x34')]['subscriptionid']})[_0x20ea('0x94')]({'object.created':_0x20ea('0x85')})[_0x20ea('0x46')](function(_0x2275e4,_0x4ef238){if(_0x2275e4){winston[_0x20ea('0x86')]('--\x20>\x20GET\x20SUBSCRIPTION\x20PAYMENTS\x20ERRORt\x20',project);return _0x434719[_0x20ea('0x14')](0x1f4)[_0x20ea('0xa0')]({'success':![],'msg':_0x2275e4});}_0x434719[_0x20ea('0x83')](_0x4ef238);});});router[_0x20ea('0x41')](_0x20ea('0x27'),[passport[_0x20ea('0x10')]([_0x20ea('0x59'),_0x20ea('0x32')],{'session':![]}),validtoken],function(_0x5c4aab,_0x5ef55a){winston[_0x20ea('0x5f')](_0x20ea('0xa7'),_0x5c4aab[_0x20ea('0x34')]['subscriptionid']);var _0x5d951b=require(_0x20ea('0x9f'))(apiSecretKey);_0x5d951b[_0x20ea('0x2c')]['retrieve'](_0x5c4aab[_0x20ea('0x34')][_0x20ea('0xb')],function(_0x20b089,_0x3d7d6b){if(_0x20b089){winston['error'](_0x20ea('0xa2'),_0x20b089);return _0x5ef55a['status'](0x1f4)[_0x20ea('0xa0')]({'success':![],'msg':_0x20b089});}winston[_0x20ea('0x5f')]('--\x20>\x20subscription\x20get\x20by\x20id\x20from\x20stripe\x20',_0x3d7d6b);_0x5ef55a['json'](_0x3d7d6b);});});router[_0x20ea('0x41')](_0x20ea('0x21'),[passport[_0x20ea('0x10')]([_0x20ea('0x59'),_0x20ea('0x32')],{'session':![]}),validtoken],function(_0x3bfa68,_0x131701){winston[_0x20ea('0x5f')]('--\x20>\x20checkoutSession\x20params.sessionid\x20',_0x3bfa68[_0x20ea('0x34')][_0x20ea('0x69')]);var _0x12a482=require(_0x20ea('0x9f'))(apiSecretKey);_0x12a482[_0x20ea('0x8')][_0x20ea('0x73')][_0x20ea('0x80')](_0x3bfa68[_0x20ea('0x34')][_0x20ea('0x69')],function(_0x483f3b,_0x44f107){if(_0x483f3b){winston['info'](_0x20ea('0xd'),_0x483f3b);return _0x131701['status'](0x1f4)['send']({'success':![],'msg':_0x483f3b});}winston[_0x20ea('0x5f')](_0x20ea('0x6c'),_0x44f107);_0x131701[_0x20ea('0x83')](_0x44f107);});});router['get']('/customer/:projectid',[passport[_0x20ea('0x10')](['basic',_0x20ea('0x32')],{'session':![]}),validtoken],function(_0x1cc77c,_0x47117d){winston['debug'](_0x20ea('0x96'),_0x1cc77c[_0x20ea('0x34')]);var _0x2a6114=_0x1cc77c[_0x20ea('0x34')][_0x20ea('0x8f')];winston[_0x20ea('0x97')](_0x20ea('0x7e'),_0x2a6114);SubscriptionPayment['find']({'project_id':_0x2a6114,'stripe_event':_0x20ea('0x5')},async function(_0x578f51,_0x3e734f){if(_0x578f51){winston[_0x20ea('0x97')](_0x20ea('0x78'),_0x578f51);return _0x578f51;}if(_0x3e734f){_0x3e734f[0x0][_0x20ea('0x56')]['customer'];winston[_0x20ea('0x97')]('--\x20>\x20get\x20customer\x20from\x20db\x20-\x20subscription\x20>\x20customer\x20id\x20',_0x3e734f[0x0][_0x20ea('0x56')][_0x20ea('0x60')]);const _0x3b1d34=_0x3e734f[0x0][_0x20ea('0x56')][_0x20ea('0x60')];const _0x965153=require(_0x20ea('0x9f'))(apiSecretKey);const _0x3713d9=await _0x965153[_0x20ea('0x18')]['retrieve'](_0x3b1d34);winston[_0x20ea('0x97')](_0x20ea('0x38'),_0x3713d9);const _0x1e69af=await _0x965153['paymentMethods'][_0x20ea('0x4')]({'customer':_0x3b1d34,'type':_0x20ea('0x4e')});_0x3713d9[_0x20ea('0x6d')]=_0x1e69af;winston['debug'](_0x20ea('0x35'),_0x3e734f);_0x47117d['json'](_0x3713d9);}});});router[_0x20ea('0x43')](_0x20ea('0x99'),[passport['authenticate']([_0x20ea('0x59'),_0x20ea('0x32')],{'session':![]}),validtoken],async function(_0x265915,_0x4b2c3a){var _0x3cbb59=_0x265915['params'][_0x20ea('0x77')];winston[_0x20ea('0x97')]('»»»\x20»»»\x20\x20update\x20customer\x20-\x20customerid\x20from\x20params\x20',_0x3cbb59);winston['debug']('»»»\x20»»»\x20\x20update\x20customer\x20-\x20cc\x20from\x20body\x20',_0x265915[_0x20ea('0x5d')]);const _0xc1026f=require(_0x20ea('0x9f'))(apiSecretKey);let _0x29cc5b;try{_0x29cc5b=await _0xc1026f['paymentMethods']['create']({'type':_0x20ea('0x4e'),'card':{'number':_0x265915['body']['credit_card_num'],'exp_month':_0x265915[_0x20ea('0x5d')]['expiration_date_month'],'exp_year':_0x265915['body'][_0x20ea('0xa')],'cvc':_0x265915[_0x20ea('0x5d')][_0x20ea('0x84')]}});}catch(_0x203ae3){winston[_0x20ea('0x86')](_0x20ea('0x4b'),_0x203ae3);return _0x4b2c3a[_0x20ea('0x14')](0x1f6)['send']({'success':![],'msg':_0x203ae3});}winston['debug'](_0x20ea('0xc'),_0x29cc5b);try{const _0xfbfd6f=await _0xc1026f[_0x20ea('0x6d')]['attach'](_0x29cc5b['id'],{'customer':_0x3cbb59});winston[_0x20ea('0x97')]('»»»\x20»»»\x20\x20paymentMethod\x20attached\x20',_0xfbfd6f);}catch(_0x30d27f){winston[_0x20ea('0x86')]('»»»\x20»»»\x20\x20paymentMethod\x20attached\x20\x20error\x20',_0x30d27f);return _0x4b2c3a[_0x20ea('0x14')](0x1f5)['send']({'success':![],'msg':_0x30d27f});}const _0x23f53e=await _0xc1026f['customers'][_0x20ea('0x28')](_0x3cbb59,{'invoice_settings':{'default_payment_method':_0x29cc5b['id']}});_0x4b2c3a[_0x20ea('0x83')](_0x23f53e);});router[_0x20ea('0x41')]('/payment_methods/:customerid',[passport['authenticate']([_0x20ea('0x59'),_0x20ea('0x32')],{'session':![]}),validtoken],async function(_0x5bd353,_0x2ad960){winston[_0x20ea('0x5f')]('get\x20PaymentMethods\x20list\x20req.params',_0x5bd353[_0x20ea('0x34')]);var _0x361741=_0x5bd353[_0x20ea('0x34')][_0x20ea('0x77')];winston[_0x20ea('0x97')](_0x20ea('0x95'),_0x361741);const _0x30728f=require(_0x20ea('0x9f'))(apiSecretKey);const _0x5988fe=await _0x30728f['customers'][_0x20ea('0x80')](_0x361741);const _0xa51720=_0x5988fe[_0x20ea('0x63')][_0x20ea('0x30')];let _0x5b2e6f;try{_0x5b2e6f=await _0x30728f[_0x20ea('0x6d')]['list']({'customer':_0x361741,'type':_0x20ea('0x4e')});winston[_0x20ea('0x97')](_0x20ea('0x90'),_0x5b2e6f);}catch(_0xc90aad){return _0x2ad960[_0x20ea('0x14')](0x1f5)[_0x20ea('0xa0')]({'success':![],'msg':_0xc90aad});}winston['debug'](_0x20ea('0x45'),_0xa51720);_0x5b2e6f[_0x20ea('0x79')][_0x20ea('0x33')](_0xe99275=>{if(_0xe99275['id']!==_0xa51720){winston[_0x20ea('0x97')](_0x20ea('0x25'),_0xe99275['id']);detachPaymentFunc(_0xe99275['id'],function(_0x15f668){winston['info'](_0x20ea('0x9a'),_0x15f668);});}});_0x2ad960[_0x20ea('0x83')](_0x5b2e6f);});async function detachPaymentFunc(_0x83b141,_0xbb2806){winston[_0x20ea('0x97')](_0x20ea('0x8d'),_0x83b141);const _0x15affa=require(_0x20ea('0x9f'))(apiSecretKey);let _0x660deb;try{_0x660deb=await _0x15affa[_0x20ea('0x6d')][_0x20ea('0x26')](_0x83b141);_0xbb2806(_0x660deb);}catch(_0x290186){_0xbb2806(_0x290186);}}module[_0x20ea('0x81')]=router;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBheW1lbnRzL3N0cmlwZS9pbmRleC5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIndpbnN0b24iLCJQcm9qZWN0IiwiU3Vic2NyaXB0aW9uUGF5bWVudCIsIm1vbWVudCIsIm1vbmdvb3NlIiwicGFzc3BvcnQiLCJ2YWxpZHRva2VuIiwiYXBpS2V5IiwicHJvY2VzcyIsInN0cmlwZSIsImVuZHBvaW50U2VjcmV0IiwiYXBpU2VjcmV0S2V5IiwiYm9keVBhcnNlciIsIl8weDQ2ZTNlNiIsIl8weDFlNGM1ZSIsIl8weDFkYzU0OSIsIl8weDRmOTg2YSIsIl8weDQ5YWFiMiIsIl8weDE3MTAwZiIsIl8weDU0MDhjNCIsIl8weDQyNDY2ZSIsIl8weDI3Y2JhYyIsIl8weDQ3NjdhZCIsIl8weDMwNzYxZiIsIl8weDU0N2ZlNCIsIk51bWJlciIsIl8weDMzMDRjMyIsImdldFN1YnNjcml0aW9uQnlJZCIsIl8weDQ0YWQ5OSIsIl8weDNhY2FkNiIsIl8weDRiMzg2NSIsIl8weDVlZDEzYiIsIl8weDQ2MWIwOCIsInVwZGF0ZVByb2plY3RQcm9maWxlIiwic2F2ZU9uREIiLCJfMHg0N2VlZDUiLCJfMHgyNzNlZDEiLCJfMHg0YzYwYzAiLCJfMHgzNDY3MjEiLCJfMHgyZjE4NTgiLCJnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudCIsIl8weDRhNDFhNyIsIl8weDJkN2QzMiIsIl8weDI4Yjg1NyIsIl8weDEwNzFiNyIsIl8weDI2YTU1ZSIsIl8weDhkMTVhNiIsIl8weDNmM2NlZiIsIl8weGNlMzIzOCIsIl8weDExZDE4ZCIsIl8weDRjN2Y3NiIsIl8weDE5YTEzYSIsIl8weDM2ZTJmNSIsIl8weDE2MzVhNiIsIl8weDU2MTQ2OSIsIl8weDUzNDNmNyIsIlByb21pc2UiLCJfMHg1OWJjYmUiLCJfMHg0NzBhZDEiLCJfMHgxNWQ0NTEiLCJfMHgzY2VmYWEiLCJfMHgzMDY2YWQiLCJfMHg0MDJkNTYiLCJfMHg1MzMxZjIiLCJfMHg1NzMyMGYiLCJfMHg0NjBkZjgiLCJfMHg0NWRmOWEiLCJfMHg0Y2FlNzEiLCJfMHg0YzQ4YjAiLCJfMHg1M2QxMTMiLCJfMHgyMWY0MTgiLCJfMHgzOTQ2NjAiLCJfMHg1MjhjNGIiLCJfMHhiZTQxNjkiLCJfMHg1MWEzOTUiLCJfMHgyY2M2ZjIiLCJfMHg0MjNiMDUiLCJfMHgxNDk5NjAiLCJfMHg1OTU2OWUiLCJfMHg1MTcyYjgiLCJfMHg5NWM3MzQiLCJfMHg1OWQ3NzMiLCJfMHg0NWM2NjQiLCJyZXMiLCJfMHg1MTQ1MTAiLCJfMHgxNDk1Y2EiLCJfMHgzMDAxZTYiLCJfMHgxYzI5NDQiLCJfMHgyZmI0YmEiLCJfMHgyN2YyMjkiLCJfMHgyMTNjMTciLCJfMHg5MmNkNzUiLCJfMHgzNzcxOWQiLCJfMHgyODlkNTMiLCJfMHg1YmNkZDEiLCJfMHhmZTVlYzYiLCJfMHgzYzI5Y2EiLCJfMHgxYzUxZDAiLCJfMHgyYTRlOTEiLCJfMHg0ZjJlMWQiLCJfMHgzMDYxN2EiLCJfMHgyZGNmODEiLCJfMHhjYjg2MTEiLCJfMHg1Y2NlYWEiLCJfMHg0MzQ3MTkiLCJfMHgyMjc1ZTQiLCJfMHg0ZWYyMzgiLCJwcm9qZWN0IiwiXzB4NWM0YWFiIiwiXzB4NWVmNTVhIiwiXzB4NWQ5NTFiIiwiXzB4MjBiMDg5IiwiXzB4M2Q3ZDZiIiwiXzB4M2JmYTY4IiwiXzB4MTMxNzAxIiwiXzB4MTJhNDgyIiwiXzB4NDgzZjNiIiwiXzB4NDRmMTA3IiwiXzB4MWNjNzdjIiwiXzB4NDcxMTdkIiwiXzB4MmE2MTE0IiwiXzB4NTc4ZjUxIiwiXzB4M2U3MzRmIiwiXzB4M2IxZDM0IiwiXzB4OTY1MTUzIiwiXzB4MzcxM2Q5IiwiXzB4MWU2OWFmIiwiXzB4MjY1OTE1IiwiXzB4NGIyYzNhIiwiXzB4M2NiYjU5IiwiXzB4YzEwMjZmIiwiXzB4MjljYzViIiwiXzB4MjAzYWUzIiwiXzB4ZmJmZDZmIiwiXzB4MzBkMjdmIiwiXzB4MjNmNTNlIiwiXzB4NWJkMzUzIiwiXzB4MmFkOTYwIiwiXzB4MzYxNzQxIiwiXzB4MzA3MjhmIiwiXzB4NTk4OGZlIiwiXzB4YTUxNzIwIiwiXzB4NWIyZTZmIiwiXzB4YzkwYWFkIiwiXzB4ZTk5Mjc1IiwiZGV0YWNoUGF5bWVudEZ1bmMiLCJfMHgxNWY2NjgiLCJfMHg4M2IxNDEiLCJfMHhiYjI4MDYiLCJfMHgxNWFmZmEiLCJfMHg2NjBkZWIiLCJfMHgyOTAxODYiLCJtb2R1bGUiXSwibWFwcGluZ3MiOiJnM0tBQUEsSUFBSUEsT0FBQSxDQUFVQyxPQUFBLEMsZUFBQSxDQUFkLENBQ0EsSUFBSUMsTUFBQSxDQUFTRixPQUFBLEMsZUFBQSxHQUFiLENBQ0EsSUFBSUcsT0FBQSxDQUFVRixPQUFBLEMsZUFBQSxDQUFkLENBQ0EsSUFBSUcsT0FBQSxDQUFVSCxPQUFBLEMsZUFBQSxDQUFkLENBQ0EsSUFBSUksbUJBQUEsQ0FBc0JKLE9BQUEsQyxlQUFBLENBQTFCLENBQ0EsSUFBSUssTUFBQSxDQUFTTCxPQUFBLEMsZUFBQSxDQUFiLENBQ0EsSUFBSU0sUUFBQSxDQUFXTixPQUFBLEMsZUFBQSxDQUFmLENBQ0EsSUFBSU8sUUFBQSxDQUFXUCxPQUFBLEMsZUFBQSxDQUFmLENBQ0FBLE9BQUEsQyxpQ0FBQSxFQUEyQ08sUUFBM0MsRUFDQSxJQUFJQyxVQUFBLENBQWFSLE9BQUEsQyxlQUFBLENBQWpCLENBR0EsTUFBTVMsTUFBQSxDQUFTQyxPQUFBLEMsZUFBQSxFLGVBQUEsQ0FBZixDQUNBUixPQUFBLEMsZUFBQSxFLGVBQWMsQ0FBa0JPLE1BQWhDLEVBRUEsTUFBTUUsTUFBQSxDQUFTWCxPQUFBLEMsZUFBQSxFQUFrQlMsTUFBbEIsQ0FBZixDQUdBLE1BQU1HLGNBQUEsQ0FBaUJGLE9BQUEsQyxlQUFBLEUsZUFBQSxDQUF2QixDQUNBUixPQUFBLEMsT0FBQSxFLGVBQWMsQ0FBMEJVLGNBQXhDLEVBRUEsTUFBTUMsWUFBQSxDQUFlSCxPQUFBLEMsS0FBQSxFLGVBQUEsQ0FBckIsQ0FDQVIsT0FBQSxDLE9BQUEsRSxjQUFjLENBQXdCVyxZQUF0QyxFQUVBLE1BQU1DLFVBQUEsQ0FB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SSxDQUNGQSxTQUFBLENBQWdCLE1BQU1ELFNBQUEsQyxlQUFBLEUsZUFBQSxFQUNwQkYsU0FEb0IsQ0FBdEIsQ0FHQUMsU0FBQSxDQUFTRSxTQUFULEVBSkUsQ0FLRixNQUFPQyxTQUFQLENBQVUsQ0FDVkgsU0FBQSxDQUFTRyxTQUFULEVBRFUsQ0FUOEMsQ0FpRDVEQyxNQUFBLEMsZUFBQSxFQUFpQnpKLE1BQWpCIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG52YXIgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcbnZhciB3aW5zdG9uID0gcmVxdWlyZSgnLi4vLi4vLi4vLi4vY29uZmlnL3dpbnN0b24nKTtcbnZhciBQcm9qZWN0ID0gcmVxdWlyZShcIi4uLy4uLy4uLy4uL21vZGVscy9wcm9qZWN0XCIpO1xudmFyIFN1YnNjcmlwdGlvblBheW1lbnQgPSByZXF1aXJlKFwiLi4vbW9kZWxzL3N1YnNjcmlwdGlvbi1wYXltZW50XCIpO1xudmFyIG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpO1xudmFyIG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTtcbnZhciBwYXNzcG9ydCA9IHJlcXVpcmUoJ3Bhc3Nwb3J0Jyk7XG5yZXF1aXJlKCcuLi8uLi8uLi8uLi9taWRkbGV3YXJlL3Bhc3Nwb3J0JykocGFzc3BvcnQpO1xudmFyIHZhbGlkdG9rZW4gPSByZXF1aXJlKCcuLi8uLi8uLi8uLi9taWRkbGV3YXJlL3ZhbGlkLXRva2VuJylcbi8vIFNldCB5b3VyIHNlY3JldCBrZXk6IHJlbWVtYmVyIHRvIGNoYW5nZSB0aGlzIHRvIHlvdXIgbGl2ZSBzZWNyZXQga2V5IGluIHByb2R1Y3Rpb25cbi8vIFNlZSB5b3VyIGtleXMgaGVyZTogaHR0cHM6Ly9kYXNoYm9hcmQuc3RyaXBlLmNvbS9hY2NvdW50L2FwaWtleXNcbmNvbnN0IGFwaUtleSA9IHByb2Nlc3MuZW52LlBBWU1FTlRfU1RSSVBFX0FQSUtFWTtcbndpbnN0b24uZGVidWcoJ3N0cmlwZSBhcGlLZXknICsgYXBpS2V5KTtcblxuY29uc3Qgc3RyaXBlID0gcmVxdWlyZSgnc3RyaXBlJykoYXBpS2V5KTtcblxuLy8gRmluZCB5b3VyIGVuZHBvaW50J3Mgc2VjcmV0IGluIHlvdXIgRGFzaGJvYXJkJ3Mgd2ViaG9vayBzZXR0aW5nc1xuY29uc3QgZW5kcG9pbnRTZWNyZXQgPSBwcm9jZXNzLmVudi5QQVlNRU5UX1NUUklQRV9TRUNSRVQ7XG53aW5zdG9uLmRlYnVnKCdzdHJpcGUgZW5kcG9pbnRTZWNyZXQnICsgZW5kcG9pbnRTZWNyZXQpO1xuXG5jb25zdCBhcGlTZWNyZXRLZXkgPSBwcm9jZXNzLmVudi5QQVlNRU5UX1NUUklQRV9BUElfU0VDUkVUX0tFWTtcbndpbnN0b24uZGVidWcoJ3N0cmlwZSBhcGlTZWNyZXRLZXknICsgYXBpU2VjcmV0S2V5KTtcblxuY29uc3QgYm9keVBhcnNlciA9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJyk7XG5cbi8vIGh0dHBzOi8vc3RyaXBlLmNvbS9kb2NzL3BheW1lbnRzL2NoZWNrb3V0L2Z1bGZpbGxtZW50I3dlYmhvb2tzXG4vLyBjdXJsIC1YIFBPU1QgLXUgYW5kcmVhLmxlb0BmMjEuaXQ6MTIzNDU2IC1IICdDb250ZW50LVR5cGU6YXBwbGljYXRpb24vanNvbicgLWQgJ3tcInR5cGVcIjpcInBheW1lbnRfaW50ZW50LnN1Y2NlZWRlZFwifScgIGh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9tb2R1bGVzL3BheW1lbnRzL3N0cmlwZS93ZWJob29rXG5yb3V0ZXIucG9zdCgnL3dlYmhvb2snLCBib2R5UGFyc2VyLnJhdyh7IHR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyB9KSwgZnVuY3Rpb24gKHJlcXVlc3QsIHJlc3BvbnNlKSB7XG4gIFxuICB3aW5zdG9uLmRlYnVnKCfCu8K7wrvCuyBzdHJpcGUgZW5kcG9pbnRTZWNyZXQ6ICcgKyBlbmRwb2ludFNlY3JldClcbiAgd2luc3Rvbi5kZWJ1ZygnwrvCu8K7wrsgc3RyaXBlIGFwaUtleTogJyArIGFwaUtleSk7XG4gIHdpbnN0b24uZGVidWcoJ3N0cmlwZSBhcGlTZWNyZXRLZXknICsgYXBpU2VjcmV0S2V5KTtcblxuICBjb25zdCBzaWcgPSByZXF1ZXN0LmhlYWRlcnNbJ3N0cmlwZS1zaWduYXR1cmUnXTtcblxuICB3aW5zdG9uLmRlYnVnKCdzdHJpcGUgc2lnOiAnLCBzaWcpXG5cbiAgbGV0IGV2ZW50O1xuXG4gIHRyeSB7XG4gICAgZXZlbnQgPSBzdHJpcGUud2ViaG9va3MuY29uc3RydWN0RXZlbnQocmVxdWVzdC5yYXdCb2R5LCBzaWcsIGVuZHBvaW50U2VjcmV0KTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgd2luc3Rvbi5lcnJvcignKioqKiBTdHJpcGUgZXJyb3IgY29uc3RydWN0RXZlbnQ6ICcsIGVyci5tZXNzYWdlKVxuICAgIHJldHVybiByZXNwb25zZS5zdGF0dXMoNDAwKS5zZW5kKGBXZWJob29rIEVycm9yOiAke2Vyci5tZXNzYWdlfWApO1xuICB9XG5cbiAgLyoqXG4gICAqKiEgKioqIEhhbmRsZSB0aGUgY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWQgZXZlbnQgKioqXG4gICAqIE5PVEU6IFRISVMgRVZFTlQgT0NDVVIgT05MWSBXSEVOIElTIENSRUFURUQgQSBORVcgU1VCU0NSSVBUSU9OXG4gICAqIDEpIEZST00gVEhFIFBST1BFUlRZIFwiY2xpZW50X3JlZmVyZW5jZV9pZFwiIEFSRSBPQlRBSU5FRCBUSEU6XG4gICAqICAgIEEpIFVTRVIgSURcbiAgICogICAgQikgUFJPSkVDVCBJRCBcbiAgICogMikgV0lUSCBUSEUgc3Vic2NyaXB0aW9uIElEIChOT1RFIGlzIHRoZSBwcm9wZXJ0eSBzdWJzY3JpcHRpb24pIElTIFJVTk5FRCBBIENBTExCQUNLIFRPIFNUUklQRVxuICAgKiAgICBUTyBPQlRBSU4gVEhFIE9CSkVDVCBcIlNVQlNDUklQVElPTlwiIEFORCBUSEVOIEZST00gVEhJUyBBUkUgT0JUQUlORUQgVEhFOlxuICAgKiAgICBBKSBzdWJzY3JpcHRpb25TdGFydERhdGVcbiAgICogICAgQikgc3Vic2NyaXB0aW9uRW5kRGF0ZVxuICAgKiAgICBDKSBxdWFudGl0eSAod2hpY2ggaW4gdGhlIHRpbGVkZXNrIGRhc2hib2FyZCBjb3JyZXNwb25kcyB0byB0aGUgbnVtYmVyIG9mIGFnZW50cyAvIG9wZXJhdG9ycyBzZWF0cylcbiAgICogMykgV0lUSCBUSEUgT0JUQUlORUQgREFUQSBJUyBVUERBVEVEIFRIRSBQUk9KRUNUICdQUk9GSUxFJyAoaXMgYW4gb2JqZWN0IG5lc3RlZCBpbiB0aGUgcHJvamVjdCBvYmplY3QpIFxuICAgKiA0KSBUSEUgT0JUQUlORUQgT0JKRUNUIFwiU1VCU0NSSVBUSU9OXCIgQU5EIHRoZSBcIlNVQlNDUklQVElPTiBJRFwiLCB0aGUgXCJQUk9KRUNUIElEXCIsIHRoZSBcIlVTRVIgSURcIiBBTkQgc3RyaXBlX2V2ZW50OiBcImNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkXCIgQVJFIFNBVkVEIE9OIE9VUiBEQlxuICAgKiAgICBBUyBcIlNVQlNDUklQVElPTi1QQVlNRU5UXCJcbiAgICovXG5cbiAgaWYgKGV2ZW50LnR5cGUgPT09ICdjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZCcpIHtcbiAgICB3aW5zdG9uLmRlYnVnKCchISEhISEhISBISSAhISEhISEhISBjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZCcpO1xuXG4gICAgY29uc3Qgc2Vzc2lvbiA9IGV2ZW50LmRhdGEub2JqZWN0O1xuICAgIHdpbnN0b24uaW5mbygnc3RyaXBlIGNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkJywgc2Vzc2lvbik7XG5cbiAgICB2YXIgY2xpZW50X3JlZmVyZW5jZV9pZCA9IHNlc3Npb24uY2xpZW50X3JlZmVyZW5jZV9pZDtcbiAgICB3aW5zdG9uLmluZm8oJ3N0cmlwZSBjbGllbnRfcmVmZXJlbmNlX2lkJywgY2xpZW50X3JlZmVyZW5jZV9pZCk7XG5cbiAgICAvKiogMUEgKi9cbiAgICB2YXIgdXNlcl9pZCA9IGNsaWVudF9yZWZlcmVuY2VfaWQuc3BsaXQoXCJfXCIpWzBdO1xuICAgIHdpbnN0b24uaW5mbygnc3RyaXBlIHVzZXJfaWQ6JyArIHVzZXJfaWQpO1xuXG4gICAgLyoqIDFCICovXG4gICAgdmFyIHByb2plY3RfaWQgPSBjbGllbnRfcmVmZXJlbmNlX2lkLnNwbGl0KFwiX1wiKVsxXTtcbiAgICB3aW5zdG9uLmluZm8oJ3N0cmlwZSBwcm9qZWN0X2lkOiAnICsgcHJvamVjdF9pZCk7XG5cbiAgICB2YXIgcGxhbl9uYW1lID0gY2xpZW50X3JlZmVyZW5jZV9pZC5zcGxpdChcIl9cIilbMl07XG4gICAgd2luc3Rvbi5pbmZvKCdzdHJpcGUgcGxhbl9uYW1lOiAnICsgcGxhbl9uYW1lKTtcblxuICAgIHZhciBzZWF0c19udW1Bc1N0cmluZyA9IGNsaWVudF9yZWZlcmVuY2VfaWQuc3BsaXQoXCJfXCIpWzNdO1xuICAgIHdpbnN0b24uaW5mbygnc3RyaXBlIHNlYXRzX251bTogJyArIHNlYXRzX251bUFzU3RyaW5nICsgJ3R5cGVvZiAnLCB0eXBlb2Ygc2VhdHNfbnVtQXNTdHJpbmcpO1xuXG4gICAgdmFyIHNlYXRzX251bSA9IE51bWJlcihzZWF0c19udW1Bc1N0cmluZylcbiAgICB3aW5zdG9uLmluZm8oJ3N0cmlwZSBzZWF0c19udW1Bc1N0cmluZzogJyArIHNlYXRzX251bSArICcgdHlwZW9mICcsIHR5cGVvZiBzZWF0c19udW0pO1xuXG4gICAgdmFyIHN1YnNjcmlwdGlvbklkID0gZXZlbnQuZGF0YS5vYmplY3Quc3Vic2NyaXB0aW9uO1xuICAgIHdpbnN0b24uaW5mbygnKioqICoqKiAhISEhISEhISEhISEhISEhISEhISEhIGNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkIC0gc3Vic2NyaXB0aW9uIElEOiAnLCBzdWJzY3JpcHRpb25JZCk7XG5cbiAgICBnZXRTdWJzY3JpdGlvbkJ5SWQoc3Vic2NyaXB0aW9uSWQpLnRoZW4oZnVuY3Rpb24gKHN1YnNjcmlwdGlvbl9vYmopIHtcblxuICAgICAgdmFyIG9iamVjdF90eXBlID0gc3Vic2NyaXB0aW9uX29iai5vYmplY3Q7XG4gICAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWQgLSBnZXRTdWJzY3JpdGlvbkJ5SWQgc3Vic2NyIG9iamVjdF90eXBlOiAnLCBvYmplY3RfdHlwZSk7XG5cbiAgICAgIC8qKiAyQSAqL1xuICAgICAgdmFyIHN1YnNjcmlwdGlvblN0YXJ0RGF0ZSA9IG1vbWVudC51bml4KHN1YnNjcmlwdGlvbl9vYmouY3VycmVudF9wZXJpb2Rfc3RhcnQpLmZvcm1hdCgnWVlZWS1NTS1ERFRISDptbTpzcy5TU1MnKVxuICAgICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkIC0gZ2V0U3Vic2NyaXRpb25CeUlkICoqKiBzdGFydCAqKiogOiAnLCBzdWJzY3JpcHRpb25TdGFydERhdGUpO1xuXG4gICAgICAvKiogMkIgKi9cbiAgICAgIHZhciBzdWJzY3JpcHRpb25FbmREYXRlID0gbW9tZW50LnVuaXgoc3Vic2NyaXB0aW9uX29iai5jdXJyZW50X3BlcmlvZF9lbmQpLmZvcm1hdCgnWVlZWS1NTS1ERFRISDptbTpzcy5TU1MnKVxuICAgICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkIC0gZ2V0U3Vic2NyaXB0aW9uICoqKiBlbmQgKioqIDogJywgc3Vic2NyaXB0aW9uRW5kRGF0ZSk7XG5cbiAgICAgIC8qKlxuICAgICAgICohICoqKiBCT0RZICoqKlxuICAgICAgICovXG4gICAgICB2YXIgYm9keSA9IHtcbiAgICAgICAgcHJvZmlsZToge1xuICAgICAgICAgIG5hbWU6IHBsYW5fbmFtZSxcbiAgICAgICAgICB0eXBlOiAncGF5bWVudCcsXG4gICAgICAgICAgc3Vic2NyaXB0aW9uX2NyZWF0aW9uX2RhdGU6IHN1YnNjcmlwdGlvblN0YXJ0RGF0ZSxcbiAgICAgICAgICBzdWJTdGFydDogc3Vic2NyaXB0aW9uU3RhcnREYXRlLFxuICAgICAgICAgIHN1YkVuZDogc3Vic2NyaXB0aW9uRW5kRGF0ZSxcbiAgICAgICAgICBzdWJzY3JpcHRpb25JZDogc3Vic2NyaXB0aW9uSWQsXG4gICAgICAgICAgbGFzdF9zdHJpcGVfZXZlbnQ6IGV2ZW50LnR5cGUsXG4gICAgICAgICAgYWdlbnRzOiBzZWF0c19udW1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvKiogMyAqL1xuICAgICAgdXBkYXRlUHJvamVjdFByb2ZpbGUocHJvamVjdF9pZCwgYm9keSwgJ2NoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkJyk7XG5cbiAgICAgIC8qKiA0ICovXG4gICAgICBzYXZlT25EQihzdWJzY3JpcHRpb25JZCwgcHJvamVjdF9pZCwgc3Vic2NyaXB0aW9uX29iaiwgdXNlcl9pZCwgZXZlbnQudHlwZSwgcGxhbl9uYW1lLCBzZWF0c19udW0pXG5cbiAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICB3aW5zdG9uLmVycm9yKCcqKiogKioqIGNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkIC0gZ2V0U3Vic2NyaXRpb25CeUlkIGVyciAnLCBlcnIpO1xuICAgIH0pO1xuXG4gIH1cbiAgLy8gb2JqZWN0X3R5cGUgPSBzdWJzY3JpcHRpb24uXG4gIC8qKlxuICAgKiohICoqKiBIYW5kbGUgdGhlIGludm9pY2UucGF5bWVudF9zdWNjZWVkZWQgZXZlbnQgKioqXG4gICAqIE5PVEU6IFRISVMgRVZFTlQgT0NDVVIgV0hFTiBJUyBDUkVBVEVEIEEgTkVXIFNVQlNDUklQVElPTiBBTkQgRVZFUlkgVElNRSBUSEUgU0FNRSBJUyBSRU5FV0VEXG4gICAqIDEpIEZST00gVEhFIE9CSkVDVCBPRiBUSEUgRVZFTlQgQVJFIE9CVEFJTkVEIFRIRTpcbiAgICogICAgQSkgc3Vic2NyaXB0aW9uU3RhcnREYXRlXG4gICAqICAgIEIpIHN1YnNjcmlwdGlvbkVuZERhdGVcbiAgICogICAgQykgc3Vic2NyaXRwdGlvbklkICBcbiAgICogMikgd2hlbiByZWZlciB0byBhIFJFTkVXQUwgKCBiaWxsaW5nX3JlYXNvbiA9PT0gc3Vic2NyaXB0aW9uX2N5Y2xlKVxuICAgKiAgICBJRiBUSEUgVkFMVUUgT0YgVEhFIFBST1BFUlRZIFwiYmlsbGluZ19yZWFzb25cIiBJUyBVTkxJS0UgT0YgXCJzdWJzY3JpcHRpb25fY3JlYXRlXCIgKE1FQU5TIFRIQVQgVEhFIEVWRU5UIFJFRkVSIFRPIEEgUkVORVdBTCBcbiAgICogICAgRk9SIFdISUNIIGJpbGxpbmdfcmVhc29uOiBzdWJzY3JpcHRpb25fY3ljbGUgQU5EIE5PVCBUTyBUSEUgRklSU1QgU1VCU0NSSVBUSU9OKSBcbiAgICogICAgQSkgSVMgT0JUQUlORUQgVEhFICdTVUJTQ1JJUFRJT04tUEFZTUVOVCcgKHdpdGggc3RyaXBlX2V2ZW50OiBcImNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkXCIpIFNBVkVEIEFCT1ZFIEFORCBUSEVOIEZST00gVEhJUzpcbiAgICogICAgICAgLSBUSEUgXCJQUk9KRUNUIElEXCIgXG4gICAqICAgICAgIC0gVEhFIFwiVVNFUiBJRFwiXG4gICAqICAgICAgIFRPIE9CVEFJTiBUSEUgJ1NVQlNDUklQVElPTi1QQVlNRU5UJ0lOIE9VUiBEQiBJUyBMT09LRUQgRk9SIFRIRSBcIlNVQlNDUklQSU9OLVBBWU1FTlRcIiBUSEFUIEhBUyBGT1Igc3Vic2NyaXB0aW9uIGlkIFRIRSBWQUxVRSBPRiAxQyBBTkQgc3RyaXBlX2V2ZW50OiBcImNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkXCJcbiAgICogICAgICAgVEhFIENPTkRJVElPTiBzdHJpcGVfZXZlbnQ6IFwiY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWRcIiAoTk8gTU9SRTogb2JqZWN0X3R5cGUgPSBzdWJzY3JpcHRpb24pIElUJ1MgTkVDRVNTQVJZIFRPIEZJTFRFUiBUSEUgXCJTVUJTQ1JJUElPTi1QQVlNRU5UU1wiIFxuICAgKiAgICAgICBUSEFUIENPTlRBSU4gVEhFICBQUk9QRVJUSUVTICBcInByb2plY3RJRFwiIEFORCBcInVzZXJJRFwiXG4gICAqICAgICAgIFRIRSBFWElTVEVOQ0UgT0YgQSBcIlNVQlNDUklQVElPTi1QQVlNRU5UXCIgV0lUSE9VVCBcInByb2plY3RJRFwiIEFORCBcInVzZXJJRFwiIElTIERVRSBUTyBUSEUgRkFDVCBUSEFUIEFUIFRIRSBNT01FTlQgT0YgVEhFIENSRUFUSU9OIE9GIEEgU1VCU0NSSVBUSU9OIFxuICAgKiAgICAgICBJUyBTQVZFRCBJTiBPVVIgREIgQUxTTyBBIFwiU1VCU0NSSVBUSU9OLVBBWU1FTlRcIiBDT1JSRVNQT05ESU5HIFRPIFRIRSBPQkpFQ1QgUkVUVVJORUQgQlkgIFRIRSBFVkVOVCBcImludm9pY2UucGF5bWVudF9zdWNjZWVkZWRcIiBVU0VGVUwgQkVDQVVTRSBcbiAgICogICAgICAgSVQgQ09OVEFJTlMgVEhFIExJTktTIE9GIFRIRSBJTlZPSUNFIE9GIFRIRSBGSVJTVCBTVUJTQ1JJUFRJT04gKHVzZWQgYnkgdGlsZWRlc2sgZGFzaGJvYXJkIGluIHRoZSBjb21wb25lbnRzIHBheW1lbnRzKVxuICAgKiAgICAgICBCVVQgRlJPTSBXSElDSCBJVCBJUyBOT1QgUE9TU0lCTEUgUFVTSCBBTkQgVEhFTiBUTyBUTyBPQlRBSU4gVEhFIFwicHJvamVjdElEXCIgQU5EIFwidXNlcklEXCJcbiAgICogICAgQikgSVMgVVBEQVRFRCBUSEUgUFJPSkVDVCAnUFJPRklMRScgV0lUSDpcbiAgICogICAgICAgLSBEQVRBIE9CVEFJTkVEIEZST00gVEhFIEVWRU5UJ1MgT0JKRUNUOlxuICAgKiAgICAgICAgIC0gc3Vic2NyaXB0aW9uU3RhcnREYXRlXG4gICAqICAgICAgICAgLSBzdWJzY3JpcHRpb25FbmREYXRlXG4gICAqICAgICAgICAgLSBzdWJzY3JpcHRpb25JZCBcbiAgICogICAgICAgICAtIGxhc3Rfc3RyaXBlX2V2ZW50IFxuICAgKiAgICAgICAgIC0gcXVhbnRpdHkgKHdoaWNoIGluIHRoZSBkYXNoYm9hcmQgY29ycmVzcG9uZHMgdG8gdGhlIG51bWJlciBvZiBhZ2VudHMgLyBvcGVyYXRvcnMgc2VhdHMpXG4gICAqICAgICAgIC0gREFUQSBPQlRBSU5FRCBGUk9NIFRIRSAnU1VCU0NSSVBUSU9OLVBBWU1FTlQnIHdpdGggc3RyaXBlX2V2ZW50OiBcImNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkXCJcbiAgICogICAgICAgICAtIFwiUFJPSkVDVCBJRFwiIGFuZCBcIlVTRVIgSURcIlxuICAgKiAgICBDKSBUSEUgT0JKRUNUIE9GIFRIRSBFVkVOVCBpbnZvaWNlLnBheW1lbnRfc3VjY2VlZGVkIEFORCB0aGUgXCJTVUJTQ1JJUFRJT04gSURcIiwgdGhlIFwiUFJPSkVDVCBJRFwiLCB0aGUgXCJVU0VSIElEXCIgQU5EIHRoZSBcIk9CSkVDVF9UWVBFXCIgKGV2ZW50KSBcbiAgICogICAgICAgQVJFIFNBVkVEIEFTIFwiU1VCU0NSSVBUSU9OLVBBWU1FTlRcIiBPTiBPVVIgREJcbiAgICogMykgd2hlbiByZWZlciB0byBhIENSRUFUSU9OIChiaWxsaW5nX3JlYXNvbiA9PT0gc3Vic2NyaXB0aW9uX2NyZWF0ZSlcbiAgICogICAgQSkgVEhFIE9CSkVDVCBPRiBUSEUgRVZFTlQgaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCBBTkQgVEhFIERBVEEgZXZlbnQudHlwZSA9PT0gaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCAgQVJFIFNBVkVEIEFTIFwiU1VCU0NSSVBUSU9OLVBBWU1FTlRcIlxuICAgKiAgICAgICBPTiBPVVIgREIgKE5PVEU6IFwiUFJPSkVDVCBJRFwiIEFORCBcIlVTRVIgSURcIiBBUkUgU0FWRUQgQVMgbnVsbCBTSU5DRSBJUyBOT1QgUE9TU0lCTEUgVE8gUkVUUklFVkUgVEhFIFZBTFVFUykgXG4gICAqIFxuICAgKi9cbiAgaWYgKGV2ZW50LnR5cGUgPT09ICdpbnZvaWNlLnBheW1lbnRfc3VjY2VlZGVkJykge1xuXG4gICAgd2luc3Rvbi5pbmZvKCcgISEhISEhISEgSEkgISEhISEhISEgaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCcpO1xuICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBpbnZvaWNlLnBheW1lbnRfc3VjY2VlZGVkIC0gQklMTElORyBSRUFTT04gJywgZXZlbnQuZGF0YS5vYmplY3QuYmlsbGluZ19yZWFzb24pO1xuXG4gICAgdmFyIGxpbmVzTnVtID0gZXZlbnQuZGF0YS5vYmplY3QubGluZXMudG90YWxfY291bnRcbiAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCAtIGxpbmVzTnVtOiAnLCBsaW5lc051bSk7XG5cbiAgICB2YXIgaW5kZXggPSBsaW5lc051bSAtIDE7XG4gICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGludm9pY2UucGF5bWVudF9zdWNjZWVkZWQgLSBpbmRleDogJywgaW5kZXgpO1xuXG4gICAgLyoqIDFBICovIC8vIFRISVMgV09SS1NcbiAgICB2YXIgc3Vic2NyaXB0aW9uU3RhcnREYXRlID0gbW9tZW50LnVuaXgoZXZlbnQuZGF0YS5vYmplY3QubGluZXMuZGF0YVtpbmRleF0ucGVyaW9kLnN0YXJ0KS5mb3JtYXQoJ1lZWVktTU0tRERUSEg6bW06c3MuU1NTJylcbiAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCAtIHN0YXJ0OiAnLCBzdWJzY3JpcHRpb25TdGFydERhdGUpO1xuXG4gICAgLyoqIDFCICovIC8vIFRISVMgV09SS1NcbiAgICB2YXIgc3Vic2NyaXB0aW9uRW5kRGF0ZSA9IG1vbWVudC51bml4KGV2ZW50LmRhdGEub2JqZWN0LmxpbmVzLmRhdGFbaW5kZXhdLnBlcmlvZC5lbmQpLmZvcm1hdCgnWVlZWS1NTS1ERFRISDptbTpzcy5TU1MnKVxuICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBpbnZvaWNlLnBheW1lbnRfc3VjY2VlZGVkIC0gZW5kOiAnLCBzdWJzY3JpcHRpb25FbmREYXRlKTtcblxuICAgIHZhciBzdWJzY3JpcHRpb25JZCA9IGV2ZW50LmRhdGEub2JqZWN0LnN1YnNjcmlwdGlvbjtcbiAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCAtIHN1YnNjcmlwdGlvbiBJRDogJywgc3Vic2NyaXB0aW9uSWQpO1xuXG4gICAgaWYgKHN1YnNjcmlwdGlvbklkID09IG51bGwpIHtcbiAgICAgIHN1YnNjcmlwdGlvbklkID0gZXZlbnQuZGF0YS5vYmplY3QubGluZXMuZGF0YVswXS5zdWJzY3JpcHRpb247XG4gICAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogaW52b2ljZS5wYXltZW50X3N1Y2NlZWRlZCAtIHN1YnNjcmlwdGlvbiBJRDogJywgc3Vic2NyaXB0aW9uSWQpO1xuICAgIH1cblxuICAgIGlmIChldmVudC5kYXRhLm9iamVjdC5iaWxsaW5nX3JlYXNvbiAhPT0gJ3N1YnNjcmlwdGlvbl9jcmVhdGUnKSB7XG5cblxuICAgICAgLy8gVE8gVEVTVCBUSEUgUkVORVdBTCBVTkNPTU1FTlQgU0VUIFRJTUVPVVRcbiAgICAgIC8vIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgLyoqIDJBICovXG4gICAgICBnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudChzdWJzY3JpcHRpb25JZCkudGhlbihmdW5jdGlvbiAoc3Vic3B0bl9wYXltZW50KSB7XG4gICAgICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudCBzdWJzcHRuX3BheW1lbnQ6ICcsIHN1YnNwdG5fcGF5bWVudCk7XG4gICAgICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudCBzdWJzcHRuX3BheW1lbnQgdHlwZW9mIHN1YnNwdG5fcGF5bWVudDogJywgdHlwZW9mIHN1YnNwdG5fcGF5bWVudCk7XG4gICAgICAgIGlmIChzdWJzcHRuX3BheW1lbnQpIHtcblxuICAgICAgICAgIHZhciBwcm9qZWN0SWQgPSBzdWJzcHRuX3BheW1lbnQucHJvamVjdF9pZFxuICAgICAgICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudCBzdWJzcHRuX3BheW1lbnQgPiBwcm9qZWN0X2lkOiAnLCBwcm9qZWN0SWQpO1xuXG4gICAgICAgICAgUHJvamVjdC5maW5kT25lKHsgX2lkOiBwcm9qZWN0SWQgfSwgZnVuY3Rpb24gKGVyciwgcHJvamVjdCkge1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQgIGZpbmQgUHJvamVjdCAnLCBlcnIpO1xuICAgICAgICAgICAgICByZXR1cm4gKGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocHJvamVjdCkge1xuICAgICAgICAgICAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQgIHByb2plY3QgJywgcHJvamVjdCk7XG4gICAgICAgICAgICAgIHdpbnN0b24uaW5mbygnKioqICoqKiBnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudCAgcHJvamVjdCA+IHByb2ZpbGUnLCBwcm9qZWN0LnByb2ZpbGUpO1xuXG4gICAgICAgICAgICAgIHZhciBzZWF0c19udW0gPSBwcm9qZWN0LnByb2ZpbGUuYWdlbnRzO1xuICAgICAgICAgICAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQgIHByb2plY3QgPiBwcm9maWxlID4gYWdlbnRzJywgc2VhdHNfbnVtKTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIHZhciBwbGFuX25hbWUgPSBwcm9qZWN0LnByb2ZpbGUubmFtZTtcbiAgICAgICAgICAgICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIGdldFN1YkJ5SWRBbmRDaGVja291dFNlc3Npb25Db21wbGV0ZWRFdm50ICBwcm9qZWN0ID4gcHJvZmlsZSA+IGFnZW50cyB0eXBlb2YnLCB0eXBlb2Ygc2VhdHNfbnVtKTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIHZhciB1c2VySWQgPSBzdWJzcHRuX3BheW1lbnQudXNlcl9pZFxuICAgICAgICAgICAgICB3aW5zdG9uLmluZm8oJyoqKiAqKiogZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQgIHByb2plY3QgPiBwcm9maWxlID4gbmFtZScsIHBsYW5fbmFtZSk7XG5cbiAgICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgICAgLy8gIEJPRFkgXG4gICAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICAgIHZhciBib2R5ID0ge1xuICAgICAgICAgICAgICAgIHByb2ZpbGU6IHtcbiAgICAgICAgICAgICAgICAgIG5hbWU6IHBsYW5fbmFtZSxcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICdwYXltZW50JyxcbiAgICAgICAgICAgICAgICAgIHN1YlN0YXJ0OiBzdWJzY3JpcHRpb25TdGFydERhdGUsXG4gICAgICAgICAgICAgICAgICBzdWJFbmQ6IHN1YnNjcmlwdGlvbkVuZERhdGUsXG4gICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25JZDogc3Vic2NyaXB0aW9uSWQsXG4gICAgICAgICAgICAgICAgICBsYXN0X3N0cmlwZV9ldmVudDogZXZlbnQudHlwZSxcbiAgICAgICAgICAgICAgICAgIGFnZW50czogc2VhdHNfbnVtXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgLyoqIDJCICovXG4gICAgICAgICAgICAgIHVwZGF0ZVByb2plY3RQcm9maWxlKHByb2plY3RJZCwgYm9keSwgJ2ludm9pY2UucGF5bWVudF9zdWNjZWVkZWQnKTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIC8qKiAyQyAqL1xuICAgICAgICAgICAgICBzYXZlT25EQihzdWJzY3JpcHRpb25JZCwgcHJvamVjdElkLCBldmVudCwgdXNlcklkLCBldmVudC50eXBlLCBwbGFuX25hbWUsIHNlYXRzX251bSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIHdpbnN0b24uZXJyb3IoJyoqKiAqKiogZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQgLSBlcnIgJywgZXJyKTtcbiAgICAgIH0pO1xuICAgICAgLy8gfSwgNTAwMCk7XG4gICAgfVxuXG4gIH1cblxuICAvKipcbiAgICoqISAqKiogSEFORExFIFRIRSBFVkVOVCBjdXN0b21lci5zdWJzY3JpcHRpb24uZGVsZXRlZCAqKipcbiAgICogdGhpcyBldmVudCBvY2N1cnMgd2hlbiBhIHN1YnNjcmlwdGlvbiBpcyBjYW5jZWxsZWRcbiAgICogLSBmcm9tIHRoZSBUSUxFREVTSycgZGFzaGJvYXJkIChieSBjbGlja2luZyBDQU5DRUwgU1VCU0NSSVBUSU9OIHRoYXQgY2FsbCBjYW5jZWxzdWJzY3JpcHRpb24oKSAtIHNlZSBiZWxvdylcbiAgICogLSBmcm9tIHRoZSBTVFJJUEUnIGRhc2hib2FyZFxuICAgKi9cbiAgaWYgKGV2ZW50LnR5cGUgPT09ICdjdXN0b21lci5zdWJzY3JpcHRpb24uZGVsZXRlZCcpIHtcbiAgICB3aW5zdG9uLmluZm8oJyAhISEhISEhISBISSAhISEhISEhISEhISBjdXN0b21lci5zdWJzY3JpcHRpb24uZGVsZXRlZCcpO1xuICAgIHdpbnN0b24uaW5mbygnY3VzdG9tZXIuc3Vic2NyaXB0aW9uLmRlbGV0ZWQgZXZlbnQgJywgZXZlbnQpO1xuICAgIHZhciBzdWJzY3JpcHRpb25JZCA9IGV2ZW50LmRhdGEub2JqZWN0LmlkXG4gICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIHN1YnNjcmlwdGlvbiBJRCAnLCBzdWJzY3JpcHRpb25JZCk7XG5cbiAgICBnZXRTdWJCeUlkQW5kQ2hlY2tvdXRTZXNzaW9uQ29tcGxldGVkRXZudChzdWJzY3JpcHRpb25JZCkudGhlbihmdW5jdGlvbiAoc3Vic2NyaXB0aW9uUGF5bWVudCkge1xuICAgICAgLy8gU3Vic2NyaXB0aW9uUGF5bWVudC5maW5kKHsgc3Vic2NyaXB0aW9uX2lkOiBzdWJzY3JpcHRpb25JZCwgb2JqZWN0X3R5cGU6IFwic3Vic2NyaXB0aW9uXCIgfSwgZnVuY3Rpb24gKGVyciwgc3Vic2NyaXB0aW9uUGF5bWVudCkge1xuXG4gICAgICAvLyBpZiAoZXJyKSB7XG4gICAgICAvLyAgIHdpbnN0b24uaW5mbygnRXJyb3IgZ2V0dGluZyB0aGUgc3Vic2NyaXB0aW9uUGF5bWVudCAnLCBlcnIpO1xuICAgICAgLy8gICByZXR1cm4gZXJyO1xuICAgICAgLy8gfVxuICAgICAgd2luc3Rvbi5pbmZvKCcqKiogKioqIMK7wrvCuyDCu8K7wrsgY3VzdG9tZXIuc3Vic2NyaXB0aW9uLmRlbGV0ZWQgc3Vic2NyaXB0aW9uUGF5bWVudCAnLCBzdWJzY3JpcHRpb25QYXltZW50KTtcbiAgICAgIGlmIChzdWJzY3JpcHRpb25QYXltZW50KSB7IFxuICAgICAgICB2YXIgcHJvamVjdElkID0gc3Vic2NyaXB0aW9uUGF5bWVudC5wcm9qZWN0X2lkOyBcbiAgICAgICAgd2luc3Rvbi5pbmZvKCdjdXN0b21lci5zdWJzY3JpcHRpb24uZGVsZXRlZCBzdWJzY3JpcHRpb25QYXltZW50IHByb2plY3QgaWQ6ICcsIHByb2plY3RJZClcbiAgICAgICAgXG4gICAgICAgIHZhciB1c2VySWQgPSBzdWJzY3JpcHRpb25QYXltZW50LnVzZXJfaWQ7XG4gICAgICAgIHdpbnN0b24uaW5mbygnY3VzdG9tZXIuc3Vic2NyaXB0aW9uLmRlbGV0ZWQgc3Vic2NyaXB0aW9uUGF5bWVudCB1c2VyIGlkOiAnLCB1c2VySWQpXG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICohICoqKiBCT0RZICoqKlxuICAgICAgICovXG4gICAgICB2YXIgYm9keSA9IHtcbiAgICAgICAgcHJvZmlsZToge1xuICAgICAgICAgIHN1YnNjcmlwdGlvbklkOiBzdWJzY3JpcHRpb25JZCxcbiAgICAgICAgICBuYW1lOiAnU2FuZGJveCcsXG4gICAgICAgICAgdHlwZTogJ2ZyZWUnLFxuICAgICAgICAgIGFnZW50czogMSxcbiAgICAgICAgICBsYXN0X3N0cmlwZV9ldmVudDogZXZlbnQudHlwZVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIHVwZGF0ZVByb2plY3RQcm9maWxlKHByb2plY3RJZCwgYm9keSwgJ3N1YnNjcmlwdGlvbi5kZWxldGVkJyk7XG4gICAgICBzYXZlT25EQihzdWJzY3JpcHRpb25JZCwgcHJvamVjdElkLCBldmVudC5kYXRhLm9iamVjdCwgdXNlcklkLCBldmVudC50eXBlLCBwbGFuX25hbWUsIDEpO1xuXG4gICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgd2luc3Rvbi5lcnJvcignKioqICoqKiBjdXN0b21lci5zdWJzY3JpcHRpb24uZGVsZXRlZCAnLCBlcnIpO1xuICAgIH0pO1xuXG4gIH1cbiAgLy8gUmV0dXJuIGEgcmVzcG9uc2UgdG8gYWNrbm93bGVkZ2UgcmVjZWlwdCBvZiB0aGUgZXZlbnRcbiAgcmVzcG9uc2UuanNvbih7IHJlY2VpdmVkOiB0cnVlIH0pO1xufSk7XG5cblxuZnVuY3Rpb24gZ2V0U3ViQnlJZEFuZENoZWNrb3V0U2Vzc2lvbkNvbXBsZXRlZEV2bnQoc3Vic2NyaXB0aW9uaWQpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICBTdWJzY3JpcHRpb25QYXltZW50LmZpbmRPbmUoeyBzdWJzY3JpcHRpb25faWQ6IHN1YnNjcmlwdGlvbmlkLCBzdHJpcGVfZXZlbnQ6IFwiY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWRcIiB9LCBmdW5jdGlvbiAoZXJyLCBzdWJzY3JpcHRpb25QYXltZW50KSB7XG4gICAgICBpZiAoZXJyKSByZWplY3QoZXJyKTtcblxuICAgICAgdmFyIHN1YnNjcmlwdGlvbl9wYXltZW50ID0gc3Vic2NyaXB0aW9uUGF5bWVudDtcbiAgICAgIHJlc29sdmUoc3Vic2NyaXB0aW9uX3BheW1lbnQpO1xuICAgIH0pO1xuICB9KVxufTtcblxuZnVuY3Rpb24gZ2V0U3Vic2NyaXRpb25CeUlkKHN1YnNjcmlwdGlvbmlkKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgY29uc3QgX3N0cmlwZSA9IHJlcXVpcmUoXCJzdHJpcGVcIikoYXBpU2VjcmV0S2V5KTtcbiAgICBfc3RyaXBlLnN1YnNjcmlwdGlvbnMucmV0cmlldmUoc3Vic2NyaXB0aW9uaWQsIGZ1bmN0aW9uIChlcnIsIHN1YnNjcmlwdGlvbikge1xuICAgICAgaWYgKGVycikgcmVqZWN0KGVycik7XG5cbiAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBzdWJzY3JpcHRpb247XG4gICAgICByZXNvbHZlKHN1YnNjcmlwdGlvbik7XG4gICAgfSk7XG4gIH0pXG59O1xuXG4vLyBTRUUgVXBkYXRpbmcgbmVzdGVkIG9iamVjdCBpbiBtb25nb29zZSBcbi8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzIzODMyOTIxL3VwZGF0aW5nLW5lc3RlZC1vYmplY3QtaW4tbW9uZ29vc2VcbmZ1bmN0aW9uIHVwZGF0ZVByb2plY3RQcm9maWxlKHByb2plY3RfaWQsIGJvZHksIGNhbGxlZEJ5KSB7XG4gIFByb2plY3QuZmluZEJ5SWRBbmRVcGRhdGUocHJvamVjdF9pZCwgYm9keSwgeyBuZXc6IHRydWUsIHVwc2VydDogdHJ1ZSB9LCBmdW5jdGlvbiAoZXJyLCB1cGRhdGVkUHJvamVjdCkge1xuICAgIGlmIChlcnIpIHtcbiAgICAgIHdpbnN0b24uZXJyb3IoJ3VwZGF0ZVByb2plY3RQcm9maWxlIEVycm9yICcsIGVycik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdpbnN0b24uZGVidWcodXBkYXRlZFByb2plY3QpXG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gc2F2ZU9uREIoc3Vic2NyaXB0aW9uaWQsIHByb2plY3RpZCwgb2JqLCB1c2VyaWQsIHN0cmlwZV9ldmVudCwgcGxhbl9uYW1lLCBzZWF0c19udW0pIHtcbiAgd2luc3Rvbi5pbmZvKCdzYXZlT25EQiBwbGFuX25hbWUnLCBwbGFuX25hbWUpXG4gIHdpbnN0b24uaW5mbygnc2F2ZU9uREIgc2VhdHNfbnVtJywgc2VhdHNfbnVtKVxuXG4gIHZhciBuZXdQYXltZW50U3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvblBheW1lbnQoe1xuICAgIF9pZDogbmV3IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKCksXG4gICAgc3Vic2NyaXB0aW9uX2lkOiBzdWJzY3JpcHRpb25pZCxcbiAgICBwcm9qZWN0X2lkOiBwcm9qZWN0aWQsXG4gICAgdXNlcl9pZDogdXNlcmlkLFxuICAgIHN0cmlwZV9ldmVudDogc3RyaXBlX2V2ZW50LFxuICAgIHBsYW5fbmFtZTogcGxhbl9uYW1lLFxuICAgIGFnZW50czogc2VhdHNfbnVtLFxuICAgIG9iamVjdDogb2JqXG4gIH0pO1xuXG4gIG5ld1BheW1lbnRTdWJzY3JpcHRpb24uc2F2ZShmdW5jdGlvbiAoZXJyLCBzYXZlZFN1YnNjcmlwdGlvblBheW1lbnQpIHtcbiAgICBpZiAoZXJyKSB7XG4gICAgICB3aW5zdG9uLmVycm9yKCctLS0gPiBFUlJPUiAnLCBlcnIpXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoeyBzdWNjZXNzOiBmYWxzZSwgbXNnOiAnRXJyb3Igc2F2aW5nIG9iamVjdC4nIH0pO1xuICAgIH1cbiAgICB3aW5zdG9uLmluZm8oJ3NhdmVkU3Vic2NyaXB0aW9uUGF5bWVudCAnLCBzYXZlZFN1YnNjcmlwdGlvblBheW1lbnQpO1xuICB9KTtcbn1cblxucm91dGVyLnB1dCgnL2NhbmNlbHN1YnNjcmlwdGlvbicsIFtwYXNzcG9ydC5hdXRoZW50aWNhdGUoWydiYXNpYycsICdqd3QnXSwgeyBzZXNzaW9uOiBmYWxzZSB9KSwgdmFsaWR0b2tlbl0sIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuICB2YXIgcHJvamVjdGlkID0gcmVxLmJvZHkucHJvamVjdGlkXG4gIHZhciB1c2VyaWQgPSByZXEuYm9keS51c2VyaWRcbiAgd2luc3Rvbi5pbmZvKCfCu8K7wrsgwrvCu8K7IGNhbmNlbHN1YnNjcmlwdGlvbiBwcm9qZWN0aWQnLCBwcm9qZWN0aWQpO1xuICB3aW5zdG9uLmluZm8oJ8K7wrvCuyDCu8K7wrsgY2FuY2Vsc3Vic2NyaXB0aW9uIHVzZXJpZCcsIHVzZXJpZCk7XG5cbiAgUHJvamVjdC5maW5kT25lKHsgX2lkOiBwcm9qZWN0aWQgfSwgZnVuY3Rpb24gKGVyciwgcHJvamVjdCkge1xuICAgIGlmIChlcnIpIHtcbiAgICAgIHdpbnN0b24uZXJyb3IoJy0tID4gY2FuY2Vsc3Vic2NyaXB0aW9uIEVycm9yIGdldHRpbmcgcHJvamVjdCAnLCBlcnIpXG4gICAgICByZXR1cm4gKGVycik7XG4gICAgfVxuICAgIGlmIChwcm9qZWN0KSB7XG4gICAgICB3aW5zdG9uLmluZm8oJy0tID4gY2FuY2Vsc3Vic2NyaXB0aW9uICBwcm9qZWN0ICcsIHByb2plY3QpO1xuXG4gICAgICB2YXIgc3Vic2NyaXB0aW9uaWQgPSBwcm9qZWN0LnByb2ZpbGUuc3Vic2NyaXB0aW9uSWQ7XG5cbiAgICAgIGNvbnN0IHN0cmlwZSA9IHJlcXVpcmUoXCJzdHJpcGVcIikoYXBpU2VjcmV0S2V5KTtcblxuICAgICAgc3RyaXBlLnN1YnNjcmlwdGlvbnMuZGVsKHN1YnNjcmlwdGlvbmlkLCBmdW5jdGlvbiAoZXJyLCBjb25maXJtYXRpb24pIHtcbiAgICAgICAgLy8gYXN5bmNocm9ub3VzbHkgY2FsbGVkXG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICB3aW5zdG9uLmVycm9yKCctLSA+IGNhbmNlbHN1YnNjcmlwdGlvbiAgZXJyICcsIGVycik7XG4gICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgc3VjY2VzczogZmFsc2UsIG1zZzogZXJyIH0pXG4gICAgICAgIH1cbiAgICAgICAgd2luc3Rvbi5pbmZvKCctLSA+IGNhbmNlbHN1YnNjcmlwdGlvbiBjb25maXJtYXRpb24gJywgY29uZmlybWF0aW9uKVxuICAgICAgICByZXMuanNvbihjb25maXJtYXRpb24pO1xuICAgICAgfSk7XG4gICAgfVxuICB9KVxufSk7XG5cbnJvdXRlci5wdXQoJy91cGRhdGVzdWJzY3JpcHRpb24nLCBbcGFzc3BvcnQuYXV0aGVudGljYXRlKFsnYmFzaWMnLCAnand0J10sIHsgc2Vzc2lvbjogZmFsc2UgfSksIHZhbGlkdG9rZW5dLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcblxuICB2YXIgcHJvamVjdGlkID0gcmVxLmJvZHkucHJvamVjdGlkXG4gIHZhciB1c2VyaWQgPSByZXEuYm9keS51c2VyaWRcbiAgdmFyIHByaWNlID0gcmVxLmJvZHkucHJpY2VcbiAgd2luc3Rvbi5pbmZvKCfCu8K7wrsgwrvCu8K7IHVwZGF0ZXN1YnNjcmlwdGlvbiBwcm9qZWN0aWQnLCBwcm9qZWN0aWQpO1xuICB3aW5zdG9uLmluZm8oJ8K7wrvCuyDCu8K7wrsgdXBkYXRlc3Vic2NyaXB0aW9uIHVzZXJpZCcsIHVzZXJpZCk7XG4gIHdpbnN0b24uaW5mbygnwrvCu8K7IMK7wrvCuyB1cGRhdGVzdWJzY3JpcHRpb24gcHJpY2UnLCBwcmljZSk7XG4gIGNvbnN0IHN0cmlwZSA9IHJlcXVpcmUoXCJzdHJpcGVcIikoYXBpU2VjcmV0S2V5KTtcblxuICBQcm9qZWN0LmZpbmRPbmUoeyBfaWQ6IHByb2plY3RpZCB9LCBmdW5jdGlvbiAoZXJyLCBwcm9qZWN0KSB7XG4gICAgaWYgKGVycikge1xuICAgICAgd2luc3Rvbi5lcnJvcignLS0gPiB1cGRhdGVzdWJzY3JpcHRpb24gRXJyb3IgZ2V0dGluZyBwcm9qZWN0ICcsIGVycilcbiAgICAgIHJldHVybiAoZXJyKTtcbiAgICB9XG4gICAgaWYgKHByb2plY3QpIHtcbiAgICAgIHdpbnN0b24uaW5mbygnLS0gPiB1cGRhdGVzdWJzY3JpcHRpb24gIHByb2plY3QgJywgcHJvamVjdCk7XG5cbiAgICAgIHZhciBzdWJzY3JpcHRpb25pZCA9IHByb2plY3QucHJvZmlsZS5zdWJzY3JpcHRpb25JZDtcblxuICAgICAgLy8gc3Vic2NyaXB0aW9uaWRcbiAgICAgIHN0cmlwZS5zdWJzY3JpcHRpb25zLnVwZGF0ZShcbiAgICAgICAgc3Vic2NyaXB0aW9uaWQsXG4gICAgICAgIC8vIHsgdHJpYWxfZW5kOiAxNTY4MjEwNjU1IH0sXG4gICAgICAgIC8vIGZ1bmN0aW9uIChlcnIsIHN1YnNjcmlwdGlvbikge1xuICAgICAgICAvLyAgIC8vIGFzeW5jaHJvbm91c2x5IGNhbGxlZFxuICAgICAgICAvLyAgIGlmIChlcnIpIHtcbiAgICAgICAgLy8gICAgIHdpbnN0b24uZXJyb3IoJ3VwZGF0ZXN1YnNjcmlwdGlvbiBzdWJzY3JpcHRpb24gZXJyICcsIGVycilcbiAgICAgICAgLy8gICAgIHJldHVyblxuICAgICAgICAvLyAgIH1cbiAgICAgICAgLy8gICB3aW5zdG9uLmluZm8oJ3VwZGF0ZXN1YnNjcmlwdGlvbiBzdWJzY3JpcHRpb24gJywgc3Vic2NyaXB0aW9uKVxuICAgICAgICAvLyB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIHN0cmlwZS5zdWJzY3JpcHRpb25zLnJldHJpZXZlKHN1YnNjcmlwdGlvbmlkLCBmdW5jdGlvbiAoZXJyLCBzdWJzY3JpcHRpb24pIHtcbiAgICAvLyAgIC8vIGFzeW5jaHJvbm91c2x5IGNhbGxlZFxuICAgIC8vICAgaWYgKGVycikge1xuICAgIC8vICAgICB3aW5zdG9uLmluZm8oJ3JldHJpZXZlIHVwZGF0ZWQgc3Vic2NyaXB0aW9uIGVyciAnLCBlcnIpXG4gICAgLy8gICB9IGVsc2Uge1xuICAgIC8vICAgICB3aW5zdG9uLmluZm8oJ8K7wrvCu8K7wrvCu8K7wrvCuyBncmV0cmlldmUgdXBkYXRlZCBzdWJzY3JpcHRpb246ICcsIHN1YnNjcmlwdGlvbik7XG5cbiAgICAvLyAgIH1cbiAgICAvLyB9KVxuICB9KVxuXG59KVxuXG5yb3V0ZXIuZ2V0KCcvOnN1YnNjcmlwdGlvbmlkJywgW3Bhc3Nwb3J0LmF1dGhlbnRpY2F0ZShbJ2Jhc2ljJywgJ2p3dCddLCB7IHNlc3Npb246IGZhbHNlIH0pLCB2YWxpZHRva2VuXSwgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG5cbiAgU3Vic2NyaXB0aW9uUGF5bWVudC5maW5kKHsgc3Vic2NyaXB0aW9uX2lkOiByZXEucGFyYW1zLnN1YnNjcmlwdGlvbmlkIH0pLnNvcnQoeyAnb2JqZWN0LmNyZWF0ZWQnOiBcImFzY1wiIH0pLmV4ZWMoZnVuY3Rpb24gKGVyciwgc3Vic2NyaXB0aW9uUGF5bWVudHMpIHtcbiAgICBpZiAoZXJyKSB7XG4gICAgICB3aW5zdG9uLmVycm9yKCctLSA+IEdFVCBTVUJTQ1JJUFRJT04gUEFZTUVOVFMgRVJST1J0ICcsIHByb2plY3QpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgc3VjY2VzczogZmFsc2UsIG1zZzogZXJyIH0pXG4gICAgfVxuICAgIHJlcy5qc29uKHN1YnNjcmlwdGlvblBheW1lbnRzKTtcbiAgfSk7XG5cbn0pO1xuXG4vLyAgUkVUUklFVkUgVEhFIENVUlJFTlQgU1VCU0NSSVBUSU9OIEZST00gU1RSSVBFXG5yb3V0ZXIuZ2V0KCcvc3RyaXBlc3Vicy86c3Vic2NyaXB0aW9uaWQnLCBbcGFzc3BvcnQuYXV0aGVudGljYXRlKFsnYmFzaWMnLCAnand0J10sIHsgc2Vzc2lvbjogZmFsc2UgfSksIHZhbGlkdG9rZW5dLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcblxuICB3aW5zdG9uLmluZm8oJy0tID4gc3Vic2NyaXB0aW9uIGdldCBieSBpZCBmcmVxLnBhcmFtcy5zdWJzY3JpcHRpb25pZCAnLCByZXEucGFyYW1zLnN1YnNjcmlwdGlvbmlkKTtcbiAgdmFyIHN0cmlwZSA9IHJlcXVpcmUoJ3N0cmlwZScpKGFwaVNlY3JldEtleSk7XG5cbiAgc3RyaXBlLnN1YnNjcmlwdGlvbnMucmV0cmlldmUoXG4gICAgcmVxLnBhcmFtcy5zdWJzY3JpcHRpb25pZCxcbiAgICBmdW5jdGlvbiAoZXJyLCBzdWJzY3JpcHRpb24pIHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgd2luc3Rvbi5lcnJvcignLS0gPiBzdWJzY3JpcHRpb24gZ2V0IGJ5IGlkIGZyb20gc3RyaXBlICBlcnIgJywgZXJyKTtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgc3VjY2VzczogZmFsc2UsIG1zZzogZXJyIH0pXG4gICAgICB9XG4gICAgICB3aW5zdG9uLmluZm8oJy0tID4gc3Vic2NyaXB0aW9uIGdldCBieSBpZCBmcm9tIHN0cmlwZSAnLCBzdWJzY3JpcHRpb24pXG4gICAgICByZXMuanNvbihzdWJzY3JpcHRpb24pO1xuICAgIH1cbiAgKTtcbn0pO1xuXG4vLyAgUkVUUklFVkUgVEhFIENIRUNLT1VUIFNFU1NJT05cbnJvdXRlci5nZXQoJy9jaGVja291dFNlc3Npb24vOnNlc3Npb25pZCcsIFtwYXNzcG9ydC5hdXRoZW50aWNhdGUoWydiYXNpYycsICdqd3QnXSwgeyBzZXNzaW9uOiBmYWxzZSB9KSwgdmFsaWR0b2tlbl0sIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuXG4gIHdpbnN0b24uaW5mbygnLS0gPiBjaGVja291dFNlc3Npb24gcGFyYW1zLnNlc3Npb25pZCAnLCByZXEucGFyYW1zLnNlc3Npb25pZCk7XG4gIHZhciBzdHJpcGUgPSByZXF1aXJlKCdzdHJpcGUnKShhcGlTZWNyZXRLZXkpO1xuXG4gIHN0cmlwZS5jaGVja291dC5zZXNzaW9ucy5yZXRyaWV2ZShcbiAgICByZXEucGFyYW1zLnNlc3Npb25pZCxcbiAgICBmdW5jdGlvbiAoZXJyLCBzZXNzaW9uKSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHdpbnN0b24uaW5mbygnLS0gPiBjaGVja291dFNlc3Npb24gZ2V0IGJ5IGlkIGZyb20gc3RyaXBlICBlcnIgJywgZXJyKTtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgc3VjY2VzczogZmFsc2UsIG1zZzogZXJyIH0pXG4gICAgICB9XG4gICAgICB3aW5zdG9uLmluZm8oJy0tID4gY2hlY2tvdXRTZXNzaW9uIGdldCBieSBpZCBmcm9tIHN0cmlwZSAnLCBzZXNzaW9uKVxuICAgICAgcmVzLmpzb24oc2Vzc2lvbik7XG4gICAgfVxuICApO1xufSk7XG5cbi8vbmV3IGNvZGVcbnJvdXRlci5nZXQoJy9jdXN0b21lci86cHJvamVjdGlkJywgW3Bhc3Nwb3J0LmF1dGhlbnRpY2F0ZShbJ2Jhc2ljJywgJ2p3dCddLCB7IHNlc3Npb246IGZhbHNlIH0pLCB2YWxpZHRva2VuXSwgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG4gIHdpbnN0b24uZGVidWcoJ8K7wrvCuyDCu8K7wrsgZ2V0IGN1c3RvbWVyIGZyb20gZGIgJywgcmVxLnBhcmFtcylcbiAgdmFyIHByb2plY3RpZCA9IHJlcS5wYXJhbXMucHJvamVjdGlkXG5cbiAgd2luc3Rvbi5kZWJ1ZygnwrvCu8K7IMK7wrvCuyBnZXQgY3VzdG9tZXIgZnJvbSBkYiAtIHByb2plY3RpZCcsIHByb2plY3RpZCk7XG5cbiAgU3Vic2NyaXB0aW9uUGF5bWVudC5maW5kKHsgcHJvamVjdF9pZDogcHJvamVjdGlkLCBzdHJpcGVfZXZlbnQ6IFwiY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWRcIiB9LCBhc3luYyBmdW5jdGlvbiAoZXJyLCBzdWJzY3JpcHRpb24pIHtcbiAgICBpZiAoZXJyKSB7XG4gICAgICB3aW5zdG9uLmRlYnVnKCctLSA+IGdldCBjdXN0b21lciBmcm9tIGRiIC0gRXJyb3IgJywgZXJyKVxuICAgICAgcmV0dXJuIChlcnIpO1xuICAgIH1cbiAgICBpZiAoc3Vic2NyaXB0aW9uKSB7XG5cbiAgICAgIHN1YnNjcmlwdGlvblswXS5vYmplY3QuY3VzdG9tZXJcbiAgICAgIHdpbnN0b24uZGVidWcoJy0tID4gZ2V0IGN1c3RvbWVyIGZyb20gZGIgLSBzdWJzY3JpcHRpb24gPiBjdXN0b21lciBpZCAnLCBzdWJzY3JpcHRpb25bMF0ub2JqZWN0LmN1c3RvbWVyKTtcbiAgICAgIGNvbnN0IGN1c3RvbWVyaWQgPSBzdWJzY3JpcHRpb25bMF0ub2JqZWN0LmN1c3RvbWVyXG4gICAgICBjb25zdCBzdHJpcGUgPSByZXF1aXJlKFwic3RyaXBlXCIpKGFwaVNlY3JldEtleSk7XG5cbiAgICAgIGNvbnN0IGN1c3RvbWVyID0gYXdhaXQgc3RyaXBlLmN1c3RvbWVycy5yZXRyaWV2ZShcbiAgICAgICAgY3VzdG9tZXJpZFxuICAgICAgKTtcbiAgICAgIHdpbnN0b24uZGVidWcoJy0tID4gZ2V0IGN1c3RvbWVyIGZyb20gZGIgPiBjdXN0b21lciBmcm9tIHN0cmlwZSBBUEkgJywgY3VzdG9tZXIpXG5cbiAgICAgIGNvbnN0IHBheW1lbnRNZXRob2RzID0gYXdhaXQgc3RyaXBlLnBheW1lbnRNZXRob2RzLmxpc3Qoe1xuICAgICAgICBjdXN0b21lcjogY3VzdG9tZXJpZCxcbiAgICAgICAgdHlwZTogJ2NhcmQnLFxuICAgICAgfSk7XG4gICAgICBjdXN0b21lclsncGF5bWVudE1ldGhvZHMnXSA9IHBheW1lbnRNZXRob2RzO1xuICAgICAgd2luc3Rvbi5kZWJ1ZygnLS0gPiBnZXQgY3VzdG9tZXIgZnJvbSBkYiA+IGN1c3RvbWVyICsgcGF5bWVudE1ldGhvZHMgJywgc3Vic2NyaXB0aW9uKVxuICAgICAgcmVzLmpzb24oY3VzdG9tZXIpXG4gICAgfVxuICB9KVxufSk7XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIFVwZGF0ZWQgY3VzdG9tZXJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbnJvdXRlci5wb3N0KCcvY3VzdG9tZXJzLzpjdXN0b21lcmlkJywgW3Bhc3Nwb3J0LmF1dGhlbnRpY2F0ZShbJ2Jhc2ljJywgJ2p3dCddLCB7IHNlc3Npb246IGZhbHNlIH0pLCB2YWxpZHRva2VuXSwgYXN5bmMgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG4gIHZhciBjdXN0b21lcmlkID0gcmVxLnBhcmFtcy5jdXN0b21lcmlkO1xuICB3aW5zdG9uLmRlYnVnKCfCu8K7wrsgwrvCu8K7ICB1cGRhdGUgY3VzdG9tZXIgLSBjdXN0b21lcmlkIGZyb20gcGFyYW1zICcsIGN1c3RvbWVyaWQpO1xuICB3aW5zdG9uLmRlYnVnKCfCu8K7wrsgwrvCu8K7ICB1cGRhdGUgY3VzdG9tZXIgLSBjYyBmcm9tIGJvZHkgJywgcmVxLmJvZHkpO1xuXG4gIGNvbnN0IHN0cmlwZSA9IHJlcXVpcmUoXCJzdHJpcGVcIikoYXBpU2VjcmV0S2V5KTtcblxuICBsZXQgcGF5bWVudE1ldGhvZDtcbiAgdHJ5IHtcbiAgICBwYXltZW50TWV0aG9kID0gYXdhaXQgc3RyaXBlLnBheW1lbnRNZXRob2RzLmNyZWF0ZSh7XG4gICAgICB0eXBlOiAnY2FyZCcsXG4gICAgICBjYXJkOiB7XG4gICAgICAgIG51bWJlcjogcmVxLmJvZHkuY3JlZGl0X2NhcmRfbnVtLFxuICAgICAgICBleHBfbW9udGg6IHJlcS5ib2R5LmV4cGlyYXRpb25fZGF0ZV9tb250aCxcbiAgICAgICAgZXhwX3llYXI6IHJlcS5ib2R5LmV4cGlyYXRpb25fZGF0ZV95ZWFyLFxuICAgICAgICBjdmM6IHJlcS5ib2R5LmNyZWRpdF9jYXJkX2N2YyxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB3aW5zdG9uLmVycm9yKCfCu8K7wrsgwrvCu8K7ICBwYXltZW50TWV0aG9kIGNyZWF0ZSAgZXJyb3IgJywgZSlcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDIpLnNlbmQoeyBzdWNjZXNzOiBmYWxzZSwgbXNnOiBlIH0pXG5cbiAgfVxuICB3aW5zdG9uLmRlYnVnKCfCu8K7wrsgwrvCu8K7ICBwYXltZW50TWV0aG9kJywgcGF5bWVudE1ldGhvZClcblxuICB0cnkge1xuICAgIGNvbnN0IF9wYXltZW50TWV0aG9kID0gYXdhaXQgc3RyaXBlLnBheW1lbnRNZXRob2RzLmF0dGFjaChcbiAgICAgIHBheW1lbnRNZXRob2QuaWQsXG4gICAgICB7IGN1c3RvbWVyOiBjdXN0b21lcmlkIH1cbiAgICApO1xuXG4gICAgd2luc3Rvbi5kZWJ1ZygnwrvCu8K7IMK7wrvCuyAgcGF5bWVudE1ldGhvZCBhdHRhY2hlZCAnLCBfcGF5bWVudE1ldGhvZClcbiAgfSBjYXRjaCAoZSkge1xuICAgIHdpbnN0b24uZXJyb3IoJ8K7wrvCuyDCu8K7wrsgIHBheW1lbnRNZXRob2QgYXR0YWNoZWQgIGVycm9yICcsIGUpXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAxKS5zZW5kKHsgc3VjY2VzczogZmFsc2UsIG1zZzogZSB9KVxuICB9XG5cbiAgY29uc3QgX2N1c3RvbWVyID0gYXdhaXQgc3RyaXBlLmN1c3RvbWVycy51cGRhdGUoXG4gICAgY3VzdG9tZXJpZCxcbiAgICB7XG4gICAgICBpbnZvaWNlX3NldHRpbmdzOiB7IGRlZmF1bHRfcGF5bWVudF9tZXRob2Q6IHBheW1lbnRNZXRob2QuaWQgfVxuICAgIH0pO1xuICByZXMuanNvbihfY3VzdG9tZXIpO1xufSk7XG5cblxucm91dGVyLmdldCgnL3BheW1lbnRfbWV0aG9kcy86Y3VzdG9tZXJpZCcsIFtwYXNzcG9ydC5hdXRoZW50aWNhdGUoWydiYXNpYycsICdqd3QnXSwgeyBzZXNzaW9uOiBmYWxzZSB9KSwgdmFsaWR0b2tlbl0sIGFzeW5jIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuICB3aW5zdG9uLmluZm8oJ2dldCBQYXltZW50TWV0aG9kcyBsaXN0IHJlcS5wYXJhbXMnLCByZXEucGFyYW1zKVxuICB2YXIgY3VzdG9tZXJfaWQgPSByZXEucGFyYW1zLmN1c3RvbWVyaWQ7XG4gIHdpbnN0b24uZGVidWcoJ2dldCBQYXltZW50TWV0aG9kcyBsaXN0IHJlcS5wYXJhbXMgPiBjdXN0b21lcl9pZCAnLCBjdXN0b21lcl9pZClcbiAgY29uc3Qgc3RyaXBlID0gcmVxdWlyZShcInN0cmlwZVwiKShhcGlTZWNyZXRLZXkpO1xuXG4gIGNvbnN0IGN1c3RvbWVyID0gYXdhaXQgc3RyaXBlLmN1c3RvbWVycy5yZXRyaWV2ZShcbiAgICBjdXN0b21lcl9pZFxuICApO1xuXG4gIGNvbnN0IGRlZmF1bHRfcGF5bWVudF9tZXRob2RfaWQgPSBjdXN0b21lci5pbnZvaWNlX3NldHRpbmdzLmRlZmF1bHRfcGF5bWVudF9tZXRob2RcbiAgbGV0IHBheW1lbnRNZXRob2RzO1xuICB0cnkge1xuICAgIHBheW1lbnRNZXRob2RzID0gYXdhaXQgc3RyaXBlLnBheW1lbnRNZXRob2RzLmxpc3Qoe1xuICAgICAgY3VzdG9tZXI6IGN1c3RvbWVyX2lkLFxuICAgICAgdHlwZTogJ2NhcmQnLFxuICAgIH0pO1xuICAgIHdpbnN0b24uZGVidWcoJ2dldCBQYXltZW50TWV0aG9kcyBsaXN0ID4gcGF5bWVudE1ldGhvZHMgJywgcGF5bWVudE1ldGhvZHMpXG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDEpLnNlbmQoeyBzdWNjZXNzOiBmYWxzZSwgbXNnOiBlIH0pXG4gIH1cblxuICB3aW5zdG9uLmRlYnVnKCdnZXQgUGF5bWVudE1ldGhvZHMgbGlzdCA+IHBheW1lbnRNZXRob2RzID4gZGVmYXVsdF9wYXltZW50X21ldGhvZF9pZCAnLCBkZWZhdWx0X3BheW1lbnRfbWV0aG9kX2lkKVxuICBwYXltZW50TWV0aG9kcy5kYXRhLmZvckVhY2gocGF5bWVudE1ldGhvZCA9PiB7XG4gICAgaWYgKHBheW1lbnRNZXRob2QuaWQgIT09IGRlZmF1bHRfcGF5bWVudF9tZXRob2RfaWQpIHtcbiAgICAgIHdpbnN0b24uZGVidWcoJ2dldCBQYXltZW50TWV0aG9kcyBsaXN0ID4gcGF5bWVudE1ldGhvZHMgPiBwYXltZW50TWV0aG9kcy5kYXRhICcsIHBheW1lbnRNZXRob2QuaWQpXG4gICAgICBkZXRhY2hQYXltZW50RnVuYyhwYXltZW50TWV0aG9kLmlkLCBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgIHdpbnN0b24uaW5mbygnZGV0YWNoUGF5bWVudEZ1bmMgcmVzdWx0ICcsIHJlc3VsdClcbiAgICAgIH0pXG4gICAgfVxuICB9KTtcbiAgcmVzLmpzb24ocGF5bWVudE1ldGhvZHMpXG59KVxuXG5hc3luYyBmdW5jdGlvbiBkZXRhY2hQYXltZW50RnVuYyhwYXltZW50TWV0aG9kaWQsIGNhbGxiYWNrKSB7XG4gIHdpbnN0b24uZGVidWcoJ2RldGFjaFBheW1lbnRGdW5jdCA+IHBheW1lbnRNZXRob2RpZCAnLCBwYXltZW50TWV0aG9kaWQpXG4gIGNvbnN0IHN0cmlwZSA9IHJlcXVpcmUoXCJzdHJpcGVcIikoYXBpU2VjcmV0S2V5KTtcbiAgbGV0IHBheW1lbnRNZXRob2Q7XG4gIHRyeSB7XG4gICAgcGF5bWVudE1ldGhvZCA9IGF3YWl0IHN0cmlwZS5wYXltZW50TWV0aG9kcy5kZXRhY2goXG4gICAgICBwYXltZW50TWV0aG9kaWRcbiAgICApO1xuICAgIGNhbGxiYWNrKHBheW1lbnRNZXRob2QpXG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjYWxsYmFjayhlKVxuICB9XG59XG5cblxuXG4vLyBjdXJsIC1YIFBPU1QgLXUgYW5kcmVhLmxlb0BmMjEuaXQ6MTIzNDU2IC1IICdDb250ZW50LVR5cGU6YXBwbGljYXRpb24vanNvbicgLWQgJ3tcInR5cGVcIjpcInBheW1lbnRfaW50ZW50LnN1Y2NlZWRlZFwifScgIGh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9tb2R1bGVzL3BheW1lbnRzL3N0cmlwZS93ZWJob29rXG5cbi8vIHJvdXRlci5wb3N0KCcvd2ViaG9vaycsIGZ1bmN0aW9uKHJlcXVlc3QsIHJlc3BvbnNlKSB7XG4vLyAgIHdpbnN0b24uaW5mbygnc3RyaXBlIHdlYmhvb2snKTtcblxuLy8gLy8gTWF0Y2ggdGhlIHJhdyBib2R5IHRvIGNvbnRlbnQgdHlwZSBhcHBsaWNhdGlvbi9qc29uXG4vLyAvLyBhcHAucG9zdCgnJywgYm9keVBhcnNlci5yYXcoe3R5cGU6ICdhcHBsaWNhdGlvbi9qc29uJ30pLCAocmVxdWVzdCwgcmVzcG9uc2UpID0+IHtcbi8vICAgICBsZXQgZXZlbnQgPSByZXF1ZXN0LmJvZHk7XG4vLyAgICAgd2luc3Rvbi5pbmZvKCdldmVudCcsZXZlbnQpOyAgXG5cbi8vICAgICAvLyBIYW5kbGUgdGhlIGV2ZW50XG4vLyAgICAgc3dpdGNoIChldmVudC50eXBlKSB7XG4vLyAgICAgICBjYXNlICdwYXltZW50X2ludGVudC5zdWNjZWVkZWQnOlxuLy8gICAgICAgICBjb25zdCBwYXltZW50SW50ZW50ID0gZXZlbnQuZGF0YS5vYmplY3Q7XG4vLyAgICAgICAgIGhhbmRsZVBheW1lbnRJbnRlbnRTdWNjZWVkZWQocGF5bWVudEludGVudCk7XG4vLyAgICAgICAgIGJyZWFrO1xuLy8gICAgICAgY2FzZSAncGF5bWVudF9tZXRob2QuYXR0YWNoZWQnOlxuLy8gICAgICAgICBjb25zdCBwYXltZW50TWV0aG9kID0gZXZlbnQuZGF0YS5vYmplY3Q7XG4vLyAgICAgICAgIGhhbmRsZVBheW1lbnRNZXRob2RBdHRhY2hlZChwYXltZW50TWV0aG9kKTtcbi8vICAgICAgICAgYnJlYWs7XG4vLyAgICAgICAvLyAuLi4gaGFuZGxlIG90aGVyIGV2ZW50IHR5cGVzXG4vLyAgICAgICBkZWZhdWx0OlxuLy8gICAgICAgICAvLyBVbmV4cGVjdGVkIGV2ZW50IHR5cGVcbi8vICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1cyg0MDApLmVuZCgpO1xuLy8gICAgIH1cblxuLy8gICAgIC8vIFJldHVybiBhIHJlc3BvbnNlIHRvIGFja25vd2xlZGdlIHJlY2VpcHQgb2YgdGhlIGV2ZW50XG4vLyAgICAgcmVzcG9uc2UuanNvbih7cmVjZWl2ZWQ6IHRydWV9KTtcbi8vIH0pO1xuXG5cblxuXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjsiXSwiZmlsZSI6InBheW1lbnRzL3N0cmlwZS9pbmRleC5qcyJ9
